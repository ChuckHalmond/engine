var main;(()=>{"use strict";var t={147:(t,e,r)=>{t.exports=r.p+"3497bd64f93b4d706808.svg"},336:(t,e,r)=>{t.exports=r.p+"a9d0fda0b3ef93e52697.svg"},193:(t,e,r)=>{t.exports=r.p+"43c54c9d5c843fa6e1a4.svg"},769:(t,e,r)=>{t.exports=r.p+"983207f640fb42a9d859.svg"},923:(t,e,r)=>{t.exports=r.p+"a42bbe687810bdc6e9e8.ttf"}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,r),s.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})();var n={};(()=>{r.r(n),r.d(n,{main:()=>$a});const t=class{constructor(t){this._defaultCtor=t.defaultCtor,this._onDefaultOverride=t.onDefaultOverride,this._constructors=new Map}get defaultCtor(){return this._defaultCtor}overrideDefaultCtor(t){this._defaultCtor=t,this._onDefaultOverride(t)}forceQualifier(t){this._forcedQualifier=t}unforceQualifier(){delete this._forcedQualifier}getConstructor(t){const e=this._forcedQualifier||t;if(void 0===e)return this._defaultCtor;const r=this._constructors.get(e);if(void 0===r)throw new Error(`No constructor for qualifier ${e}`);return r}inject(t){const e=this.getConstructor(t?.qualifier);return t?.args?new e(...Array.from(t.args)):new e}register(t,e){this._constructors.has(e)||this._constructors.set(e,t)}};class e extends Error{constructor(){super(...arguments),this.name="MathError"}}class a{constructor(...t){if("number"==typeof t[0])this.array=new Float32Array([t[0],t[1]]);else if("object"==typeof t[0]){const r=t[0];if(r.length<2)throw new e("Array must be of length 2 at least.");r instanceof Float32Array?this.array=r:this.array=new Float32Array(r)}else this.array=new Float32Array([0,0])}get values(){return[this.array[0],this.array[1]]}set values(t){this.array[0]=t[0],this.array[1]=t[1]}get x(){return this.array[0]}set x(t){this.array[0]=t}get y(){return this.array[1]}set y(t){this.array[1]=t}setValues(t,e){const r=this.array;return r[0]=t,r[1]=e,this}equals(t){const e=t.array,r=this.array;return e[0]===r[0]&&e[1]===r[1]}copy(t){const e=this.array,r=t.array;return e[0]=r[0],e[1]=r[1],this}clone(){return new a(this.values)}setUnit(){const t=this.array;return t[0]=1,t[1]=1,this}setZeros(){const t=this.array;return t[0]=0,t[1]=0,this}add(t){const e=t.array,r=this.array;return r[0]=r[0]+e[0],r[1]=r[1]+e[1],this}addScalar(t){const e=this.array;return e[0]=e[0]+t,e[1]=e[1]+t,this}sub(t){const e=t.array,r=this.array;return r[0]=r[0]-e[0],r[1]=r[1]-e[1],this}lerp(t,e){const r=t.array,n=this.array;return n[0]=e*(r[0]-n[0]),n[1]=e*(r[1]-n[1]),this}clamp(t,e){const r=this.array,n=t.array,a=e.array;return r[0]=Math.min(a[0],Math.min(r[0],n[0])),r[1]=Math.min(a[1],Math.min(r[1],n[1])),this}multScalar(t){const e=this.array;return e[0]=e[0]*t,e[1]=e[1]*t,this}cross(t){const e=this.array,r=t.array;return e[0]*r[1]-e[1]*r[0]}dot(t){const e=this.array,r=t.array;return e[0]*r[0]+e[1]*r[1]}length(){const t=this.array;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}lengthSquared(){const t=this.array;return t[0]*t[0]+t[1]*t[1]}dist(t){const e=this.array,r=t.array,n=e[0]-r[0],a=e[1]-r[1];return Math.sqrt(n*n+a*a)}distSquared(t){const e=this.array,r=t.array,n=e[0]-r[0],a=e[1]-r[1];return n*n+a*a}normalize(){const t=this.array,e=t[0]*t[0]+t[1]*t[1],r=Math.sqrt(e);return r>Number.EPSILON?(t[0]=t[0]/r,t[1]=t[1]/r):(t[0]=0,t[1]=0),this}negate(){const t=this.array;return t[0]=-t[0],t[1]=-t[1],this}mult(t){if(t instanceof s){const e=t.array;return this.array[0]=this.array[0]*e[0],this.array[1]=this.array[1]*e[1],this}{const e=this.x,r=this.y,n=t.array;return this.x=e*n[0]+r*n[2],this.y=e*n[1]+r*n[3],this}}addScaled(t,e){const r=t.array,n=this.array;return n[0]=n[0]+r[0]*e,n[1]=n[1]+r[1]*e,this}writeIntoArray(t,e=0){const r=this.array;t[e]=r[0],t[e+1]=r[1]}readFromArray(t,e=0){const r=this.array;return r[0]=t[e],r[1]=t[e+1],this}copyAndSub(t,e){const r=this.array,n=t.array,a=e.array;return r[0]=n[0]-a[0],r[1]=n[1]-a[1],this}}var s=a;new t({defaultCtor:a,onDefaultOverride:t=>{s=t}});class i{constructor(...t){if("number"==typeof t[0])this.array=new Float32Array([t[0],t[1],t[2]]);else if("object"==typeof t[0]){const r=t[0];if(r.length<3)throw new e("Array must be of length 3 at least.");r instanceof Float32Array?this.array=r:this.array=new Float32Array(r)}else this.array=new Float32Array([0,0,0])}toString(){return`Vector3([${Array.from(this.array).join(", ")}])`}static angle(t,e){const r=new c;return Math.acos(r.copy(t).dot(e)/(Math.sqrt(r.copy(t).dot(t))*Math.sqrt(r.copy(e).dot(e))))}get values(){return[this.array[0],this.array[1],this.array[2]]}set values(t){this.array[0]=t[0],this.array[1]=t[1],this.array[2]=t[2]}get x(){return this.array[0]}set x(t){this.array[0]=t}get y(){return this.array[1]}set y(t){this.array[1]=t}get z(){return this.array[2]}set z(t){this.array[2]=t}setValues(t,e,r){return this.array[0]=t,this.array[1]=e,this.array[2]=r,this}copy(t){const e=t.array;return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this}clone(){return new i(this.values)}equals(t){return t.array[0]===this.array[0]&&t.array[1]===this.array[1]&&t.array[2]===this.array[2]}setZeros(){return this.array[0]=0,this.array[1]=0,this.array[2]=0,this}setUnit(){return this.array[0]=1,this.array[1]=1,this.array[2]=1,this}add(t){return this.array[0]=this.array[0]+t.array[0],this.array[1]=this.array[1]+t.array[1],this.array[2]=this.array[2]+t.array[2],this}addScalar(t){return this.array[0]=this.array[0]+t,this.array[1]=this.array[1]+t,this.array[2]=this.array[2]+t,this}sub(t){return this.array[0]=this.array[0]-t.array[0],this.array[1]=this.array[1]-t.array[1],this.array[2]=this.array[2]-t.array[2],this}lerp(t,e,r){return this.array[0]=(1-r)*t.x+r*(e.x-t.x),this.array[1]=(1-r)*t.y+r*(e.y-t.y),this.array[2]=(1-r)*t.z+r*(e.z-t.z),this}max(t){return this.array[0]=Math.max(this.array[0],t.array[0]),this.array[1]=Math.max(this.array[1],t.array[1]),this.array[2]=Math.max(this.array[2],t.array[2]),this}min(t){return this.array[0]=Math.min(this.array[0],t.array[0]),this.array[1]=Math.min(this.array[1],t.array[1]),this.array[2]=Math.min(this.array[2],t.array[2]),this}clamp(t,e){return this.array[0]=Math.min(e.array[0],Math.max(this.array[0],t.array[0])),this.array[1]=Math.min(e.array[1],Math.max(this.array[1],t.array[1])),this.array[2]=Math.min(e.array[2],Math.max(this.array[2],t.array[2])),this}scale(t){return this.array[0]=this.array[0]*t,this.array[1]=this.array[1]*t,this.array[2]=this.array[2]*t,this}cross(t){const e=this.array[1]*t.array[2]-this.array[2]*t.array[1],r=this.array[2]*t.array[0]-this.array[0]*t.array[2],n=this.array[0]*t.array[1]-this.array[1]*t.array[0];return this.array[0]=e,this.array[1]=r,this.array[2]=n,this}dot(t){const e=this.array,r=t.array;return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}length(){const t=this.array;return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}lengthSquared(){const t=this.array;return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}distance(t){const e=this.array,r=t.array,n=e[0]-r[0],a=e[1]-r[1],s=e[2]-r[2];return Math.hypot(n,a,s)}distanceSquared(t){const e=this.array,r=t.array,n=e[0]-r[0],a=e[1]-r[1],s=e[2]-r[2];return n*n+a*a+s*s}normalize(){const{array:t}=this,e=this.length();return e>Number.EPSILON?(t[0]/=e,t[1]/=e,t[2]/=e):(t[0]=0,t[1]=0,t[2]=0),this}negate(){const{array:t}=this;return t[0]*=-1,t[1]*=-1,t[2]*=-1,this}mult(t){const{array:e}=this;if(t instanceof c){const r=t.array;return e[0]=e[0]*r[0],e[1]=e[1]*r[1],e[2]=e[2]*r[2],this}{const[e,r,n]=this,a=t.array;return this.x=e*a[0]+r*a[3]+n*a[6],this.y=e*a[1]+r*a[4]+n*a[7],this.z=e*a[2]+r*a[5]+n*a[8],this}}toSpherical(t){const e=this.array,r=t.array,n=e[0]-r[0],a=e[1]-r[1],s=e[2]-r[2],i=Math.hypot(n,a,s),o=Math.acos(a/i),c=Math.atan2(s,n);return e[0]=i,e[1]=o,e[2]=c,this}toCartesian(t){const e=this.array,r=t.array,n=e[0],a=e[1],s=e[2],i=n*Math.sin(a)*Math.cos(s)+r[0],o=n*Math.cos(a)+r[1],c=n*Math.sin(a)*Math.sin(s)+r[2];return e[0]=i,e[1]=o,e[2]=c,this}static mult(t,e){const r=t.array,n=e.array;return new i([r[0]*n[0]+r[1]*n[1]+r[2]*n[2],r[3]*n[0]+r[4]*n[1]+r[5]*n[2],r[6]*n[0]+r[7]*n[1]+r[8]*n[2]])}writeIntoArray(t,e=0){const r=this.array;t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2]}readFromArray(t,e=0){return this.array[0]=t[e],this.array[1]=t[e+1],this.array[2]=t[e+2],this}addScaled(t,e){return this.array[0]=this.array[0]+t.array[0]*e,this.array[1]=this.array[1]+t.array[1]*e,this.array[2]=this.array[2]+t.array[2]*e,this}copyAndSub(t,e){const r=t.array,n=e.array;return this.array[0]=r[0]-n[0],this.array[1]=r[1]-n[1],this.array[2]=r[2]-n[2],this}copyAndCross(t,e){const r=t.array,n=e.array,a=r[1]*n[2]-r[2]*n[1],s=r[2]*n[0]-r[0]*n[2],i=r[0]*n[1]-r[1]*n[0];return this.array[0]=a,this.array[1]=s,this.array[2]=i,this}[Symbol.iterator](){const{array:t}=this,{length:e}=t;let r=0;return{next:()=>r<e?{value:t[r++],done:!1}:{value:void 0,done:!0}}}}var o,c=i;new t({defaultCtor:i,onDefaultOverride:t=>{c=t}});class l{constructor(){}}l.origin=new c([0,0,0]),l.right=new c([1,0,0]),l.left=new c([-1,0,0]),l.up=new c([0,1,0]),l.down=new c([0,-1,0]),l.forward=new c([0,0,1]),l.backward=new c([0,0,-1]),function(t){t.A="a",t.B="b",t.C="c",t.D="d",t.E="e",t.F="f",t.G="g",t.H="h",t.I="i",t.J="j",t.K="k",t.L="l",t.M="m",t.O="o",t.P="p",t.Q="q",t.R="r",t.S="s",t.T="t",t.U="u",t.V="v",t.W="w",t.X="x",t.Y="y",t.Z="z",t.ENTER="Enter",t.BACKSPACE="Backspace",t.ARROW_DOWN="ArrowDown",t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.SHIFT="Shift"}(o||(o={}));const h=Object.keys(o).length;var u,d;!function(t){t.Alt="Alt",t.Control="Control",t.Shift="Shift"}(u||(u={})),function(t){t[t.LEFT=0]="LEFT",t[t.WHEEL=1]="WHEEL",t[t.RIGHT=2]="RIGHT",t[t.FORWARD=3]="FORWARD",t[t.BACK=4]="BACK"}(d||(d={}));const f=Object.keys(d).length,p=Object.freeze(Object.values(d).reduce(((t,e,r)=>Object.assign(t,{[e]:r})),{})),y=Object.freeze(Object.values(o).reduce(((t,e,r)=>Object.assign(t,{[e]:r})),{}));var m,E=new class{constructor(){this.keyFlags=new Array(3*h).fill(!1),this.mouseFlags=new Array(3*f).fill(!1),this.pointerPosition=new s,this.wheelDelta=0,this.canvas=null,this.canvasRectangle=null}initialize(t){this.canvas=t,this.canvasRectangle=t.getBoundingClientRect(),t.addEventListener("pointerdown",this),t.addEventListener("pointerup",this),t.addEventListener("contextmenu",this),t.addEventListener("pointermove",this),t.addEventListener("wheel",this),t.addEventListener("keydown",this),t.addEventListener("keyup",this),t.addEventListener("focusout",this)}getCanvasRect(){const t=this.canvasRectangle;if(null===t)throw new Error("Input manager not initialized.");return t}clear(){this.keyFlags.fill(!1,0,2*h),this.mouseFlags.fill(!1,0,2*f),this.wheelDelta=0}handleEvent(t){let e=-1;switch(t.type){case"pointerdown":e=p[t.button],this.mouseFlags[1*f+e]=!0,this.mouseFlags[2*f+e]=!0;break;case"pointerup":e=p[t.button],this.mouseFlags[0*f+e]=!0,this.mouseFlags[2*f+e]=!1;break;case"pointermove":const r=this.getCanvasRect();this.pointerPosition.setValues(t.clientX-r.left,t.clientY-r.top);break;case"wheel":this.wheelDelta=t.deltaY/100;break;case"keydown":e=y[t.key],this.keyFlags[1*h+e]=!0,this.keyFlags[2*h+e]=!0;break;case"keyup":e=y[t.key],this.keyFlags[0*h+e]=!0,this.keyFlags[2*h+e]=!1;break;case"focusout":this.keyFlags.fill(!1),this.mouseFlags.fill(!1),this.wheelDelta=0,this.pointerPosition.setZeros()}}getKey(t){return this.keyFlags[2*h+y[t]]}getKeyUp(t){return this.keyFlags[0*h+y[t]]}getKeyDown(t){return this.keyFlags[1*h+y[t]]}getMouseButton(t){return this.mouseFlags[2*f+p[t]]}getPointerPosition(){return this.pointerPosition.clone()}getPointerScreenPosition(){const t=this.pointerPosition.array,e=this.getCanvasRect(),r=t[0]/e.width*2-1,n=t[1]/e.height*2-1;return new s([r,n])}getWheelDelta(){return this.wheelDelta}getMouseButtonDown(t){return this.mouseFlags[1*f+p[t]]}getMouseButtonUp(t){return this.mouseFlags[0*f+p[t]]}};const g=new c,T=new c,A=new c;m=new WeakMap;var _;!function(t){t[t.NO_AUTO_EXTEND=0]="NO_AUTO_EXTEND",t[t.AUTO_EXTEND_ONE=1]="AUTO_EXTEND_ONE",t[t.AUTO_EXTEND_POW2=2]="AUTO_EXTEND_POW2"}(_||(_={}));var R=class extends class{constructor(t,e){this.ctor=t,this.autoExtendPolicy=e||_.AUTO_EXTEND_ONE,this.autoExtendTicks=0}autoExtend(){switch(this.autoExtendPolicy){case _.AUTO_EXTEND_ONE:this.extend(1);break;case _.AUTO_EXTEND_POW2:this.extend(Math.pow(2,this.autoExtendTicks))}this.autoExtendTicks++}acquire(t){throw new Error("Not implemented")}release(...t){throw new Error("Not implemented")}extend(t){throw new Error("Not implemented")}clear(){throw new Error("Not implemented")}}{constructor(t,e){super(t,e?.policy),this.objects=new Array(e?.size||0).fill(0).map((()=>new this.ctor(e?.args))),this.top=0}acquire(t){const e=this.top,r=e+t;if(this.autoExtendPolicy)for(;this.objects.length<r;)this.autoExtend();return this.top=r,this.objects.slice(e,r)}release(t){const e=this.top;t>e&&console.warn("Releasing under zero."),this.top=Math.max(e-t,0)}extend(t){this.objects.push(...Array(t).fill(0).map((()=>new this.ctor)))}clear(){this.objects=[],this.top=0,this.autoExtendTicks=0}};Math.PI,Math.PI;const w=new ArrayBuffer(Float32Array.BYTES_PER_ELEMENT),b=new Float32Array(w),v=new Uint32Array(w);class I{constructor(...t){if("number"==typeof t[0])this.array=new Float32Array([t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]);else if("object"==typeof t[0]){const e=t[0];this.checkArray(e),e instanceof Float32Array?this.array=e:this.array=new Float32Array(e)}else this.array=new Float32Array([0,0,0,0,0,0,0,0,0])}get row1(){return[this.array[0],this.array[3],this.array[6]]}set row1(t){this.array[0]=t[0],this.array[3]=t[1],this.array[6]=t[2]}get row2(){return[this.array[1],this.array[4],this.array[7]]}set row2(t){this.array[1]=t[0],this.array[4]=t[1],this.array[7]=t[2]}get row3(){return[this.array[2],this.array[5],this.array[8]]}set row3(t){this.array[2]=t[0],this.array[5]=t[1],this.array[8]=t[2]}get col1(){return[this.array[0],this.array[1],this.array[2]]}set col1(t){this.array[0]=t[0],this.array[1]=t[1],this.array[2]=t[2]}get col2(){return[this.array[3],this.array[4],this.array[5]]}set col2(t){this.array[3]=t[0],this.array[4]=t[1],this.array[5]=t[2]}get col3(){return[this.array[6],this.array[7],this.array[8]]}set col3(t){this.array[6]=t[0],this.array[7]=t[1],this.array[8]=t[2]}get m11(){return this.array[0]}set m11(t){this.array[0]=t}get m12(){return this.array[3]}set m12(t){this.array[3]=t}get m13(){return this.array[6]}set m13(t){this.array[6]=t}get m21(){return this.array[1]}set m21(t){this.array[1]=t}get m22(){return this.array[4]}set m22(t){this.array[4]=t}get m23(){return this.array[7]}set m23(t){this.array[7]=t}get m31(){return this.array[2]}set m31(t){this.array[2]=t}get m32(){return this.array[5]}set m32(t){this.array[5]=t}get m33(){return this.array[8]}set m33(t){this.array[8]=t}checkArray(t){if(t.length<9)throw new e("Array must be of length 9 at least.")}getValues(){return[this.array[0],this.array[1],this.array[2],this.array[3],this.array[4],this.array[5],this.array[6],this.array[7],this.array[8]]}setValues(t,e,r,n,a,s,i,o,c){return this.array[0]=t,this.array[1]=e,this.array[2]=r,this.array[3]=n,this.array[4]=a,this.array[5]=s,this.array[6]=i,this.array[7]=o,this.array[8]=c,this}equals(t){const e=t.array;return this.array[0]===e[0]&&this.array[1]===e[1]&&this.array[2]===e[2]&&this.array[3]===e[3]&&this.array[4]===e[4]&&this.array[5]===e[5]&&this.array[6]===e[6]&&this.array[7]===e[7]&&this.array[8]===e[8]}copy(t){const e=this.array,r=t.array;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}clone(){return new I(this.array[0],this.array[1],this.array[2],this.array[3],this.array[4],this.array[5],this.array[6],this.array[7],this.array[8])}setIdentity(){const t=this.array;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this}setZeros(){const t=this.array;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,this}det(){const t=this.array;return t[0]*(t[4]*t[8]-t[5]*t[7])-t[1]*(t[3]*t[8]-t[5]*t[6])+t[2]*(t[3]*t[7]-t[4]*t[6])}trace(){const t=this.array;return t[0]+t[4]+t[8]}negate(){const t=this.array;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],t[3]=-t[3],t[4]=-t[4],t[5]=-t[5],t[6]=-t[6],t[7]=-t[7],t[8]=-t[8],this}transpose(){const t=this.array;let e;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}invert(){const t=this.array,r=t[4]*t[8]-t[5]*t[7],n=t[1]*t[8]-t[2]*t[7],a=t[1]*t[5]-t[2]*t[4],s=t[3]*t[8]-t[5]*t[6],i=t[0]*t[8]-t[2]*t[6],o=t[0]*t[5]-t[2]*t[3],c=t[3]*t[7]-t[4]*t[6],l=t[0]*t[7]-t[1]*t[6],h=t[0]*t[4]-t[1]*t[3],u=1/(t[0]*r-t[3]*n+t[6]*a);if(0==u)throw new e("Matrix is not invertible.");return t[0]=u*r,t[1]=-u*n,t[2]=u*a,t[3]=-u*s,t[4]=u*i,t[5]=-u*o,t[6]=u*c,t[7]=-u*l,t[8]=u*h,this}add(t){const e=this.array,r=t.array;return e[0]=e[0]+r[0],e[1]=e[1]+r[1],e[2]=e[2]+r[2],e[3]=e[3]+r[3],e[4]=e[4]+r[4],e[5]=e[5]+r[5],e[6]=e[6]+r[6],e[7]=e[7]+r[7],e[8]=e[8]+r[8],this}sub(t){const e=this.array,r=t.array;return e[0]=e[0]-r[0],e[1]=e[1]-r[1],e[2]=e[2]-r[2],e[3]=e[3]-r[3],e[4]=e[4]-r[4],e[5]=e[5]-r[5],e[6]=e[6]-r[6],e[7]=e[7]-r[7],e[8]=e[8]-r[8],this}mult(t){const e=this.array,r=t.array,n=e[0],a=e[1],s=e[2],i=e[3],o=e[4],c=e[5],l=e[6],h=e[7],u=e[8],d=r[0],f=r[1],p=r[2],y=r[3],m=r[4],E=r[5],g=r[6],T=r[7],A=r[8];return e[0]=d*n+f*i+p*l,e[1]=d*a+f*o+p*h,e[2]=d*s+f*c+p*u,e[3]=y*n+m*i+E*l,e[4]=y*a+m*o+E*h,e[5]=y*s+m*c+E*u,e[6]=g*n+T*i+A*l,e[7]=g*a+T*o+A*h,e[8]=g*s+T*c+A*u,this}multScalar(t){const e=this.array;return e[0]=e[0]*t,e[1]=e[1]*t,e[2]=e[2]*t,e[3]=e[3]*t,e[4]=e[4]*t,e[5]=e[5]*t,e[6]=e[6]*t,e[7]=e[7]*t,e[8]=e[8]*t,this}writeIntoArray(t,e=0){const r=this.array;t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8]}readFromArray(t,e=0){const r=this.array;r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],r[4]=t[e+4],r[5]=t[e+5],r[6]=t[e+6],r[7]=t[e+7],r[8]=t[e+8]}static rotationX(t){return(new I).setRotationX(t)}setRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.array[0]=1,this.array[1]=0,this.array[2]=0,this.array[3]=0,this.array[4]=e,this.array[5]=r,this.array[6]=0,this.array[7]=-r,this.array[8]=e,this}static rotationY(t){return(new I).setRotationY(t)}setRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.array[0]=e,this.array[1]=0,this.array[2]=-r,this.array[3]=0,this.array[4]=1,this.array[5]=0,this.array[6]=r,this.array[7]=0,this.array[8]=e,this}static rotationZ(t){return(new I).setRotationZ(t)}setRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.array[0]=e,this.array[1]=r,this.array[2]=0,this.array[3]=-r,this.array[4]=e,this.array[5]=0,this.array[6]=0,this.array[7]=0,this.array[8]=1,this}solve(t){const e=this.array,r=e[0],n=e[3],a=e[6],s=e[1],i=e[4],o=e[7],c=e[2],l=e[5],h=e[8];let u,d,f,p;u=i*h-o*l,d=o*c-s*h,f=s*l-i*c,p=r*u+n*d+a*f,0!=p&&(p=1/p);const y=p*(t.x*u+t.y*d+t.z*f);u=-(l*t.z-h*t.y),d=-(h*t.x-c*t.z),f=-(c*t.y-l*t.x);const m=p*(r*u+n*d+a*f);return u=-(t.y*o-t.z*i),d=-(t.z*s-t.x*o),f=-(t.x*i-t.y*s),[y,m,p*(r*u+n*d+a*f)]}solve2(t){const e=this.array,r=e[0],n=e[1],a=e[3],s=e[4],i=t.x-e[4],o=t.y-e[7];let c=r*s-n*a;return 0!=c&&(c=1/c),[c*(s*i-n*o),c*(r*o-a*i)]}}var N=I;new t({defaultCtor:I,onDefaultOverride:t=>{N=t}});class S{constructor(...t){"number"==typeof t[0]?this._array=[t[0],t[1],t[2],t[3]]:"object"==typeof t[0]?(this._checkArray(t[0]),this._array=t[0]):this._array=[0,0,0,0]}get array(){return this._array}get x(){return this._array[0]}set x(t){this._array[0]=t}get y(){return this._array[1]}set y(t){this._array[1]=t}set z(t){this._array[2]=t}get z(){return this._array[2]}set w(t){this._array[3]=t}get w(){return this._array[3]}get pitch(){const t=this.array,e=t[0],r=t[1],n=t[2],a=2*(t[3]*r-n*e);return Math.abs(a)>=1?Math.sign(a)*(Math.PI/2):Math.asin(a)}get yaw(){const t=this.array,e=t[0],r=t[1],n=t[2],a=2*(t[3]*n+e*r),s=1-2*(r*r+n*n);return Math.atan2(a,s)}get roll(){const t=this.array,e=t[0],r=t[1],n=t[2],a=2*(t[3]*e+r*n),s=1-2*(e*e+r*r);return Math.atan2(a,s)}getValues(){return[this._array[0],this._array[1],this._array[2],this._array[3]]}setValues(t,e,r,n){return this._array[0]=t,this._array[1]=e,this._array[2]=r,this._array[3]=n,this}_checkArray(t){if(t.length<4)throw new e("Array must be of length 4 at least.")}static fromArray(t){return new S(t)}static fromAxisAngle(t,e){return(new S).setAxisAngle(t,e)}static fromVector(t){return new S(t.x,t.y,t.z,1)}static fromEuler(t,e,r){return(new S).setEuler(t,e,r)}copy(t){const e=this._array,r=t.array;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],this}clone(){return new S(this.x,this.y,this.z,this.w)}equals(t){const e=this.array,r=t.array;return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}getAxis(t){const e=this.array,r=t.array,n=1-e[3]*e[3];if(n<Number.EPSILON)return t.setZeros();const a=function(t){const e=.5*t;b[0]=t,v[0]=1597463007-(v[0]>>1);let r=b[0];return r*=1.5-e*r*r,r}(n);return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,t}getMatrix3(t){const e=this.array,r=2/this.lengthSquared(),n=e[0],a=e[1],s=e[2],i=e[3],o=n*r,c=a*r,l=s*r,h=i*o,u=i*c,d=i*l,f=n*o,p=n*c,y=n*l,m=a*c,E=a*l,g=s*l;return t.setValues(1-(m+g),p+d,y-u,p-d,1-(f+g),E+h,y+u,E-h,1-(f+m))}getMatrix4(t){const e=this.array,r=2/this.lengthSquared(),n=e[0],a=e[1],s=e[2],i=e[3],o=n*r,c=a*r,l=s*r,h=i*o,u=i*c,d=i*l,f=n*o,p=n*c,y=n*l,m=a*c,E=a*l,g=s*l;return t.setValues(1-(m+g),p+d,y-u,0,p-d,1-(f+g),E+h,0,y+u,E-h,1-(f+m),0,0,0,0,1)}rotate(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2],i=e[0],o=e[1],c=e[2],l=e[3],h=l*n+0*-i+-o*s+c*a,u=l*a+0*-o+-c*n+i*s,d=l*s+0*-c+-i*a+o*n,f=i*n+0*l+o*a+c*s;return r[0]=f*c+d*l+h*o-u*i,r[1]=f*o+u*l+d*i-h*c,r[2]=f*i+h*l+u*c-d*o,t}toVector(){return new c([this.x,this.y,this.z])}setEuler(t,e,r){const n=Math.cos(.5*e),a=Math.sin(.5*e),s=Math.cos(.5*t),i=Math.sin(.5*t),o=Math.cos(.5*r),c=Math.sin(.5*r),l=this.array;return l[0]=c*s*n-o*i*a,l[1]=o*i*n+c*s*a,l[2]=o*s*a-c*i*n,l[3]=o*s*n+c*i*a,this}setAxisAngle(t,e=0){const r=t.length();if(0===r)return this;const n=Math.sin(.5*e)/r,a=t.array,s=this.array;return s[0]=a[0]*n,s[1]=a[1]*n,s[2]=a[2]*n,s[3]=Math.cos(.5*e),this}setMatrix(t){const e=t.array;let r=0,n=0,a=0,s=0,i=0,o=0,c=0,l=0,h=0;t instanceof N?(r=e[0],n=e[3],a=e[6],s=e[1],i=e[4],o=e[7],c=e[2],l=e[5],h=e[8]):(r=e[0],n=e[4],a=e[8],s=e[1],i=e[5],o=e[9],c=e[2],l=e[6],h=e[10]);const u=r+i+h,d=this.array;if(u>0){const t=2*Math.sqrt(u+1);d[3]=.25*t,d[0]=(l-o)/t,d[1]=(a-c)/t,d[2]=(s-n)/t}else if(r>i&&r>h){const t=2*Math.sqrt(1+r-i-h);d[3]=(l-o)/t,d[0]=.25*t,d[1]=(n+s)/t,d[2]=(a+c)/t}else if(i>h){const t=2*Math.sqrt(1+i-r-h);d[3]=(a-c)/t,d[0]=(n+s)/t,d[1]=.25*t,d[2]=(o+l)/t}else{const t=2*Math.sqrt(1+h-r-i);d[3]=(s-n)/t,d[0]=(a+c)/t,d[1]=(o+l)/t,d[2]=.25*t}return this}lookAt(t,e){const r=e.clone().sub(t).normalize(),n=l.forward.clone().cross(r),a=l.forward.dot(r);return new x(n.x,n.y,n.z,a+1).normalize()}static fromMatrix(t){return(new S).setMatrix(t)}setVectors(t,e){const r=t.dot(e),n=t.cross(e).array,a=this.array;a[0]=n[0],a[1]=n[1],a[2]=n[2];const s=t.length(),i=t.length();return a[3]=Math.sqrt(s*s*i*i)+r,this.normalize()}dot(t){const e=this.array,r=t.array;return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}lengthSquared(){const t=this.array;return t[0]**2+t[1]**2+t[2]**2+t[3]**2}length(){const t=this.array;return Math.hypot(t[0],t[1],t[2],t[3])}angleTo(t){return 2*Math.acos(Math.abs(Math.max(-1,Math.min(1,this.dot(t)))))}rotateTowards(t){const e=this.angleTo(t);if(0===e)return this;const r=Math.min(1,e);return this.slerp(this,t,r),this}invert(){return this.conjugate()}conjugate(){const t=this.array;return t[0]*=-1,t[1]*=-1,t[2]*=-1,this}normalize(){const t=this.array;let e=this.length();return 0===e?(t[0]=0,t[1]=0,t[2]=0,t[3]=1):(e=1/e,t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e),this}add(t){const e=this.array,r=t.array;return e[0]+=r[0],e[1]+=r[1],e[2]+=r[2],e[3]+=r[3],this}sub(t){const e=this.array,r=t.array;return e[0]-=r[0],e[1]-=r[1],e[2]-=r[2],e[3]-=r[3],this}mult(t){const e=this.array,r=t.array,n=e[0],a=e[1],s=e[2],i=e[3],o=r[0],c=r[1],l=r[2],h=r[3];return e[0]=n*h+i*o+a*l-s*c,e[1]=a*h+i*c+s*o-n*l,e[2]=s*h+i*l+n*c-a*o,e[3]=i*h-n*o-a*c-s*l,this}scale(t){const e=this.array;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,this}static slerp(t,e,r,n){if(n instanceof x||(n=new x),0===r)return n.copy(t);if(1===r)return n.copy(e);const a=n.array,s=t.array,i=e.array,o=s[3]*i[3]+s[0]*i[0]+s[1]*i[1]+s[2]*i[2];if(Math.abs(o)>=1)return a[3]=s[3],a[0]=s[0],a[1]=s[1],a[2]=s[2],n;const c=Math.acos(o),l=Math.sqrt(1-o*o);if(Math.abs(l-Math.trunc(l))<Number.EPSILON)return a[3]=.5*s[3]+.5*i[3],a[0]=.5*s[0]+.5*i[0],a[1]=.5*s[1]+.5*i[1],a[2]=.5*s[2]+.5*i[2],n;const h=Math.sin((1-r)*c)/l,u=Math.sin(r*c)/l;return a[3]=s[3]*h+i[3]*u,a[0]=s[0]*h+i[0]*u,a[1]=s[1]*h+i[1]*u,a[2]=s[2]*h+i[2]*u,n}slerp(t,e,r){return x.slerp(t,e,r,this)}copyIntoArray(t,e=0){const r=this.array;t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3]}readFromArray(t,e=0){const r=this.array;r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3]}}var x=S;new R(S),new t({defaultCtor:S,onDefaultOverride:t=>{x=t}});class M{constructor(...t){if("number"==typeof t[0])this.array=new Float32Array([t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]);else if("object"==typeof t[0]){const e=t[0];this.checkArray(e),e instanceof Float32Array?this.array=e:this.array=new Float32Array(e)}else this.array=new Float32Array(16)}static fromValues(t,e,r,n,a,s,i,o,c,l,h,u,d,f,p,y){return new M(t,e,r,n,a,s,i,o,c,l,h,u,d,f,p,y)}static fromArray(t){if(t.length<16)throw new Error("Matrix4 needs an array of size 16 at least.");return new M(t)}getValues(){const t=this.array;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}setValues(t,e,r,n,a,s,i,o,c,l,h,u,d,f,p,y){const m=this.array;return m[0]=t,m[1]=e,m[2]=r,m[3]=n,m[4]=a,m[5]=s,m[6]=i,m[7]=o,m[8]=c,m[9]=l,m[10]=h,m[11]=u,m[12]=d,m[13]=f,m[14]=p,m[15]=y,this}get m11(){return this.array[0]}set m11(t){this.array[0]=t}get m12(){return this.array[4]}set m12(t){this.array[4]=t}get m13(){return this.array[8]}set m13(t){this.array[8]=t}get m14(){return this.array[12]}set m14(t){this.array[12]=t}get m21(){return this.array[1]}set m21(t){this.array[1]=t}get m22(){return this.array[5]}set m22(t){this.array[5]=t}get m23(){return this.array[9]}set m23(t){this.array[9]=t}get m24(){return this.array[13]}set m24(t){this.array[13]=t}get m31(){return this.array[2]}set m31(t){this.array[2]=t}get m32(){return this.array[6]}set m32(t){this.array[6]=t}get m33(){return this.array[10]}set m33(t){this.array[10]=t}get m34(){return this.array[14]}set m34(t){this.array[14]=t}get m41(){return this.array[3]}set m41(t){this.array[3]=t}get m42(){return this.array[7]}set m42(t){this.array[7]=t}get m43(){return this.array[11]}set m43(t){this.array[11]=t}get m44(){return this.array[15]}set m44(t){this.array[15]=t}checkArray(t){if(t.length<16)throw new e("Array must be of length 16 at least.")}getRotation(){const t=this.array,e=t[0],r=t[4],n=t[8],a=t[1],s=t[5],i=t[9],o=t[2],c=t[6],l=t[10],h=e+s+l;let u=0,d=0,f=0,p=0;if(h>0){const t=2*Math.sqrt(h+1);p=.25*t,u=(c-i)/t,d=(n-o)/t,f=(a-r)/t}else if(e>s&&e>l){const t=2*Math.sqrt(1+e-s-l);p=(c-i)/t,u=.25*t,d=(r+a)/t,f=(n+o)/t}else if(s>l){const t=2*Math.sqrt(1+s-e-l);p=(n-o)/t,u=(r+a)/t,d=.25*t,f=(i+c)/t}else{const t=2*Math.sqrt(1+l-e-s);p=(a-r)/t,u=(n+o)/t,d=(i+c)/t,f=.25*t}return new x(u,d,f,p)}setTRS(t,e,r){const n=this.array,a=e.array,s=t.array,i=r.array,o=a[0],c=a[1],l=a[2],h=a[3],u=o+o,d=c+c,f=l+l,p=o*u,y=o*d,m=o*f,E=c*d,g=c*f,T=l*f,A=h*u,_=h*d,R=h*f,w=i[0],b=i[1],v=i[2];return n[0]=(1-(E+T))*w,n[1]=(y+R)*w,n[2]=(m-_)*w,n[3]=0,n[4]=(y-R)*b,n[5]=(1-(p+T))*b,n[6]=(g+A)*b,n[7]=0,n[8]=(m+_)*v,n[9]=(g-A)*v,n[10]=(1-(p+E))*v,n[11]=0,n[12]=s[0],n[13]=s[1],n[14]=s[2],n[15]=1,this}setRotation(t){const e=this.array,r=t.array,n=2/t.lengthSquared(),a=r[0],s=r[1],i=r[2],o=r[3],c=a*n,l=s*n,h=i*n,u=o*c,d=o*l,f=o*h,p=a*c,y=a*l,m=a*h,E=s*l,g=s*h,T=i*h,A=1-(E+T),_=y+f,R=m-d,w=y-f,b=1-(p+T),v=g+u,I=m+d,N=g-u,S=1-(p+E);return e[0]=A,e[1]=_,e[2]=R,e[4]=w,e[5]=b,e[6]=v,e[8]=I,e[9]=N,e[10]=S,this}equals(t){const e=this.array,r=t.array;return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}copy(t){const e=this.array,r=t.array;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}clone(){const t=this.array;return new M(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}static identity(){return new M(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}setIdentity(){const t=this.array;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}static zeros(){return new M(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}setZeros(){const t=this.array;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=0,this}det(){const t=this.array,e=t[0]*t[5]-t[1]*t[4],r=t[0]*t[6]-t[2]*t[4],n=t[0]*t[7]-t[3]*t[4],a=t[1]*t[6]-t[2]*t[5],s=t[1]*t[7]-t[3]*t[5],i=t[2]*t[7]-t[3]*t[6],o=t[8]*a-t[9]*r+t[10]*e,c=t[8]*s-t[9]*n+t[11]*e,l=t[8]*i-t[10]*n+t[11]*r;return-(t[9]*i-t[10]*s+t[11]*a)*t[12]+l*t[13]-c*t[14]+o*t[15]}trace(){const t=this.array;return t[0]+t[5]+t[10]+t[15]}static negate(t,e){const r=t.array,n=e.array;return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n[4]=-r[4],n[5]=-r[5],n[6]=-r[6],n[7]=-r[7],n[8]=-r[8],n[9]=-r[9],n[10]=-r[10],n[11]=-r[11],n[12]=-r[12],n[13]=-r[13],n[14]=-r[14],n[15]=-r[15],e}negate(){return M.negate(this,this)}static transpose(t,e){const r=t.array,n=e.array,a=r[0],s=r[1],i=r[2],o=r[3],c=r[4],l=r[5],h=r[6],u=r[7],d=r[8],f=r[9],p=r[10],y=r[11],m=r[12],E=r[13],g=r[14],T=r[15];return n[0]=a,n[1]=c,n[2]=d,n[3]=m,n[4]=s,n[5]=l,n[6]=f,n[7]=E,n[8]=i,n[9]=h,n[10]=p,n[11]=g,n[12]=o,n[13]=u,n[14]=y,n[15]=T,e}transpose(){return M.transpose(this,this)}static invert(t,r){const n=t.array,a=r.array,s=n[0],i=n[1],o=n[2],c=n[3],l=n[4],h=n[5],u=n[6],d=n[7],f=n[8],p=n[9],y=n[10],m=n[11],E=n[12],g=n[13],T=n[14],A=n[15],_=s*h-i*l,R=s*u-o*l,w=s*d-c*l,b=i*u-o*h,v=i*d-c*h,I=o*d-c*u,N=f*g-p*E,S=f*T-y*E,x=f*A-m*E,M=p*T-y*g,C=p*A-m*g,P=y*A-m*T,O=_*P-R*C+w*M+b*x-v*S+I*N;if(0==O)throw new e("Matrix is not invertible.");const L=1/O;return a[0]=(h*P-u*C+d*M)*L,a[1]=(-i*P+o*C-c*M)*L,a[2]=(g*I-T*v+A*b)*L,a[3]=(-p*I+y*v-m*b)*L,a[4]=(-l*P+u*x-d*S)*L,a[5]=(s*P-o*x+c*S)*L,a[6]=(-E*I+T*w-A*R)*L,a[7]=(f*I-y*w+m*R)*L,a[8]=(l*C-h*x+d*N)*L,a[9]=(-s*C+i*x-c*N)*L,a[10]=(E*v-g*w+A*_)*L,a[11]=(-f*v+p*w-m*_)*L,a[12]=(-l*M+h*S-u*N)*L,a[13]=(s*M-i*S+o*N)*L,a[14]=(-E*b+g*R-T*_)*L,a[15]=(f*b-p*R+y*_)*L,r}invert(){return M.invert(this,this)}static add(t,e,r){const n=t.array,a=e.array,s=r.array;return s[0]=n[0]+a[0],s[1]=n[1]+a[1],s[2]=n[2]+a[2],s[3]=n[3]+a[3],s[4]=n[4]+a[4],s[5]=n[5]+a[5],s[6]=n[6]+a[6],s[7]=n[7]+a[7],s[8]=n[8]+a[8],s[9]=n[9]+a[9],s[10]=n[10]+a[10],s[11]=n[11]+a[11],s[12]=n[12]+a[12],s[13]=n[13]+a[13],s[14]=n[14]+a[14],s[15]=n[15]+a[15],r}add(t){return M.add(this,t,this)}static sub(t,e,r){const n=t.array,a=e.array,s=r.array;return s[0]=n[0]-a[0],s[1]=n[1]-a[1],s[2]=n[2]-a[2],s[3]=n[3]-a[3],s[4]=n[4]-a[4],s[5]=n[5]-a[5],s[6]=n[6]-a[6],s[7]=n[7]-a[7],s[8]=n[8]-a[8],s[9]=n[9]-a[9],s[10]=n[10]-a[10],s[11]=n[11]-a[11],s[12]=n[12]-a[12],s[13]=n[13]-a[13],s[14]=n[14]-a[14],s[15]=n[15]-a[15],r}sub(t){return M.sub(this,t,this)}static mult(t,e,r){const n=t.array,a=e.array,s=r.array,i=n[0],o=n[1],c=n[2],l=n[3],h=n[4],u=n[5],d=n[6],f=n[7],p=n[8],y=n[9],m=n[10],E=n[11],g=n[12],T=n[13],A=n[14],_=n[15],R=a[0],w=a[1],b=a[2],v=a[3],I=a[4],N=a[5],S=a[6],x=a[7],M=a[8],C=a[9],P=a[10],O=a[11],L=a[12],B=a[13],F=a[14],U=a[15];return s[0]=i*R+h*w+p*b+g*v,s[1]=o*R+u*w+y*b+T*v,s[2]=c*R+d*w+m*b+A*v,s[3]=l*R+f*w+E*b+_*v,s[4]=i*I+h*N+p*S+g*x,s[5]=o*I+u*N+y*S+T*x,s[6]=c*I+d*N+m*S+A*x,s[7]=l*I+f*N+E*S+_*x,s[8]=i*M+h*C+p*P+g*O,s[9]=o*M+u*C+y*P+T*O,s[10]=c*M+d*C+m*P+A*O,s[11]=l*M+f*C+E*P+_*O,s[12]=i*L+h*B+p*F+g*U,s[13]=o*L+u*B+y*F+T*U,s[14]=c*L+d*B+m*F+A*U,s[15]=l*L+f*B+E*F+_*U,r}mult(t){return M.mult(this,t,this)}getMaxScaleOnAxis(){const t=this.array,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))}writeIntoArray(t,e=0){const r=this.array;t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15]}readFromArray(t,e=0){const r=this.array;return r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],r[4]=t[e+4],r[5]=t[e+5],r[6]=t[e+6],r[7]=t[e+7],r[8]=t[e+8],r[9]=t[e+9],r[10]=t[e+10],r[11]=t[e+11],r[12]=t[e+12],r[13]=t[e+13],r[14]=t[e+14],r[15]=t[e+15],this}solve(t){const e=this.array,r=e[0],n=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],l=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],y=e[13],m=e[14],E=e[15],g=r*o-n*i,T=r*c-a*i,A=r*l-s*i,_=n*c-a*o,R=n*l-s*o,w=a*l-s*c,b=h*y-u*p,v=h*m-d*p,I=h*E-f*p,N=u*m-d*y,S=u*E-f*y,x=d*E-f*m,M=t.x,C=t.y,P=t.z,O=t.w;let L=g*x-T*S+A*N+_*I-R*v+w*b;return 0!=L&&(L=1/L),[L*((o*x-c*S+l*N)*M-(i*x-c*I+l*v)*C+(i*S-o*I+l*b)*P-(i*N-o*v+c*b)*O),L*-((n*x-a*S+s*N)*M-(r*x-a*I+s*v)*C+(r*S-n*I+s*b)*P-(r*N-n*v+a*b)*O),L*((y*w-m*R+E*_)*M-(p*w-m*A+E*T)*C+(p*R-y*A+E*g)*P-(p*_-y*T+m*g)*O),L*-((u*w-d*R+f*_)*M-(h*w-d*A+f*T)*C+(h*R-u*A+f*g)*P-(h*_-u*T+d*g)*O)]}solve2(t){const e=this.array,r=e[0],n=e[1],a=e[4],s=e[5],i=t.x-e[8],o=t.y-e[9];let c=r*s-n*a;return 0!=c&&(c=1/c),[c*(s*i-n*o),c*(r*o-a*i)]}solve3(t){const e=this.array,r=e[0],n=e[1],a=e[2],s=e[4],i=e[5],o=e[6],c=e[8],l=e[9],h=e[10],u=t.x-e[12],d=t.y-e[13],f=t.z-e[14];let p=i*h-o*l,y=o*c-s*h,m=s*l-i*c,E=r*p+n*y+a*m;0!=E&&(E=1/E);const g=E*(u*p+d*y+f*m);p=-(l*f-h*d),y=-(h*u-c*f),m=-(c*d-l*u);const T=E*(r*p+n*y+a*m);return p=-(d*o-f*i),y=-(f*s-u*o),m=-(u*i-d*s),[g,T,E*(r*p+n*y+a*m)]}static translation(t){return(new M).setTranslation(t)}setTranslation(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2];return e[12]=n,e[13]=a,e[14]=s,this}translate(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2],i=e[0]*n+e[4]*a+e[8]*s+1*e[12],o=e[1]*n+e[5]*a+e[9]*s+1*e[13],c=e[2]*n+e[6]*a+e[10]*s+1*e[14],l=e[3]*n+e[7]*a+e[11]*s+1*e[15];return e[12]=i,e[13]=o,e[14]=c,e[15]=l,this}static rotationX(t){return(new M).setRotationX(t)}setRotationX(t){const e=this.array,r=Math.cos(t),n=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}rotateX(t){const e=this.array,r=Math.cos(t),n=Math.sin(t),a=e[4]*r+e[8]*n,s=e[5]*r+e[9]*n,i=e[6]*r+e[10]*n,o=e[7]*r+e[11]*n,c=e[4]*-n+e[8]*r,l=e[5]*-n+e[9]*r,h=e[6]*-n+e[10]*r,u=e[7]*-n+e[11]*r;return e[4]=a,e[5]=s,e[6]=i,e[7]=o,e[8]=c,e[9]=l,e[10]=h,e[11]=u,this}static rotationY(t){return(new M).setRotationY(t)}setRotationY(t){const e=this.array,r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}rotateY(t){const e=this.array,r=Math.cos(t),n=Math.sin(t),a=e[0]*r+e[8]*-n,s=e[1]*r+e[9]*-n,i=e[2]*r+e[10]*-n,o=e[3]*r+e[11]*-n,c=e[0]*n+e[8]*r,l=e[1]*n+e[9]*r,h=e[2]*n+e[10]*r,u=e[3]*n+e[11]*r;return e[0]=a,e[1]=s,e[2]=i,e[3]=o,e[8]=c,e[9]=l,e[10]=h,e[11]=u,this}static rotationZ(t){return(new M).setRotationZ(t)}setRotationZ(t){const e=this.array,r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}rotateZ(t){const e=this.array,r=Math.cos(t),n=Math.sin(t),a=e[0]*r+e[4]*n,s=e[1]*r+e[5]*n,i=e[2]*r+e[6]*n,o=e[3]*r+e[7]*n,c=e[0]*-n+e[4]*r,l=e[1]*-n+e[5]*r,h=e[2]*-n+e[6]*r,u=e[3]*-n+e[7]*r;return e[0]=a,e[1]=s,e[2]=i,e[3]=o,e[4]=c,e[5]=l,e[6]=h,e[7]=u,this}static rotation(t){return(new M).rotation(t)}rotation(t){const e=this.array,r=t.array;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[4]=r[3],e[5]=r[4],e[6]=r[5],e[8]=r[6],e[9]=r[7],e[10]=r[8],this}rotate(t,e){const r=this.array,n=t.array,a=t.length(),s=n[0]/a,i=n[1]/a,o=n[2]/a,c=Math.cos(e),l=Math.sin(e),h=1-c,u=s*s*h+c,d=s*i*h-o*l,f=s*o*h+i*l,p=i*s*h+o*l,y=i*i*h+c,m=i*o*h-s*l,E=o*s*h-i*l,g=o*i*h+s*l,T=o*o*h+c,A=r[0]*u+r[4]*p+r[8]*E,_=r[1]*u+r[5]*p+r[9]*E,R=r[2]*u+r[6]*p+r[10]*E,w=r[3]*u+r[7]*p+r[11]*E,b=r[0]*d+r[4]*y+r[8]*g,v=r[1]*d+r[5]*y+r[9]*g,I=r[2]*d+r[6]*y+r[10]*g,N=r[3]*d+r[7]*y+r[11]*g,S=r[0]*f+r[4]*m+r[8]*T,x=r[1]*f+r[5]*m+r[9]*T,M=r[2]*f+r[6]*m+r[10]*T,C=r[3]*f+r[7]*m+r[11]*T;return r[0]=A,r[1]=_,r[2]=R,r[3]=w,r[4]=b,r[5]=v,r[6]=I,r[7]=N,r[8]=S,r[9]=x,r[10]=M,r[11]=C,this}static scaling(t){return(new M).setScaling(t)}setScaling(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2];return e[0]=n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}scale(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2];return e[0]*=n,e[1]*=n,e[2]*=n,e[3]*=n,e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a,e[8]*=s,e[9]*=s,e[10]*=s,e[11]*=s,e[12]*=1,e[13]*=1,e[14]*=1,e[15]*=1,this}static lookAt(t,e,r,n){const a=t.array,s=r.array,i=e.array,o=n.array,c=a[0],l=a[1],h=a[2],u=s[0],d=s[1],f=s[2];let p,y,m,E,g,T,A,_,R,w;return A=c-i[0],_=l-i[1],R=h-i[2],w=Math.hypot(A,_,R),w>0&&(w=1/Math.hypot(A,_,R),A*=w,_*=w,R*=w),p=d*R-f*_,y=f*A-u*R,m=u*_-d*A,w=Math.hypot(p,y,m),w>0&&(w=1/w,p*=w,y*=w,m*=w),E=_*m-R*y,g=R*p-A*m,T=A*y-_*p,w=Math.hypot(E,g,T),w>0&&(w=1/w,E*=w,g*=w,T*=w),o[0]=p,o[1]=y,o[2]=m,o[3]=0,o[4]=E,o[5]=g,o[6]=T,o[7]=0,o[8]=A,o[9]=_,o[10]=R,o[11]=0,o[12]=c,o[13]=l,o[14]=h,o[15]=1,n}lookAt(t,e,r){return M.lookAt(t,e,r,this)}transformPoint(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2],i=n*e[3]+a*e[7]+s*e[11]+e[15];return t.setValues((n*e[0]+a*e[4]+s*e[8]+e[12])/i,(n*e[1]+a*e[5]+s*e[9]+e[13])/i,(n*e[2]+a*e[6]+s*e[10]+e[14])/i),t}transformPoint4(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2],i=r[3],o=n*e[3]+a*e[7]+s*e[11]+i*e[15];return t.setValues((n*e[0]+a*e[4]+s*e[8]+e[12])/o,(n*e[1]+a*e[5]+s*e[9]+e[13])/o,(n*e[2]+a*e[6]+s*e[10]+e[14])/o,(n*e[3]+a*e[7]+s*e[11]+e[15])/o),t}transformDirection(t){const e=this.array,r=t.array,n=r[0],a=r[1],s=r[2];return t.setValues(n*e[0]+a*e[4]+s*e[8],n*e[1]+a*e[5]+s*e[9],n*e[2]+a*e[6]+s*e[10]),t}transformNormal(t){const e=t.array,r=this.invert().array,n=e[0],a=e[1],s=e[2];return t.setValues(n*r[0]+a*r[4]+s*r[8],n*r[1]+a*r[5]+s*r[9],n*r[2]+a*r[6]+s*r[10]),this.invert(),t}static perspective(t,e,r,n){return(new M).setPerspective(t,e,r,n)}setPerspective(t,e,r,n){const a=this.array,s=Math.tan(.5*Math.PI-.5*t),i=s/e,o=1/(r-n);return a[0]=i,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(r+n)*o,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*r*n*o,a[15]=0,this}static orthographic(t,e,r,n,a,s){return(new M).setOrthographic(t,e,r,n,a,s)}setOrthographic(t,e,r,n,a,s){const i=this.array;return i[0]=2/(e-t),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(n-r),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2/(a-s),i[11]=0,i[12]=(e+t)/(t-e),i[13]=(n+r)/(r-n),i[14]=(s+a)/(a-s),i[15]=1,this}static frustum(t,e,r,n,a,s){return(new M).setFrustum(t,e,r,n,a,s)}setFrustum(t,e,r,n,a,s){const i=this.array,o=1/(e-t),c=1/(n-r),l=1/(a-s);return i[0]=2*a*o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*a*c,i[6]=0,i[7]=0,i[8]=(e+t)*o,i[9]=(n+r)*c,i[10]=(s+a)*l,i[11]=-1,i[12]=0,i[13]=0,i[14]=s*a*2*l,i[15]=0,this}}var C=M;new t({defaultCtor:M,onDefaultOverride:t=>{C=t}});const P=new class extends R{constructor(t,e){super(t,e),this._buffer=new Float32Array(0),this._bufferViews=Array(e?.size||0).fill(0).map((()=>this._buffer.subarray())),this._extensions=[]}}(c),O=new class{constructor(){this._count=0}newUUID(){return(++this._count).toString(16)}},L=new C,B=class{constructor(t,e){this.uuid=O.newUUID(),this.owner=t||null,this.isStatic=e??!1,this.array=new Float32Array(16),this.localArray=new Float32Array(16),this.matrix=new C(this.array).setIdentity(),this.localMatrix=new C(this.localArray).setIdentity(),this.hasChanged=!1}getMatrix(t){const e=this.array,r=t.array;return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],t}setMatrix(t){const e=this.array,r=t.array;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}getLocalMatrix(t){const e=this.localArray,r=t.array;return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],t}setLocalMatrix(t){const e=this.localArray,r=t.array;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}getRight(t){const e=this.array,r=t.array;return r[0]=e[0],r[1]=e[1],r[2]=e[2],t}getLeft(t){const e=this.array,r=t.array;return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],t}getUp(t){const e=this.array,r=t.array;return r[0]=e[4],r[1]=e[5],r[2]=e[6],t}getDown(t){const e=this.array,r=t.array;return r[0]=-e[4],r[1]=-e[5],r[2]=-e[6],t}getForward(t){const e=this.array,r=t.array;return r[0]=e[8],r[1]=e[9],r[2]=e[10],t}getBackward(t){const e=this.array,r=t.array;return r[0]=-e[8],r[1]=-e[9],r[2]=-e[10],t}getTranslation(t){const e=this.array,r=t.array;return r[0]=e[12],r[1]=e[13],r[2]=e[14],t}setTranslation(t){const e=this.array,r=t.array;return e[12]=r[0],e[13]=r[1],e[14]=r[2],this}translate(t){const e=this.array,r=t.array;return e[12]+=r[0],e[13]+=r[1],e[14]+=r[2],this}getScaling(t){const e=this.array,r=t.array;return r[0]=e[0],r[1]=e[5],r[2]=e[10],t}setScaling(t){const e=this.array,r=t.array;return e[0]=r[0],e[5]=r[1],e[10]=r[2],this}scale(t){const e=this.array,r=t.array;return e[0]*=r[0],e[5]*=r[1],e[10]*=r[2],this}getRotation(t){return t.setMatrix(this.matrix),t}setRotation(t){return this.matrix.setRotation(t),this}rotate(t){return this.matrix.mult(t.getMatrix4(L)),this}transformPoint(t){return t}transformDirection(t){return t}transformVector(t){return t}lookAt(t,e){const r=this.getTranslation(P.acquire(1)[0]);return this.matrix.lookAt(r,t,e),P.release(1),this}};class F{constructor(t,e){this.normal=t??new c,this.constant=e??0}static fromNormalAndConstant(t,e){return(new F).setFromNormalAndConstant(t,e)}static fromNormalAndCoplanarPoint(t,e){return(new F).setFromNormalAndCoplanarPoint(t,e)}static fromCoplanarPoints(t,e,r){return(new F).setFromCoplanarPoints(t,e,r)}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}set(t,e,r,n){return this.normal.setValues(t,e,r),this.constant=n,this}setFromNormalAndConstant(t,e){return this.normal.copy(t),this.constant=e,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,r){const n=r.clone(),[a]=P.acquire(1);return a.copy(t),n.sub(e).cross(a.sub(e)).normalize(),this.setFromNormalAndCoplanarPoint(n,t),P.release(1),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}normalized(){const t=1/this.normal.length();return this.normal.scale(t),this.constant*=t,this}static intersection(t,e,r,n){const{normal:a,constant:s}=t,{normal:i,constant:o}=e,{normal:c,constant:l}=r;n.copy(i).cross(c);const h=-a.dot(n),[u,d,f]=n.scale(s).array;n.copy(c).cross(a);const[p,y,m]=n.scale(o).array;n.copy(a).cross(i);const[E,g,T]=n.scale(l).array;return n.setValues((u+p+E)/h,(d+y+g)/h,(f+m+T)/h),n}}var U=F;new t({defaultCtor:F,onDefaultOverride:t=>{U=t}});const D=new c;class k{constructor(){this.nearPlane=new U,this.farPlane=new U,this.topPlane=new U,this.bottomPlane=new U,this.leftPlane=new U,this.rightPlane=new U,this.extents=new Array(8).fill(0).map((t=>new c))}set(t,e,r,n,a,s){const{nearPlane:i,farPlane:o,bottomPlane:c,topPlane:l,leftPlane:h,rightPlane:u}=this;return i.copy(t),o.copy(e),l.copy(r),c.copy(n),h.copy(a),u.copy(s),this}copy(t){const{nearPlane:e,farPlane:r,bottomPlane:n,topPlane:a,leftPlane:s,rightPlane:i}=t;return this.set(e,r,a,n,s,i),this}clone(){return(new k).copy(this)}setFromMatrix(t){const{nearPlane:e,farPlane:r,bottomPlane:n,topPlane:a,leftPlane:s,rightPlane:i,extents:o}=this,[c,l,h,u,d,f,p,y,m,E,g,T,A,_,R,w]=t.array;return i.set(u-c,y-d,T-m,w-A).normalized(),s.set(u+c,y+d,T+m,w+A).normalized(),n.set(u+l,y+f,T+E,w+_).normalized(),a.set(u-l,y-f,T-E,w-_).normalized(),r.set(u-h,y-p,T-g,w-R).normalized(),e.set(u+h,y+p,T+g,w+R).normalized(),U.intersection(s,n,e,o[0]),U.intersection(s,a,e,o[1]),U.intersection(i,n,e,o[2]),U.intersection(i,a,e,o[3]),U.intersection(s,n,r,o[4]),U.intersection(s,a,r,o[5]),U.intersection(i,n,r,o[6]),U.intersection(i,a,r,o[7]),this}intersectsSphere(t){const{nearPlane:e,farPlane:r,bottomPlane:n,topPlane:a,leftPlane:s,rightPlane:i}=this,{center:o,radius:c}=t;return o.dot(e.normal)+e.constant+c<=0||o.dot(r.normal)+r.constant+c<=0||o.dot(n.normal)+n.constant+c<=0||o.dot(a.normal)+a.constant+c<=0||o.dot(s.normal)+s.constant+c<=0||o.dot(i.normal)+i.constant+c<=0}intersectsBox(t){const{max:e,min:r}=t,{nearPlane:n,farPlane:a,bottomPlane:s,topPlane:i,leftPlane:o,rightPlane:c}=this;return n.distanceToPoint(D.setValues(n.normal.x>0?e.x:r.x,n.normal.y>0?e.y:r.y,n.normal.z>0?e.z:r.z))>=0&&a.distanceToPoint(D.setValues(a.normal.x>0?e.x:r.x,a.normal.y>0?e.y:r.y,a.normal.z>0?e.z:r.z))>=0&&s.distanceToPoint(D.setValues(s.normal.x>0?e.x:r.x,s.normal.y>0?e.y:r.y,s.normal.z>0?e.z:r.z))>=0&&i.distanceToPoint(D.setValues(i.normal.x>0?e.x:r.x,i.normal.y>0?e.y:r.y,i.normal.z>0?e.z:r.z))>=0&&o.distanceToPoint(D.setValues(o.normal.x>0?e.x:r.x,o.normal.y>0?e.y:r.y,o.normal.z>0?e.z:r.z))>=0&&c.distanceToPoint(D.setValues(c.normal.x>0?e.x:r.x,c.normal.y>0?e.y:r.y,c.normal.z>0?e.z:r.z))>=0}getEdges(t){const{extents:e}=this,r=e[0],n=e[1],a=e[2],s=e[3],i=e[4],o=e[5],c=e[6],l=e[7];return t[0].copy(o).sub(n),t[1].copy(l).sub(s),t[2].copy(i).sub(r),t[3].copy(c).sub(a),t[4].copy(l).sub(o),t[5].copy(s).sub(a),t}getExtents(t){const{extents:e}=this;return t[0].copy(e[0]),t[1].copy(e[1]),t[2].copy(e[2]),t[3].copy(e[3]),t[4].copy(e[4]),t[5].copy(e[5]),t[6].copy(e[6]),t[7].copy(e[7]),t}containsPoint(t){const{nearPlane:e,farPlane:r,bottomPlane:n,topPlane:a,leftPlane:s,rightPlane:i}=this;return e.distanceToPoint(t)>=0&&r.distanceToPoint(t)>=0&&n.distanceToPoint(t)>=0&&a.distanceToPoint(t)>=0&&s.distanceToPoint(t)>=0&&i.distanceToPoint(t)>=0}}var G,V,H,X,j,W,z=k;!function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(G||(G={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(V||(V={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(H||(H={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT"}(X||(X={})),function(t){t.VEC2="VEC2",t.VEC3="VEC3",t.VEC4="VEC4"}(j||(j={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT"}(W||(W={}));class Y{static getDataTypeNumComponents(t){switch(t){case j.VEC2:return 2;case j.VEC3:return 3;case j.VEC4:return 4}}static getComponentTypeArrayConstructor(t){switch(t){case X.FLOAT:return Float32Array;case X.BYTE:case X.UNSIGNED_BYTE:return Uint8Array;case X.SHORT:return Int16Array;case X.UNSIGNED_SHORT:return Uint16Array;case X.INT:return Int32Array;case X.UNSIGNED_INT:return Uint32Array}}static getArrayComponentType(t){return t instanceof Float32Array?X.FLOAT:t instanceof Int32Array?X.INT:t instanceof Uint32Array?X.UNSIGNED_INT:t instanceof Int16Array?X.SHORT:t instanceof Uint16Array?X.UNSIGNED_SHORT:t instanceof Int8Array?X.BYTE:X.UNSIGNED_BYTE}static createVertexElementArrayBuffer(t,e){const r=t.createBuffer();if(null===r)return null;const n=G.STATIC_READ,a=t.ELEMENT_ARRAY_BUFFER,{byteLength:s}=e,i=this.getElementArrayBufferType(e);return t.bindBuffer(a,r),t.bufferData(a,e,n),{internalBuffer:r,target:a,usage:n,byteLength:s,indexType:i}}static createVertexArrayBuffer(t,e,r,n,a){const{internalProgram:s}=e,i=G.STATIC_READ;a=a??!1,n=n??i;const o=r?Object.entries(r):null,c=null!==o?o.reduce(((t,[e,r])=>t+(r.array?.byteLength??r.byteLength??0)),0):0,l=t.createBuffer();if(null===l)return null;const h=t.ARRAY_BUFFER;t.bindBuffer(h,l);const u=new ArrayBuffer(c);let d=0;const f={};if(null!==o){o.forEach((([t,e])=>{const{array:r,componentType:n,byteLength:a}=e;if(!(r||n&&a))throw new Error("Every attribute requires either an array or a componentType and a byteLength")})),d=a?o.reduce(((t,[e,r])=>{const{constant:n}=r;if(!n){const{array:e,type:n,componentType:a}=r,{BYTES_PER_ELEMENT:s}=e??this.getComponentTypeArrayConstructor(a);return t+s*this.getDataTypeNumComponents(n)}return t}),0):0;const e=a?Math.trunc(c/d):0;let r,n=0;o.forEach((([i,o])=>{const{array:c,type:l}=o;let{constant:h=!1,divisor:p,normalize:y,componentType:m}=o;m=c?this.getArrayComponentType(c):m;const E=t.getAttribLocation(s,i);if(-1===E)return void console.warn(`Attribute ${i} could not be located.`);const g=this.getDataTypeNumComponents(l);if(p=p??0,y=y??!1,t.vertexAttribPointer(E,g,m,y,d,n),p>0&&t.vertexAttribDivisor(E,p),h){if(!c)throw new Error("constant flag requires an array parameter");switch(r=c,g){case 1:t.vertexAttrib1fv(E,r);break;case 2:t.vertexAttrib2fv(E,r);break;case 3:t.vertexAttrib3fv(E,r);break;case 4:t.vertexAttrib4fv(E,r)}}else{if(!h){const{array:t,type:s}=o,c=this.getDataTypeNumComponents(s);let l=0,E=0;if(a)if(t){({BYTES_PER_ELEMENT:E,byteLength:l}=t);const r=new(this.getComponentTypeArrayConstructor(this.getArrayComponentType(t)))(u,n),a=d/E;for(let n=0;n<e;n++){let e=n*c;r.set(t.slice(e,e+c),n*a)}}else({BYTES_PER_ELEMENT:E}=this.getComponentTypeArrayConstructor(m)),l=o.byteLength;else t?(({BYTES_PER_ELEMENT:E,byteLength:l}=t),new(Y.getComponentTypeArrayConstructor(Y.getArrayComponentType(t)))(u,n).set(t)):(({BYTES_PER_ELEMENT:E}=this.getComponentTypeArrayConstructor(m)),l=o.byteLength);f[i]={constantValue:r,numComponents:c,divisor:p,componentType:m,constant:h,byteOffset:n,bytesPerElement:E,type:s,normalize:y},n+=a?E*c:l}t.enableVertexAttribArray(E)}}))}return t.bufferData(h,u,n),{internalBuffer:l,target:h,usage:n,byteLength:c,interleaved:a,byteStride:d,vertexAttributes:f}}static setVertexArrayValues(t,e,r){const{attributes:n,elementsCount:a}=r;Object.keys(n).forEach((r=>{const{verticesBuffers:a}=e,s=a.find((t=>r in t.vertexAttributes));if(s){const{internalBuffer:e,target:a,byteStride:i,interleaved:o,vertexAttributes:c}=s;t.getParameter(t.ARRAY_BUFFER_BINDING)!==e&&t.bindBuffer(a,e);const l=n[r],{byteOffset:h,numComponents:u}=c[r];let{array:d,srcOffset:f,srcLength:p}=l;const{length:y}=d;let m=h;if(o){(f||p)&&(d=d.slice(f??0,p));const e=o?Math.trunc(y/u):0;let r=0;for(let n=0;n<e;n++)t.bufferSubData(a,m,d,r,u),r+=u,m+=i}else f=f??0,p=p??y,t.bufferSubData(a,0,d,f,p)}}))}static setVertexArrayBufferData(t,e,r,n,a,s){const{internalBuffer:i,target:o}=e;t.bindBuffer(o,i),n=n??0,a=a??0,t.bufferSubData(o,n,r,a,s)}static createVertexArray(t,e,r){const{vertexAttributes:n,vertexBuffers:a,elementIndices:s,elementBuffer:i}=r,o=t.createVertexArray();if(null===o)return null;t.bindVertexArray(o);const c=n?Object.entries(n):[],{internalProgram:l}=e,h=[];if(a)a.forEach(((r,n)=>{const a=Object.fromEntries(c.filter((([t,e])=>e.buffer==n)));let s=null;if(void 0!==r){if("internalBuffer"in r){const{target:e,internalBuffer:n}=r;s=r,t.bindBuffer(e,n);const{byteStride:a,vertexAttributes:i}=s;Object.entries(i).forEach((([e,r])=>{const{numComponents:n,componentType:s,normalize:i,byteOffset:o,divisor:c,constant:h,constantValue:u}=r,d=t.getAttribLocation(l,e);if(d>-1)if(t.vertexAttribPointer(d,n,s,i,a,o),c>0&&t.vertexAttribDivisor(d,c),h&&u)switch(n){case 1:t.vertexAttrib1fv(d,u);break;case 2:t.vertexAttrib2fv(d,u);break;case 3:t.vertexAttrib3fv(d,u);break;case 4:t.vertexAttrib4fv(d,u)}else t.enableVertexAttribArray(d)}))}else if(a){const{usage:n,interleaved:i}=r;s=this.createVertexArrayBuffer(t,e,a,n,i)}}else a&&(s=this.createVertexArrayBuffer(t,e,a));if(null===s)return null;h.push(s)}));else if(n){let r=null;if(r=this.createVertexArrayBuffer(t,e,n),null===r)return null;h.push(r)}let u;if(void 0!==i)if("internalBuffer"in i){const{target:e,internalBuffer:r}=i;u=i,t.bindBuffer(e,r)}else s&&(u=this.createVertexElementArrayBuffer(t,s));else s&&(u=this.createVertexElementArrayBuffer(t,s));return null===u?null:{verticesBuffers:h,elementBuffer:u,program:e,internalVertexArray:o}}static deleteVertexArray(t,e){const{internalVertexArray:r}=e;t.isVertexArray(r)&&t.deleteVertexArray(r)}static getElementArrayBufferType(t){return t instanceof Uint8Array?W.UNSIGNED_BYTE:t instanceof Uint16Array?W.UNSIGNED_SHORT:W.UNSIGNED_INT}}var q,$=class{constructor(t={},e,r){if(t){const n=Object.entries(t),a=n.reduce(((t,[e,r])=>t+r.array.byteLength),0),s=new ArrayBuffer(a),i=r?n.reduce(((t,[e,r])=>{const{array:n,type:a}=r;return t+n.BYTES_PER_ELEMENT*Y.getDataTypeNumComponents(a)}),0):0,o=Math.trunc(a/i);this.attributes={},this.indices=e,this.interleaved=r??!1,this.stride=i,this.buffer=s;let c=0;r?Object.entries(t).forEach((([t,e])=>{const{array:r,type:n,constant:a,normalize:l}=e,h=Y.getArrayComponentType(r),u=Y.getDataTypeNumComponents(n),d=Y.getComponentTypeArrayConstructor(Y.getArrayComponentType(r)),{byteLength:f,BYTES_PER_ELEMENT:p}=r,y=new d(s,c),m=i/p;for(let t=0;t<o;t++){let e=t*u;y.set(r.slice(e,e+u),t*m)}this.attributes[t]={type:n,byteOffset:c,byteLength:f,componentType:h,constant:a,normalize:l},c+=u*p})):Object.entries(t).forEach((([t,e])=>{const{array:r,type:n}=e,{byteLength:a}=r,i=Y.getArrayComponentType(r);new(Y.getComponentTypeArrayConstructor(Y.getArrayComponentType(r)))(s,c).set(r),this.attributes[t]={byteOffset:c,byteLength:a,type:n,componentType:i},c+=a}))}else this.attributes={},this.indices=void 0,this.interleaved=!1,this.stride=0,this.buffer=new ArrayBuffer(0)}toBlob(){const{attributes:t,buffer:e,stride:r,interleaved:n,indices:a}=this,s=new Uint8Array(e),{length:i}=s,o=Uint8Array.from(a??[]),c=a?.length??0,l=(new TextEncoder).encode(JSON.stringify({attributes:t,stride:r,interleaved:n})),{length:h}=l,u=new Uint8Array(4+h+c+i),{buffer:d}=u,f=new Uint16Array(d,0,2),p=f.length*(Uint16Array.BYTES_PER_ELEMENT/Uint8Array.BYTES_PER_ELEMENT);return f[0]=h,f[1]=c,u.set(l,p),u.set(o,p+h),u.set(s,p+h+c),new Blob([u],{type:"application/octet-stream"})}static async fromBlob(t){const e=await t.arrayBuffer(),r=new Uint16Array(e,0,2),{byteLength:n}=r,a=r[0],s=r[1],i=new Uint8Array(e,n,a),o=s<Math.pow(2,8)?Uint8Array:s<Math.pow(2,16)?Uint16Array:Uint32Array,c=new o(e.slice(n+a*Uint8Array.BYTES_PER_ELEMENT,s*o.BYTES_PER_ELEMENT)),l=e.slice(n+(s+a)*Uint8Array.BYTES_PER_ELEMENT),h=JSON.parse((new TextDecoder).decode(i)),{attributes:u,interleaved:d,stride:f}=h,p=new $;return p.buffer=l,p.attributes=u,p.interleaved=d,p.stride=f,p.indices=c,p}getAttribute(t){const{attributes:e}=this,r=e[t];if(r){const{buffer:t,interleaved:e,stride:n}=this,{type:a,byteOffset:s,byteLength:i,componentType:o}=r,c=Y.getComponentTypeArrayConstructor(o),l=i/c.BYTES_PER_ELEMENT,h=Y.getDataTypeNumComponents(a),{byteLength:u}=t,{BYTES_PER_ELEMENT:d}=c,f=new c(l);if(e){const e=new c(t,s),r=n,a=Math.trunc(u/r),i=r/d;for(let t=0;t<a;t++){let r=i*t;f.set(e.slice(r,r+h),h*t)}}else{const e=new c(t,s,l);f.set(e)}return{array:f,type:a}}return null}};!function(t){t[t.VERTICES=0]="VERTICES",t[t.UVS=1]="UVS",t[t.NORMALS=2]="NORMALS",t[t.TANGENTS=3]="TANGENTS"}(q||(q={}));class K{constructor(t,e){this.center=t,this.radius=e}transform(t){const{center:e}=this;t.transformPoint(e)}containsPoint(t){const{center:e,radius:r}=this;return e.distance(t)<r}hitsSphere(t){const{center:e,radius:r}=this,{center:n,radius:a}=t;return e.distance(n)<r+a}hitsBox(t){const{center:e,radius:r}=this,{x:n,y:a,z:s}=e,{min:i,max:o}=t,{x:c,y:l,z:h}=i,{x:u,y:d,z:f}=o,p=Math.max(c,Math.min(n,u)),y=Math.max(l,Math.min(a,d)),m=Math.max(h,Math.min(s,f));return Math.sqrt((p-n)*(p-n)+(y-a)*(y-a)+(m-s)*(m-s))<r}}const Z=new Array(8).fill(0).map((t=>new c));var Q,J,tt,et,rt,nt,at=class{constructor(t,e){this.min=t,this.max=e}static fromBoxes(...t){const e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;let n=e,a=e,s=e,i=r,o=r,l=r;return t.forEach((t=>{const{min:e,max:r}=t,{x:c,y:h,z:u}=e,{x:d,y:f,z:p}=r;c<n?n=c:d>i&&(i=d),h<a?a=h:f>o&&(o=f),u<s?s=u:p>l&&(l=p)})),new at(new c(n,a,s),new c(i,o,l))}hits(t){const{min:e,max:r}=this,{x:n,y:a,z:s}=e,{x:i,y:o,z:c}=r,{min:l,max:h}=t,{x:u,y:d,z:f}=l,{x:p,y,z:m}=h;return n<=p&&i>=u&&a<=y&&o>=d&&s<=m&&c>=f}transform(t){const{min:e,max:r}=this;let{x:n,y:a,z:s}=e,{x:i,y:o,z:c}=r;Z[0].setValues(n,a,s),Z[1].setValues(n,a,c),Z[2].setValues(n,o,s),Z[3].setValues(i,a,s),Z[4].setValues(n,o,c),Z[5].setValues(i,a,c),Z[6].setValues(i,o,s),Z[7].setValues(i,o,c);const{POSITIVE_INFINITY:l,NEGATIVE_INFINITY:h}=Number;return n=a=s=l,i=o=c=h,Z.forEach((e=>{t.transformPoint(e);const[r,l,h]=e;r<n?n=r:r>i&&(i=r),l<a?a=l:l>o&&(o=l),h<s?s=h:h>c&&(c=h)})),e.setValues(n,a,s),r.setValues(i,o,c),this}getEdges(t){const{min:e,max:r}=this,{x:n,y:a,z:s}=e,{x:i,y:o,z:c}=r;return t[0].setValues(i-n,0,0),t[1].setValues(0,o-a,0),t[2].setValues(0,0,c-s),t}getExtents(t){const{min:e,max:r}=this,{x:n,y:a,z:s}=e,{x:i,y:o,z:c}=r;return t[0].setValues(n,a,s),t[1].setValues(n,a,c),t[2].setValues(n,o,s),t[3].setValues(i,a,s),t[4].setValues(n,o,c),t[5].setValues(i,a,c),t[6].setValues(i,o,s),t[7].setValues(i,o,c),t}transformed(t){const{min:e,max:r}=this,{x:n,y:a,z:s}=e,{x:i,y:o,z:l}=r;return new at(new c(n,a,s),new c(i,o,l)).transform(t)}},st=class{constructor(){this.halfEdges=[],this.vertices=[],this.faces=[]}clone(){return Object.assign(Object.create(this.constructor.prototype),structuredClone(this))}addTriangleFace(t,e,r,n){this.addFace([t,e,r],n)}addQuadFace(t,e,r,n,a){this.addFace([t,e,r,n],a)}addVertex(t){const{vertices:e}=this,r={position:t,halfEdgeID:null};return e.push(r)-1}addFace(t,e){const{halfEdges:r,vertices:n,faces:a}=this,{length:s}=t;if(s<2)return void console.error("At least 2 vertices are required to create a face.");const i={halfEdgeID:null,...e},o=a.length;let c=null,l=null,h=null,u=null,d=null,f=null;for(let e=0;e<s;e++){if(c=t[e],l=e<s-1?t[e+1]:t[0],Array.from(this.vertexFacesIterator(c)).find((t=>null!==t&&Array.from(this.faceHalfEdgesIterator(t)).find((t=>{const{targetID:e,prevID:n}=r[t];return e===l&&r[n??-1]?.targetID===c})))))continue;u={targetID:l,twinID:null,nextID:null,prevID:null,faceID:o},d=r.length,null===f?(i.halfEdge=d,h=d):(u.prevID=f,r[f].nextID=d);const a=n[c];null===a.halfEdgeID&&(a.halfEdgeID=d);const p=r.find((t=>{const{targetID:e,prevID:n}=t;return e===c&&r[n??-1]?.targetID===l}))??null;null!==p&&(u.twinID=r.indexOf(p),p.twinID=d),f=d,r.push(u)}null!==u&&null!==h&&(r[h].prevID=d,u.nextID=h),a.push(i)}linesArray(){const{faces:t,vertices:e}=this;return new Float32Array(t.flatMap(((t,r)=>{const n=Array.from(this.faceVerticesIterator(r));if(4===n.length){const[t,r,a,s]=n.map((t=>e[t].position));return[...t,...r,...r,...a,...a,...s,...s,...t]}{const[t,r,a]=n.map((t=>e[t].position));return[...t,...r,...r,...a,...a,...t]}})))}verticesArray(){const{faces:t,vertices:e}=this;return new Float32Array(t.flatMap(((t,r)=>Array.from(this.faceVerticesIterator(r)).flatMap((t=>Array.from(e[t].position))))))}tangentsArray(){const{faces:t,vertices:e}=this;return new Float32Array(t.flatMap(((t,r)=>{const n=Array.from(this.faceVerticesIterator(r)),a=t.uv,[s,i,o]=n.map((t=>e[t].position)),[c,l,h]=a,u=i.map(((t,e)=>s[e]-t)),d=i.map(((t,e)=>o[e]-t)),f=l.map(((t,e)=>c[e]-t)),p=l.map(((t,e)=>h[e]-t)),y=1/(f[0]*p[1]-f[1]*p[0]),m=u.map(((t,e)=>-(t*p[1]-d[e]*f[1])*y)),E=Math.hypot(...m);return t.tangent=m.map((t=>t/E)),n.flatMap((()=>Array.from(t.tangent)))})))}normalsArray(){const{faces:t,vertices:e}=this;return new Float32Array(t.flatMap(((t,r)=>{const n=Array.from(this.faceVerticesIterator(r)),[a,s,i]=n.map((t=>e[t].position)),o=s.map(((t,e)=>a[e]-t)),c=s.map(((t,e)=>i[e]-t)),l=o.map(((t,e)=>{const r=(e+1)%3,n=(e-1+3)%3;return-(o[r]*c[n]-o[n]*c[r])})),h=Math.hypot(...l);return t.normal=l.map((t=>t/h)),n.flatMap((()=>Array.from(t.normal)))})))}uvsArray(){const{faces:t}=this;return new Float32Array(t.flatMap((t=>t.uv.flat(1))))}trianglesIndicesArray(){const{faces:t}=this,e=t.reduce(((t,e,r)=>t+Array.from(this.faceVerticesIterator(r)).length),0);return new(e<Math.pow(2,8)?Uint8Array:e<Math.pow(2,16)?Uint16Array:Uint32Array)(t.reduce((([t,e],r,n)=>4===Array.from(this.faceVerticesIterator(n)).length?[t.concat([e,e+1,e+2,e+1,e+3,e+2]),e+4]:[t.concat([e,e+1,e+2]),e+3]),[[],0])[0])}linesIndicesArray(){const{faces:t}=this,e=t.reduce(((t,e,r)=>t+2*Array.from(this.faceVerticesIterator(r)).length),0);return new(e<Math.pow(2,8)?Uint8Array:e<Math.pow(2,16)?Uint16Array:Uint32Array)(t.reduce((([t,e],r,n)=>4===Array.from(this.faceVerticesIterator(n)).length?[t.concat([e,e+1,e+1,e+3,e+3,e+2,e+2,e]),e+4]:[t.concat([e,e+1,e+1,e+2,e+2,e]),e+3]),[[],0])[0])}boundingBox(){const t=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY;let r=t,n=t,a=t,s=e,i=e,o=e;const{vertices:l}=this;l.length>0&&l.forEach((t=>{const[e,c,l]=t.position;e<r?r=e:e>s&&(s=e),c<n?n=c:c>i&&(i=c),l<a?a=l:l>o&&(o=l)}));const h=new c([r,n,a]),u=new c([s,i,o]);return new at(h,u)}boundingSphere(){const t=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY;let r=t,n=t,a=t,s=e,i=e,o=e;const{vertices:l}=this;l.length>0&&l.forEach((t=>{const[e,c,l]=t.position;e<r?r=e:e>s&&(s=e),c<n?n=c:c>i&&(i=c),l<a?a=l:l>o&&(o=l)}));const h=new c([r,n,a]),u=new c([s,i,o]);return new K(new c,Math.max(h.length(),u.length()))}faceHalfEdgesIterator(t){return new it(this,t)}faceVerticesIterator(t){return new ot(this,t)}vertexFacesIterator(t){return new ct(this,t)}};class it{constructor(t,e){this.geometry=t,this.faceID=e,this.halfEdgeID=null}reset(){this.halfEdgeID=null}current(){return this.halfEdgeID}next(){const{halfEdgeID:t,faceID:e,geometry:r}=this,{faces:n,halfEdges:a}=r,s=n[e];if(null!==s)if(null===t){const t=s.halfEdgeID??null,e=n[t??-1]?.nextID??null;if(this.halfEdgeID=e,null!==t)return{value:t,done:null===e}}else if(t!==s.halfEdge){const e=a[t].nextID??null;if(this.halfEdgeID=e,null!==t)return{value:t,done:null===e}}return{value:void 0,done:!0}}[Symbol.iterator](){return this.halfEdgeID=null,this}}class ot{constructor(t,e){this.geometry=t,this.faceID=e,this.halfEdgeID=null}reset(){this.halfEdgeID=null}current(){const{halfEdgeID:t,geometry:e}=this,{halfEdges:r}=e;return r[r[t??-1]?.prevID??-1]?.targetID??null}next(){const{halfEdgeID:t,geometry:e,faceID:r}=this,{faces:n,halfEdges:a}=e,s=n[r??-1];if(null!==s){const{halfEdge:e}=s;if(null===t){const t=a[a[e??-1].prevID??-1].targetID??null,r=a[e??-1].nextID??null;if(this.halfEdgeID=r,null!==t)return{value:t,done:null===r}}else if(t!==s.halfEdge){const e=a[a[t].prevID??-1].targetID??null,r=a[t].nextID??null;if(this.halfEdgeID=r,null!==e)return{value:e,done:null===r}}}return{value:void 0,done:!0}}[Symbol.iterator](){return this.halfEdgeID=null,this}}class ct{constructor(t,e){this.geometry=t,this.vertexID=e,this.halfEdgeID=null}reset(){this.halfEdgeID=null}current(){const{geometry:t,halfEdgeID:e}=this,{halfEdges:r}=t;return r[e??-1].faceID??null}next(){const{halfEdgeID:t,vertexID:e,geometry:r}=this,{halfEdges:n,vertices:a}=r,s=a[e??-1];if(s){const{halfEdgeID:e}=s;if(null===t){const t=n[e??-1]?.faceID??null,r=n[n[e??-1]?.prevID??-1]?.twinID??null;if(this.halfEdgeID=r,null!==t)return{value:t,done:null===r}}else if(t!==s.halfEdgeID){const e=n[t]?.faceID??null,r=n[n[t].prevID??-1].twinID??null;if(this.halfEdgeID=r,null!==e)return{value:e,done:null===r}}}return{value:void 0,done:!0}}[Symbol.iterator](){return this.halfEdgeID=null,this}}class lt extends class{toBuilder(){throw new Error("No builder defined.")}}{constructor(t){super();const{width:e,height:r,depth:n,widthSegments:a,heightSegments:s,depthSegments:i}=t??{};this.width=e??1,this.height=r??1,this.depth=n??1,this.widthSegments=a??1,this.heightSegments=s??1,this.depthSegments=i??1}toBuilder(){const t=new st,{width:e,height:r,depth:n}=this;let{widthSegments:a,heightSegments:s,depthSegments:i}=this;a=Math.floor(a),s=Math.floor(s),i=Math.floor(i);const o=[],c=[],l=[];let h=0;[[2,1,0,-1,-1,n,r,e,i,s],[2,1,0,1,-1,n,r,-e,i,s],[0,2,1,1,1,e,n,r,a,i],[0,2,1,1,-1,e,n,-r,a,i],[0,1,2,1,-1,e,r,n,a,s],[0,1,2,-1,-1,e,r,-n,a,s]].forEach((([t,e,r,n,a,s,i,u,d,f])=>{const p=s/d,y=i/f,m=s/2,E=i/2,g=u/2,T=d+1,A=f+1;let _=0;for(let s=0;s<A;s++){const i=s*y-E;for(let o=0;o<T;o++){const h=o*p-m,u=new Array(3);u[t]=h*n,u[e]=i*a,u[r]=g,c.push(...u),l.push(o/d,1-s/f),_++}}for(let t=0;t<f;t++)for(let e=0;e<d;e++){const r=h+e+T*t,n=h+e+T*(t+1),a=h+(e+1)+T*(t+1),s=h+(e+1)+T*t;o.push(r,n,s,a)}h+=_}));const{length:u}=o,d=[],f=[];for(let e=0;e<u;e+=4){const r=3*o[e],n=3*o[e+1],a=3*o[e+2],s=3*o[e+3],i=2*o[e],h=2*o[e+1],u=2*o[e+2],p=2*o[e+3];let y=d[r],m=d[n],E=d[a],g=d[s];void 0===y&&(y=t.addVertex([c[r],c[r+1],c[r+2]]),d[r]=y),void 0===m&&(m=t.addVertex([c[n],c[n+1],c[n+2]]),d[n]=m),void 0===E&&(E=t.addVertex([c[a],c[a+1],c[a+2]]),d[a]=E),void 0===g&&(g=t.addVertex([c[s],c[s+1],c[s+2]]),d[s]=g);let T=f[i],A=f[h],_=f[u],R=f[p];void 0===T&&(T=[l[i],l[i+1]],f[i]=T),void 0===A&&(A=[l[h],l[h+1]],f[h]=A),void 0===_&&(_=[l[u],l[u+1]],f[u]=_),void 0===R&&(R=[l[p],l[p+1]],f[p]=R),t.addQuadFace(y,m,E,g,{uv:[T,A,_,R]})}return t}}!function(t){t[t.VERTICES=0]="VERTICES",t[t.UVS=1]="UVS",t[t.NORMALS=2]="NORMALS",t[t.TANGENTS=3]="TANGENTS"}(Q||(Q={}));class ht extends class{toBuilder(){throw new Error("No builder defined.")}}{constructor(t){super(),this.width=t?.width??1,this.height=t?.height??1,this.widthSegments=t?.widthSegments??1,this.heightSegments=t?.heightSegments??1}toBuilder(){const t=new st,{heightSegments:e,widthSegments:r,width:n,height:a}=this,s=n/2,i=a/2,o=Math.floor(r),c=Math.floor(e),l=o+1,h=c+1,u=n/o,d=a/c,f=[],p=[],y=[];for(let t=0;t<h;t++){const e=t*d-i;for(let r=0;r<l;r++){const n=r*u-s;p.push(n,-e,0),y.push(r/o),y.push(1-t/c)}}for(let t=0;t<c;t++)for(let e=0;e<o;e++){const r=e+l*t,n=e+l*(t+1),a=e+1+l*(t+1),s=e+1+l*t;f.push(r,n,s),f.push(n,a,s)}const{length:m}=f,E=[],g=[];for(let e=0;e<m;e+=3){const r=3*f[e],n=3*f[e+1],a=3*f[e+2],s=2*f[e],i=2*f[e+1],o=2*f[e+2];let c=E[r],l=E[n],h=E[a];null==c&&(c=t.addVertex([p[r],p[r+1],p[r+2]]),E[r]=c),null==l&&(l=t.addVertex([p[n],p[n+1],p[n+2]]),E[n]=l),null==h&&(h=t.addVertex([p[a],p[a+1],p[a+2]]),E[a]=h);let u=g[s],d=g[i],m=g[o];null==u&&(u=[y[s],y[s+1]],g[s]=u),null==d&&(d=[y[i],y[i+1]],g[i]=d),null==m&&(m=[y[o],y[o+1]],g[o]=m),t.addTriangleFace(c,l,h,{uv:[u,d,m]})}return t}}!function(t){t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED"}(J||(J={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(tt||(tt={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT"}(et||(et={})),function(t){t[t.R8=33321]="R8",t[t.R8UI=33330]="R8UI",t[t.R8I=33329]="R8I",t[t.R16UI=33332]="R16UI",t[t.R16I=33331]="R16I",t[t.R32UI=33334]="R32UI",t[t.R32I=33333]="R32I",t[t.RG8=33323]="RG8",t[t.RG8UI=33336]="RG8UI",t[t.RG8I=33335]="RG8I",t[t.RG16UI=33338]="RG16UI",t[t.RG16I=33337]="RG16I",t[t.RG32UI=33340]="RG32UI",t[t.RG32I=33339]="RG32I",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGBA4=32854]="RGBA4",t[t.RGB565=36194]="RGB565",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGBA16I=36232]="RGBA16I",t[t.RGBA32I=36226]="RGBA32I",t[t.RGBA32UI=36208]="RGBA32UI",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8"}(rt||(rt={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(nt||(nt={}));class ut{static createFramebuffer(t){const e=t.createFramebuffer();return null===e?null:{internalFramebuffer:e}}static createRenderbuffer(t,e){const r=t.createRenderbuffer();if(null===r)return null;t.bindRenderbuffer(t.RENDERBUFFER,r);const{samples:n,internalFormat:a,width:s,height:i}=e;return void 0!==n?t.renderbufferStorageMultisample(t.RENDERBUFFER,n,a,s,i):t.renderbufferStorage(t.RENDERBUFFER,a,s,i),t.bindRenderbuffer(t.RENDERBUFFER,null),{...e,internalRenderbuffer:r}}static attachTexture(t,e,...r){const{internalFramebuffer:n}=e;t.getParameter(t.FRAMEBUFFER_BINDING)!==n&&t.bindFramebuffer(t.FRAMEBUFFER,n);const a=r.map((r=>{const{attachment:n,textureTarget:a,texture:s}=r,{internalTexture:i}=s;return t.framebufferTexture2D(t.FRAMEBUFFER,n,a,i,0),{...r,...e}})),s=t.checkFramebufferStatus(t.FRAMEBUFFER);return s!==J.FRAMEBUFFER_COMPLETE&&console.warn(`Incomplete framebuffer status: ${J[s]}`),this.unbindFramebuffer(t),a}static drawBuffers(t,e,r){const{internalFramebuffer:n}=e;t.getParameter(t.FRAMEBUFFER_BINDING)!==n&&t.bindFramebuffer(t.FRAMEBUFFER,n),t.drawBuffers(r);const a=t.checkFramebufferStatus(t.FRAMEBUFFER);a!==J.FRAMEBUFFER_COMPLETE&&console.warn(`Incomplete framebuffer status: ${J[a]}`),this.unbindFramebuffer(t)}static attachRenderbuffer(t,e,...r){const{internalFramebuffer:n}=e;t.getParameter(t.FRAMEBUFFER_BINDING)!==n&&t.bindFramebuffer(t.FRAMEBUFFER,n);const a=r.map((r=>(t.framebufferRenderbuffer(t.FRAMEBUFFER,r.attachment,t.RENDERBUFFER,r.renderbuffer.internalRenderbuffer),{...r,...e}))),s=t.checkFramebufferStatus(t.FRAMEBUFFER);return s!==J.FRAMEBUFFER_COMPLETE&&console.warn(`Incomplete framebuffer status: ${J[s]}`),this.unbindFramebuffer(t),a}static blit(t,e,r,n,a,s,i){if(t.getParameter(t.READ_FRAMEBUFFER_BINDING)!==e){const r=e?.internalFramebuffer??null;t.bindFramebuffer(t.READ_FRAMEBUFFER,r)}if(t.getParameter(t.DRAW_FRAMEBUFFER_BINDING)!==r){const e=r?.internalFramebuffer??null;t.bindFramebuffer(t.DRAW_FRAMEBUFFER,e)}t.blitFramebuffer(n[0],n[1],n[2],n[3],a[0],a[1],a[2],a[3],s,i),this.unbindFramebuffer(t)}static readPixels(t,e,r,n,a,s,i,o){t.readPixels(e,r,n,a,s,i,o)}static bindFramebuffer(t,e){const{internalFramebuffer:r}=e;t.bindFramebuffer(t.FRAMEBUFFER,r)}static unbindFramebuffer(t){t.bindFramebuffer(t.FRAMEBUFFER,null)}static deleteFramebuffer(t,e){const{internalFramebuffer:r}=e;t.isFramebuffer(r)&&t.deleteFramebuffer(r)}static deleteRenderbuffer(t,e){const{internalRenderbuffer:r}=e;t.isRenderbuffer(r)&&t.deleteRenderbuffer(r)}}var dt,ft,pt,yt,mt,Et,gt,Tt,At,_t,Rt,wt,bt,vt,It,Nt=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};!function(t){t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(pt||(pt={})),function(t){t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.R8=33321]="R8",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8=33323]="RG8",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8=32849]="RGB8",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGB565=36194]="RGB565",t[t.RGBA8=32856]="RGBA8",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.R16F=33325]="R16F",t[t.RGB16F=34843]="RGB16F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB8I=36239]="RGB8I",t[t.RGB8UI=36221]="RGB8UI",t[t.RGB16I=36233]="RGB16I",t[t.RGB16UI=36215]="RGB16UI",t[t.RGB32I=36227]="RGB32I",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA8I=36238]="RGBA8I",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGBA16I=36232]="RGBA16I",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGBA32UI=36208]="RGBA32UI"}(yt||(yt={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV"}(mt||(mt={})),function(t){t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE"}(Et||(Et={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(gt||(gt={})),function(t){t[t.LINEAR=9729]="LINEAR",t[t.NEAREST=9728]="NEAREST"}(Tt||(Tt={})),function(t){t[t.LINEAR=9729]="LINEAR",t[t.NEAREST=9728]="NEAREST",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(At||(At={})),function(t){t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.NONE=0]="NONE"}(_t||(_t={})),function(t){t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Rt||(Rt={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(wt||(wt={}));class St{static getTexturesUnitsEntries(){return Nt(this,dt,"f",ft).entries()}static createTexture(t,e,r){const n=t.createTexture();if(null===n)return null;let a=Nt(this,dt,"f",ft).get(e);null==a&&(a=Math.max(-1,...Nt(this,dt,"f",ft).values())+1,Nt(this,dt,"f",ft).set(e,a));const{pixels:s,target:i,subimages:o,width:c,height:l,format:h,internalFormat:u,type:d}=r;let{lod:f,border:p,depth:y,mipmap:m}=r;switch(f=f??0,p=p??0,y=y??0,m=m??!0,t.getParameter(t.ACTIVE_TEXTURE)!==a&&(t.activeTexture(t.TEXTURE0+a),t.bindTexture(i,n)),i){case gt.TEXTURE_2D:t.texImage2D(i,f,u,c,l,p,h,d,s),o&&o.forEach((e=>{const{xoffset:r,yoffset:n,width:a,height:s,pixels:o}=e;t.texSubImage2D(i,f,r,n,a,s,h,d,o)}));break;case gt.TEXTURE_CUBE_MAP:if(null===s)t.texImage2D(i,f,u,c,l,p,h,d,null);else if("xPos"in s){const{xPos:e,xNeg:r,yPos:n,yNeg:a,zPos:i,zNeg:o}=s;t.texImage2D(gt.TEXTURE_CUBE_MAP_POSITIVE_X,f,u,c,l,p,h,d,e),t.texImage2D(gt.TEXTURE_CUBE_MAP_NEGATIVE_X,f,u,c,l,p,h,d,r),t.texImage2D(gt.TEXTURE_CUBE_MAP_POSITIVE_Y,f,u,c,l,p,h,d,n),t.texImage2D(gt.TEXTURE_CUBE_MAP_NEGATIVE_Y,f,u,c,l,p,h,d,a),t.texImage2D(gt.TEXTURE_CUBE_MAP_POSITIVE_Z,f,u,c,l,p,h,d,i),t.texImage2D(gt.TEXTURE_CUBE_MAP_NEGATIVE_Z,f,u,c,l,p,h,d,o)}break;case gt.TEXTURE_2D_ARRAY:t.texImage3D(i,f,u,c,l,y,p,h,d,s),o&&o.forEach(((e,r)=>{const{xoffset:n,yoffset:a,zoffset:s,width:o,height:c,depth:l,pixels:u}=e;t.texSubImage3D(i,f,n,a,s,o,c,l,h,d,u)}))}m&&t.generateMipmap(i);const{min:E,mag:g,wrapS:T,wrapT:A,wrapR:_,baseMipmapLevel:R,maxMipmapLevel:w,compareFunction:b,compareMode:v,minLod:I,maxLod:N}=r;return void 0!==E&&t.texParameteri(i,Et.TEXTURE_MIN_FILTER,E),void 0!==g&&t.texParameteri(i,Et.TEXTURE_MAG_FILTER,g),void 0!==T&&t.texParameteri(i,Et.TEXTURE_WRAP_S,T),void 0!==A&&t.texParameteri(i,Et.TEXTURE_WRAP_T,A),void 0!==_&&t.texParameteri(i,Et.TEXTURE_WRAP_R,_),void 0!==R&&t.texParameteri(i,Et.TEXTURE_BASE_LEVEL,R),void 0!==w&&t.texParameteri(i,Et.TEXTURE_MAX_LEVEL,w),void 0!==b&&t.texParameteri(i,Et.TEXTURE_COMPARE_FUNC,b),void 0!==v&&t.texParameteri(i,Et.TEXTURE_COMPARE_MODE,v),void 0!==I&&t.texParameterf(i,Et.TEXTURE_MIN_LOD,I),void 0!==N&&t.texParameterf(i,Et.TEXTURE_MAX_LOD,N),{unit:a,internalTexture:n,name:e,properties:{pixels:s,target:i,subimages:o,lod:f,width:c,height:l,format:h,internalFormat:u,type:d,min:E,mag:g,wrapS:T,wrapT:A,wrapR:_,baseMipmapLevel:R,maxMipmapLevel:w,compareFunction:b,compareMode:v,minLod:I,maxLod:N}}}static setUnpackAlignment(t,e){t.pixelStorei(t.UNPACK_ALIGNMENT,e)}static deleteTexture(t,e){const{internalTexture:r,name:n}=e;t.isTexture(r)&&(t.deleteTexture(r),Nt(this,dt,"f",ft).delete(n))}}dt=St,ft={value:new Map},function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(bt||(bt={}));class xt{static createShader(t,e,r){const n=t.createShader(e);if(null===n)return null;if(t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return{type:e,internalShader:n,source:r};const a=t.getShaderInfoLog(n);return null!==a&&console.warn(a),t.deleteShader(n),null}static createProgram(t,e){const{vertexSource:r,fragmentSource:n}=e,a=this.createShader(t,bt.VERTEX_SHADER,r);if(null===a)return null;const s=this.createShader(t,bt.FRAGMENT_SHADER,n);if(null===s)return null;const i=t.createProgram();if(null===i)return null;const o={internalProgram:i,vertexShader:a,fragmentShader:s};if(t.attachShader(i,a.internalShader),t.attachShader(i,s.internalShader),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS))return o;const c=t.getProgramInfoLog(i);if(null!==c){const e=t.getShaderInfoLog(a.internalShader),r=t.getShaderInfoLog(s.internalShader);console.warn(c),console.warn(e),console.warn(r)}return this.deleteProgram(t,o),null}static recompileProgram(t,e,r){const{internalProgram:n,vertexShader:a,fragmentShader:s}=e;let{vertexSource:i,fragmentSource:o}=r;if("string"==typeof i){const{internalShader:e}=a;t.shaderSource(e,i),t.compileShader(e),a.source=i}if("string"==typeof o){const{internalShader:e}=s;t.shaderSource(e,o),t.compileShader(e),s.source=o}if(t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS))return e;const c=t.getProgramInfoLog(n);if(null!==c){const e=t.getShaderInfoLog(a.internalShader),r=t.getShaderInfoLog(s.internalShader);console.warn(c),console.warn(e),console.warn(r)}return e}static deleteProgram(t,e){const{vertexShader:r,fragmentShader:n,internalProgram:a}=e;t.deleteShader(r.internalShader),t.deleteShader(n.internalShader),t.deleteProgram(a)}static useProgram(t,e){const{internalProgram:r}=e;t.getParameter(t.CURRENT_PROGRAM)!==r&&t.useProgram(r)}}!function(t){t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW"}(vt||(vt={})),function(t){t.SCALAR="SCALAR",t.VEC2="VEC2",t.VEC3="VEC3",t.VEC4="VEC4",t.MAT2="MAT2",t.MAT3="MAT3",t.MAT4="MAT4"}(It||(It={}));class Mt{static asArrayBufferView(t){return"object"==typeof t?"buffer"in t?t:"unit"in t?Float32Array.of(t.unit):Float32Array.from(t):Float32Array.of(t)}static getUniformSetter(t,e,r,n){const{value:a,srcOffset:s,srcLength:i}=e;let{transpose:o=!1}=e;switch(n){case vt.FLOAT:if("number"==typeof a)return{type:n,set:e=>{t.uniform1f(r,e)}};break;case vt.UNSIGNED_INT:if("number"==typeof a)return{type:n,set:e=>{t.uniform1ui(r,e)}};break;case vt.BOOL:case vt.INT:if("number"==typeof a)return{type:n,set:e=>{t.uniform1i(r,e)}};break;case vt.INT_SAMPLER_2D:case vt.INT_SAMPLER_2D_ARRAY:case vt.INT_SAMPLER_3D:case vt.INT_SAMPLER_CUBE:case vt.SAMPLER_2D:case vt.SAMPLER_3D:case vt.SAMPLER_CUBE:case vt.SAMPLER_2D_SHADOW:case vt.SAMPLER_2D_ARRAY:case vt.SAMPLER_2D_ARRAY_SHADOW:case vt.SAMPLER_CUBE_SHADOW:case vt.UNSIGNED_INT_SAMPLER_2D:case vt.UNSIGNED_INT_SAMPLER_3D:case vt.UNSIGNED_INT_SAMPLER_CUBE:case vt.UNSIGNED_INT_SAMPLER_2D_ARRAY:if("object"==typeof a&&"unit"in a)return{type:n,set:e=>{const{unit:n}=e;t.uniform1i(r,n)}};break;case vt.FLOAT_VEC2:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform2fv(r,e,s,i)}};break;case vt.BOOL_VEC2:case vt.INT_VEC2:if(a instanceof Int32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform2iv(r,e)}};break;case vt.UNSIGNED_INT_VEC2:if(a instanceof Uint32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform2uiv(r,e,s,i)}};break;case vt.FLOAT_VEC3:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform3fv(r,e,s,i)}};break;case vt.BOOL_VEC3:case vt.INT_VEC3:if(a instanceof Int32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform3iv(r,e,s,i)}};break;case vt.UNSIGNED_INT_VEC3:if(a instanceof Uint32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform3uiv(r,e,s,i)}};break;case vt.FLOAT_VEC4:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform4fv(r,e,s,i)}};break;case vt.BOOL_VEC4:case vt.INT_VEC4:if(a instanceof Int32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform4iv(r,e,s,i)}};break;case vt.UNSIGNED_INT_VEC4:if(a instanceof Uint32Array||Array.isArray(a))return{type:n,set:e=>{t.uniform4uiv(r,e,s,i)}};break;case vt.FLOAT_MAT2:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix2fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT3:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix3fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT4:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix4fv(r,o,e)}};break;case vt.FLOAT_MAT2x3:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix2x3fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT2x4:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix2x4fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT3x2:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix3x2fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT3x4:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix3x4fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT4x2:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix4x2fv(r,o,e,s,i)}};break;case vt.FLOAT_MAT4x3:if(a instanceof Float32Array||Array.isArray(a))return{type:n,set:e=>{t.uniformMatrix4x3fv(r,o,e,s,i)}}}return null}static getUniformsListSetter(t,e,r){const{internalProgram:n}=e,a=Object.keys(r);let s=t.getUniformIndices(n,a);if(null===s)return console.error("No uniform indices found."),null;const i=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),o=Array.from(s).filter(((t,e)=>{const r=t>=0&&t<i;return r||console.warn(`Uniform ${a[e]} could not be located.`),r})),c={};return o.map((e=>t.getActiveUniform(n,e))).forEach((({name:e,type:a})=>{const s=r[e],i=t.getUniformLocation(n,e);if(null===i)return console.warn(`Uniform ${e} could not be located.`),null;const o=this.getUniformSetter(t,s,i,a);o&&(c[e]=o)})),{setters:c,program:e}}static setUniformsListValues(t,e,r){const{program:n,setters:a}=e;xt.useProgram(t,n),Object.entries(r).forEach((([t,e])=>{if(t in a){const r=a[t],{value:n}=e;r.set(n)}else console.error(`Uniform ${t} does not match any of the given setters.`)}))}}var Ct,Pt;class Ot{static getBindingPointsEntries(){return function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,Ct,"f",Pt).entries()}static createUniformBlock(t,e,r){const{internalProgram:n}=e,a=t.getUniformBlockIndex(n,r);if(a===t.INVALID_INDEX)return console.error(`Block '${r}' does not identify a valid uniform block.`),null;const s=t.getActiveUniformBlockParameter(n,a,t.UNIFORM_BLOCK_DATA_SIZE),i={},o=t.getActiveUniformBlockParameter(n,a,t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES);return t.getActiveUniforms(n,o,t.UNIFORM_OFFSET).forEach(((e,r)=>{const a=o[r],s=t.getActiveUniform(n,a);if(null!==s){const{name:t}=s;i[t]={byteOffset:e}}})),{name:r,blockIndex:a,blockSize:s,layout:i,program:e}}static createUniformBuffer(t,e,r,n){const a=t.createBuffer();if(null===a)return null;const s=t.UNIFORM_BUFFER;t.bindBuffer(s,a),n=n??G.STATIC_READ;const i=(r=r??!1)?this.lastBindingPoint++:void 0;return t.bufferData(s,e,n),{internalBuffer:a,byteLength:e,bindingPoint:i,target:s,usage:n}}static createRangedUniformBuffers(t,e,r,n){const a=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT),s=e.reduce(((t,e)=>t+Math.max(Math.ceil(e.blockSize/a),1)*a),0),i=this.createUniformBuffer(t,s,!1,n);if(null===i)return null;r=r??!1;let o=0;return e.map((t=>{const{blockSize:e}=t,n=r?this.lastBindingPoint++:void 0,s={...i,bindingPoint:n,rangeOffset:o,rangeSize:e};return o+=Math.max(Math.ceil(e/a),1)*a,s}))}static setUniformBufferValues(t,e,r,n){const{internalBuffer:a,target:s}=r;t.getParameter(t.UNIFORM_BUFFER_BINDING)!==a&&t.bindBuffer(s,a);const{layout:i,name:o}=e,{rangeOffset:c}=r;Object.entries(n).forEach((([e,r])=>{const{value:n}=r;e in i||console.warn(`${e} does not exist in block ${o}.`);const{byteOffset:a}=i[e];t.bufferSubData(s,a+(c??0),Mt.asArrayBufferView(n))}))}static setUniformBufferData(t,e,r,n,a,s){const{internalBuffer:i,target:o}=e;let{rangeOffset:c}=e;t.bindBuffer(o,i);const l=(c??0)+(n??0);r instanceof ArrayBuffer?t.bufferSubData(o,l,r):(a=a??0,t.bufferSubData(o,l,r,a,s))}static bindUniformBuffer(t,e,r){const{internalBuffer:n,target:a}=r;let{rangeOffset:s,rangeSize:i}=r;const{bindingPoint:o}=r,{program:c,blockIndex:l}=e,{internalProgram:h}=c;void 0!==o&&(e.buffer=r,t.uniformBlockBinding(h,l,o),void 0!==o&&(void 0!==s&&void 0!==i?t.bindBufferRange(a,o,n,s,i):t.bindBufferBase(a,o,n)))}}Ct=Ot,Pt={value:new Map},Ot.lastBindingPoint=0;var Lt,Bt,Ft,Ut,Dt,kt,Gt,Vt,Ht,Xt,jt,Wt,zt,Yt=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class qt{static createTextures(t,e){const r={};return Object.entries(e).forEach((([e,n])=>{const a=St.createTexture(t,e,n);null!==a&&(r[e]=a)})),r}static createPacket(t,e){const{program:r,vertexArray:n,uniforms:a,uniformBlocks:s,uniformBuffers:i}=e,{drawCommand:o}=e;let c=null;if(c="internalProgram"in r?r:xt.createProgram(t,r),null===c)return null;let l,h=null;if(h=Y.createVertexArray(t,c,n),null===h)return null;if(void 0!==a){if(l=Mt.getUniformsListSetter(t,c,a),null===l)return null;Mt.setUniformsListValues(t,l,a)}let u={};const d=s?Object.entries(s):[],f=(i?.length??0)-1;return d.forEach((([t,e])=>{const{buffer:r}=e;void 0!==r&&r>f&&console.error(`Uniform buffer with index ${r} does not exist.`)})),i&&i.forEach(((e,r)=>{const n=d.filter((([t,e])=>e.buffer===r)),a=n.map((([e,r])=>Ot.createUniformBlock(t,c,e))),{length:s}=a;if("internalBuffer"in e)a.forEach((r=>{const{name:n}=r;Ot.bindUniformBuffer(t,r,e),u[n]=r}));else if(s>0){const{usage:r,data:i}=e;if(s>1){const e=Ot.createRangedUniformBuffers(t,a,!0,r);i&&Ot.setUniformBufferData(t,e[0],i),a.forEach(((r,a)=>{const{name:s}=r,i=e[a];Ot.bindUniformBuffer(t,r,i);const{uniforms:o}=n[a][1];o&&Ot.setUniformBufferValues(t,r,i,o),u[s]=r}))}else{const e=a[0],{blockSize:s,name:o}=e,c=Ot.createUniformBuffer(t,s,!0,r);if(null===c)return null;i&&Ot.setUniformBufferData(t,c,i),Ot.bindUniformBuffer(t,e,c);const{uniforms:l}=n[0][1];l&&Ot.setUniformBufferValues(t,e,c,l),u[o]=e}}})),d.filter((([t,e])=>void 0===e.buffer)).forEach((([e,r])=>{const{uniforms:n}=r,a=Ot.createUniformBlock(t,c,e);if(null===a)return null;const{blockSize:s}=a,i=Ot.createUniformBuffer(t,s,!0);if(null===i)return null;Ot.bindUniformBuffer(t,a,i),void 0!==n&&Ot.setUniformBufferValues(t,a,i,n),u[e]=a})),{program:c,vertexArray:h,uniforms:l,uniformBlocks:u,drawCommand:o}}static setPacketValues(t,e,r){const{vertexArray:n,uniforms:a,uniformBlocks:s}=r,{vertexArray:i,uniforms:o,uniformBlocks:c}=e;void 0!==n&&Y.setVertexArrayValues(t,i,n),void 0!==o&&void 0!==a&&Mt.setUniformsListValues(t,o,a),void 0!==c&&void 0!==s&&(s?Object.entries(s):[]).forEach((([e,r])=>{const{uniforms:n}=r,a=c[e],{buffer:s}=a;s&&Ot.setUniformBufferValues(t,a,s,n)}))}static enableMultidrawExtension(t){!function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?a.call(t,r):a?a.value=r:e.set(t,r)}(this,Lt,t.getExtension("WEBGL_multi_draw"),"f",Bt)}static drawPacket(t,e,r=e.drawCommand){const{vertexArray:n}=e,{program:a,internalVertexArray:s,elementBuffer:i}=n,{mode:o,elementsCount:c,instanceCount:l,multiDraw:h}=r;if(xt.useProgram(t,a),t.getParameter(t.VERTEX_ARRAY_BINDING)!==s&&t.bindVertexArray(s),i){const{indexType:e}=i;if(void 0!==l&&void 0!==c)t.drawElementsInstanced(o,c,e,0,l);else if(h){const t=Yt(this,Lt,"f",Bt),{countsList:r,countsOffset:n,offsetsList:a,offsetsOffset:s,drawCount:i,instanceCountsList:c,instanceCountsOffset:l}=h;void 0!==c&&void 0!==l?t.multiDrawElementsInstancedWEBGL(o,r,n,e,a,s,c,l,i):t.multiDrawElementsWEBGL(o,r,n,e,a,s,i)}else void 0!==c&&t.drawElements(o,c,e,0)}else if(void 0!==l&&void 0!==c)t.drawArraysInstanced(o,0,c,l);else if(h){const t=Yt(this,Lt,"f",Bt),{countsList:e,countsOffset:r,firstsList:n,firstsOffset:a,drawCount:s,instanceCountsList:i,instanceCountsOffset:c}=h;void 0!==i&&void 0!==c?t.multiDrawArraysInstancedWEBGL(o,n,a,e,r,i,c,s):t.multiDrawArraysWEBGL(o,n,a,e,r,s)}else void 0!==c&&t.drawArrays(o,0,c)}}Lt=qt,Bt={value:null},function(t){t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(Ft||(Ft={})),function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT"}(Ut||(Ut={})),function(t){t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Dt||(Dt={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(kt||(kt={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(Gt||(Gt={})),function(t){t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX"}(Vt||(Vt={})),function(t){t[t.BLEND=3042]="BLEND",t[t.CULL_FACE=2884]="CULL_FACE",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD"}(Ht||(Ht={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(Xt||(Xt={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(jt||(jt={})),function(t){t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT"}(Wt||(Wt={})),function(t){t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST"}(zt||(zt={}));class $t{static hint(t,e,r){t.hint(e,r)}static frontFace(t,e){t.frontFace(e)}static scissor(t,e,r,n,a){t.scissor(e,r,n,a)}static viewport(t,e,r,n,a){t.viewport(e,r,n,a)}static clearColor(t,e){t.clearColor(e[0],e[1],e[2],e[3])}static depthFunction(t,e){t.depthFunc(e)}static blendEquation(t,e){t.blendEquation(e)}static blendFunction(t,e,r){t.blendFunc(e,r)}static blendFunctionSeparate(t,e,r,n,a){t.blendFuncSeparate(e,r,n,a)}static stencilFunction(t,e,r,n,a){t.stencilFuncSeparate(a,e,r,n)}static stencilOperations(t,e,r,n,a){t.stencilOpSeparate(a,e,r,n)}static stencilMask(t,e,r){t.stencilMaskSeparate(r,e)}static colorMask(t,e,r,n,a){t.colorMask(e,r,n,a)}static depthMask(t,e){t.depthMask(e)}static enable(t,e){t.enable(e)}static disable(t,e){t.disable(e)}static clear(t,e){t.clear(e)}static getViewport(t){return t.getParameter(t.VIEWPORT)}static getMaxSamples(t){return t.getParameter(t.MAX_SAMPLES)}static drawBuffers(t,e){t.drawBuffers(e)}static clearBuffers(t,e,r,n,a){n instanceof Float32Array?t.clearBufferfv(e,r,n,a):n instanceof Int32Array?t.clearBufferiv(e,r,n,a):n instanceof Uint32Array&&t.clearBufferuiv(e,r,n,a)}}class Kt{constructor(t,e,r,n){this.array=void 0!==n?new Float32Array([t??0,e??0,r??0,n]):new Float32Array([t??0,e??0,r??0])}static rgb(t,e,r){return new Zt(t,e,r)}static rgba(t,e,r,n){if(t instanceof Zt){const{r,g:n,b:a}=t;return new Zt(r,n,a,void 0!==e?e:1)}return new Zt(t,e,r,n)}static array(...t){const e=new Array(4*t.length);let r,n=0;for(const a of t)r=a.array,e[n+0]=r[0],e[n+1]=r[1],e[n+2]=r[2],n+=3;return e}get length(){return 3}get r(){return this.array[0]}set r(t){this.array[0]=t}get g(){return this.array[1]}set g(t){this.array[1]=t}get b(){return this.array[2]}set b(t){this.array[2]=t}get a(){return this.array[3]}set a(t){this.array[3]=t}get 0(){return this.array[0]}set 0(t){this.array[0]=t}get 1(){return this.array[1]}set 1(t){this.array[1]=t}get 2(){return this.array[2]}set 2(t){this.array[2]=t}get 3(){return this.array[3]}set 3(t){this.array[3]=t}setValues(t,e,r){const{array:n}=this;return n[0]=t,n[1]=e,n[2]=r,this}getValues(){const{array:t}=this;return[t[0],t[1],t[2]]}copy(t){const{array:e}=this,{r,g:n,b:a}=t;return e[0]=r,e[1]=n,e[2]=a,this}clone(){return(new Kt).copy(this)}static lerp(t,e,r){return t.lerp(e,r)}lerp(t,e){const{array:r}=this,{r:n,g:a,b:s}=t;return r[0]=e*(n-r[0]),r[1]=e*(a-r[1]),r[2]=e*(s-r[2]),this}normalize(){const{array:t}=this;return t[0]/=255,t[1]/=255,t[2]/=255,this}[Symbol.iterator](){const{array:t}=this,{length:e}=t;let r=0;return{next:()=>r<e?{value:t[r++],done:!1}:{value:void 0,done:!0}}}}Kt.BLACK=new Kt(0,0,0),Kt.RED=new Kt(1,0,0),Kt.YELLOW=new Kt(1,1,0),Kt.GREEN=new Kt(0,1,0),Kt.BLUE=new Kt(0,0,1),Kt.WHITE=new Kt(1,1,1);const Zt=Kt;async function Qt(){const t=document.createElement("template");t.innerHTML='\n\x3c!--<link rel="stylesheet" href="./css/main.css"/>--\x3e\n  <div class="flex-auto flex-cols">\n    <main class="flex-rows flex-auto">\n        <section class="centered padded">\n          <div id="canvas-container" style="position: relative;">\n            <canvas id="canvas" tabindex="0" oncontextmenu="return false;"></canvas>\n            <canvas id="canvas-2d" tabindex="0" style="display: block; position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;"></canvas>\n          </div>\n          \x3c!--\n          <style>\n            circle:hover {\n              fill: rgb(255, 0, 0);\n            }\n          </style>\n          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100">\n            <circle cx="10" cy="10" r="4"/>\n          </svg>\n          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200" id="save" fill="none">\n            <g>\n              <rect x="0" y="0" width="100" height="100" fill="red"></rect>\n              <text text-anchor="middle" alignment-baseline="middle" x="50" y="50" font-family="Verdana" fill="blue">Hello,World!</text>\n            </g>\n          </svg>\n          --\x3e\n        </section>\n    </main>\n  </div>',document.body.insertBefore(t.content,document.body.firstChild);try{!async function(){let t,e=0,r=!1;const n=document.querySelector("e-toolbar");null!==n&&(n.onclick=e=>{const n=e.target.closest("e-toolbaritem");n&&"play-pause"===n.name&&(r=n.pressed,r&&requestAnimationFrame(t))}),setTimeout((()=>{n?.querySelector("e-toolbaritem[name='play-pause']").click()}),500);const a=document.getElementById("canvas");if(!a)return;const i=document.getElementById("canvas-2d");if(!i)return;const h=i.getContext("2d");if(!h)return;h.scale(window.devicePixelRatio,window.devicePixelRatio);const u=900,f=600;a.width=900,a.height=600,a.style.width="900px",a.style.height="600px",i.width=u,i.height=f,i.style.width="900px",i.style.height="600px";const p=a.getContext("webgl2");if(!p)return;St.setUnpackAlignment(p,1);const y=await fetch("assets/engine/shaders/common/phong.vert.glsl").then((t=>t.text())),_=await fetch("assets/engine/shaders/common/phong.frag.glsl").then((t=>t.text())),R=xt.createProgram(p,{vertexSource:y,fragmentSource:_});if(null===R)return;const w=await fetch("assets/engine/shaders/common/skybox.vert").then((t=>t.text())),b=await fetch("assets/engine/shaders/common/skybox.frag").then((t=>t.text())),v=xt.createProgram(p,{vertexSource:w,fragmentSource:b});if(null===v)return;const I=await fetch("assets/engine/shaders/common/texture.vert").then((t=>t.text())),N=await fetch("assets/engine/shaders/common/texture.frag").then((t=>t.text())),S=xt.createProgram(p,{vertexSource:I,fragmentSource:N});if(null===S)return;const M=await fetch("assets/engine/shaders/common/basic.vert.glsl").then((t=>t.text())),P=await fetch("assets/engine/shaders/common/basic.frag.glsl").then((t=>t.text())),L=xt.createProgram(p,{vertexSource:M,fragmentSource:P});if(null===L)return;const F=await fetch("assets/engine/shaders/common/depth.vert.glsl").then((t=>t.text())),U=await fetch("assets/engine/shaders/common/depth.frag.glsl").then((t=>t.text())),D=xt.createProgram(p,{vertexSource:F,fragmentSource:U});if(null===D)return;const k=await fetch("assets/engine/shaders/common/lines.vert.glsl").then((t=>t.text())),V=await fetch("assets/engine/shaders/common/lines.frag.glsl").then((t=>t.text())),W=xt.createProgram(p,{vertexSource:k,fragmentSource:V});if(null===W)return;async function q(t){return fetch(t).then((e=>{if(e.ok)return new Promise((e=>{const r=new Image;r.onload=()=>{e(r)},r.src=t}));throw new Error(`Image '${t}' not found.`)}))}const K=await q("assets/engine/img/NormalMap.png"),Z=await q("assets/engine/img/brickwall.jpg"),Q=await q("assets/engine/img/NormalMap_0.png"),J=await q("assets/engine/img/Normal_Map_1024.png"),nt=await q("assets/engine/img/DisplacementMap.png"),at=await q("assets/engine/img/skybox_x_pos.png"),st=await q("assets/engine/img/skybox_x_neg.png"),it=await q("assets/engine/img/skybox_y_pos.png"),ot=await q("assets/engine/img/skybox_y_neg.png"),ct=await q("assets/engine/img/skybox_z_pos.png"),dt=await q("assets/engine/img/skybox_z_neg.png"),ft=await q("assets/engine/img/colors.png"),Et=function(t){const e=document.createElement("canvas"),{width:r,height:n}=t,a=r+2,s=n+2;e.width=a,e.height=s;const i=e.getContext("2d");return i.drawImage(t,0,0,a,s),i.drawImage(t,1,1,r,n),{width:r,height:n,paddedWidth:a,paddedHeight:s,data:i.getImageData(0,0,a,s)}},_t=Et(Z),wt=Et(K),bt=Et(J),vt=Et(ft),It=qt.createTextures(p,{albedoMap:{pixels:null,width:8,height:8,depth:2,target:gt.TEXTURE_2D_ARRAY,type:mt.UNSIGNED_BYTE,format:pt.LUMINANCE,internalFormat:yt.LUMINANCE,min:At.NEAREST,mag:Tt.NEAREST,subimages:[{pixels:new Uint8Array([255,204,255,204,255,204,255,204,204,255,204,255,204,255,204,255,255,204,255,204,255,204,255,204,204,255,204,255,204,255,204,255,255,204,255,204,255,204,255,204,204,255,204,255,204,255,204,255,255,204,255,204,255,204,255,204,204,255,204,255,204,255,204,255]),xoffset:0,yoffset:0,zoffset:0,width:8,height:8,depth:1},{pixels:new Uint8Array([204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204]),xoffset:0,yoffset:0,zoffset:1,width:8,height:8,depth:1}]},albedoMaps:{pixels:null,width:_t.paddedWidth,height:_t.paddedHeight,depth:4,target:gt.TEXTURE_2D_ARRAY,type:mt.UNSIGNED_BYTE,format:pt.RGB,internalFormat:yt.RGB,subimages:[{pixels:_t.data,xoffset:0,yoffset:0,zoffset:0,width:_t.paddedWidth,height:_t.paddedHeight,depth:1},{pixels:wt.data,xoffset:0,yoffset:0,zoffset:1,width:wt.paddedWidth,height:wt.paddedHeight,depth:1},{pixels:bt.data,xoffset:0,yoffset:0,zoffset:2,width:bt.paddedWidth,height:bt.paddedHeight,depth:1},{pixels:vt.data,xoffset:0,yoffset:0,zoffset:3,width:vt.paddedWidth,height:vt.paddedHeight,depth:1}],min:At.LINEAR,mag:Tt.LINEAR},normalMap:{pixels:Q,width:Q.width,height:Q.height,target:gt.TEXTURE_2D,type:mt.UNSIGNED_BYTE,format:pt.RGB,internalFormat:yt.RGB,min:At.LINEAR_MIPMAP_LINEAR,mag:Tt.LINEAR},displacementMap:{pixels:nt,width:nt.width,height:nt.height,target:gt.TEXTURE_2D,type:mt.UNSIGNED_BYTE,format:pt.RGBA,internalFormat:yt.RGBA},skybox:{pixels:{xPos:at,xNeg:st,yPos:it,yNeg:ot,zPos:ct,zNeg:dt},width:at.width,height:at.height,target:gt.TEXTURE_CUBE_MAP,type:mt.UNSIGNED_BYTE,format:pt.RGBA,internalFormat:yt.RGBA},fbColorTex:{width:a.width,height:a.height,pixels:null,target:gt.TEXTURE_2D,type:mt.UNSIGNED_BYTE,format:pt.RGBA,internalFormat:yt.RGBA,mag:Tt.LINEAR,min:At.LINEAR,wrapS:Rt.CLAMP_TO_EDGE,wrapT:Rt.CLAMP_TO_EDGE,wrapR:Rt.CLAMP_TO_EDGE},depthTex:{width:a.width,height:a.height,pixels:null,target:gt.TEXTURE_2D,type:mt.UNSIGNED_INT,format:pt.DEPTH_COMPONENT,internalFormat:yt.DEPTH_COMPONENT24,wrapS:Rt.CLAMP_TO_EDGE,wrapT:Rt.CLAMP_TO_EDGE,wrapR:Rt.CLAMP_TO_EDGE,mag:Tt.NEAREST,min:At.NEAREST}}),{albedoMap:Nt,albedoMaps:Mt,normalMap:Ct,displacementMap:Pt,skybox:Lt,fbColorTex:Bt,depthTex:Ft}=It,Dt=[Mt],Vt=p.getExtension("EXT_texture_filter_anisotropic");if(Vt){console.log("Extension EXT_texture_filter_anisotropic activated.");const t=p.getParameter(Vt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);Dt.forEach((e=>{const{properties:r,internalTexture:n}=e,{target:a}=r;p.bindTexture(a,n),p.texParameterf(a,Vt.TEXTURE_MAX_ANISOTROPY_EXT,t)}))}const Xt=new lt({height:4,width:4,depth:4,heightSegments:32,widthSegments:32,depthSegments:32}),jt=new ht({height:2,width:2}).toBuilder(),Wt=new B;Wt.setScaling(new c([1,1,1]));const zt=1/3*Math.PI,Yt=p.canvas.width/p.canvas.height,Kt=new class extends class extends class{constructor(){this.transform=new B(this)}}{constructor(t){super(),this.uuid=O.newUUID(),this.projection=t||new C,this.frustum=(new z).setFromMatrix(this.viewProjection)}getFront(t){return this.transform.getBackward(t)}get view(){return this.transform.matrix.clone().invert()}get viewProjection(){return this.projection.clone().mult(this.view)}isViewing(t){return!0}updateFrustum(){this.frustum.setFromMatrix(this.viewProjection)}}{constructor(t,e,r,n){super(C.perspective(t,e,r,n))}setValues(t,e,r,n){return this.projection.setPerspective(t,e,r,n),this.updateFrustum(),this}}(zt,Yt,.1,100);Kt.transform.setTranslation(new c([0,8,8])),Kt.transform.lookAt(new c([0,0,0]),l.up);const Qt=new B;Qt.setTranslation(new c([0,2,2])),Qt.setScaling(new c([.2,.2,.2])),Kt.transform.setTranslation(Qt.getTranslation(new c).scale(2)),Kt.transform.lookAt(new c([0,0,0]),l.up);const Jt=Kt.projection.clone().mult(C.identity().setRotation(Kt.view.getRotation())).invert(),te=Xt.toBuilder(),ee=te.verticesArray(),re=te.trianglesIndicesArray(),ne=te.normalsArray(),ae=te.uvsArray(),se=te.tangentsArray(),ie=te.verticesArray(),oe=new $({a_position:{array:ee,type:j.VEC3},a_tangent:{array:se,type:j.VEC3},a_normal:{array:ne,type:j.VEC3},a_uv:{array:ae,type:j.VEC2}},re,!1),ce=oe.getAttribute("a_position"),le=(oe.indices,oe.getAttribute("a_normal")),he=oe.getAttribute("a_uv"),ue=oe.getAttribute("a_tangent"),de=oe.getAttribute("a_normal"),fe={program:R,vertexArray:{vertexBuffers:[{interleaved:!1},{usage:G.DYNAMIC_READ}],vertexAttributes:{a_position:{buffer:0,type:j.VEC3,componentType:X.FLOAT,byteLength:le.array.byteLength},a_tangent:{buffer:0,type:j.VEC3,componentType:X.FLOAT,byteLength:ue.array.byteLength},a_normal:{...le,buffer:0},a_uv:{...he,buffer:0},a_color:{buffer:1,type:j.VEC3,componentType:X.FLOAT,byteLength:de.array.byteLength}},elementIndices:oe.indices},uniformBuffers:[{usage:G.DYNAMIC_READ},{usage:G.DYNAMIC_READ}],uniformBlocks:{subTexture:{uniforms:{u_xOffset:{value:1/_t.paddedWidth},u_yOffset:{value:1/_t.paddedHeight},u_zOffset:{value:1},u_xScaling:{value:wt.width/_t.paddedWidth},u_yScaling:{value:wt.height/_t.paddedHeight}}},viewBlock:{buffer:0},modelBlock:{buffer:0},lightsBlock:{buffer:0},phongBlock:{buffer:1}},uniforms:{u_albedoMap:{value:Nt},u_normalMap:{value:Ct},u_displacementMap:{value:Pt},u_albedoMaps:{value:Mt}},drawCommand:{mode:H.TRIANGLES,elementsCount:oe.indices.length}},pe={program:R,uniformBlocks:{viewBlock:{uniforms:{u_view:{value:Kt.view.array},u_projection:{value:Kt.projection.array}}},modelBlock:{uniforms:{"models[0].u_model":{value:Wt.matrix.array},"models[0].u_modelView":{value:Kt.view.mult(Wt.matrix).array},"models[0].u_normal":{value:Kt.view.mult(Wt.matrix).invert().transpose().array}}},lightsBlock:{uniforms:{"lights[0].u_lightWorldPos":{value:Array.from(Qt.getTranslation(new c))},"lights[0].u_lightDirection":{value:Array.from(Qt.getBackward(new c))},"lights[0].u_cutOff":{value:2/360*Math.PI},"lights[0].u_lightColor":{value:Array.from(Zt.RED)}}},phongBlock:{uniforms:{"phong.u_ambientColor":{value:[.1,.1,.1]},"phong.u_diffuseColor":{value:[.8,0,0]},"phong.u_specularColor":{value:[1,1,1]},"phong.u_ambientFactor":{value:8e-4},"phong.u_diffuseFactor":{value:1},"phong.u_specularFactor":{value:1},"phong.u_shininess":{value:36},"phong.u_constant":{value:1},"phong.u_linear":{value:.09},"phong.u_quadratic":{value:.032}}}}};let ye=qt.createPacket(p,fe);Y.setVertexArrayBufferData(p,ye.vertexArray.verticesBuffers[1],de.array),Y.setVertexArrayBufferData(p,ye.vertexArray.verticesBuffers[0],new Uint8Array(oe.buffer)),Y.setVertexArrayValues(p,ye.vertexArray,{attributes:{a_position:{array:ce.array}}}),Ot.setUniformBufferData(p,ye.uniformBlocks.phongBlock.buffer,Zt.lerp(Zt.WHITE,Zt.GREEN,.5).array,ye.uniformBlocks.phongBlock.layout["phong.u_ambientColor"].byteOffset);const me={program:W,vertexArray:{vertexAttributes:{a_position:{array:ie,type:j.VEC3}}},uniformBuffers:[ye.uniformBlocks.modelBlock.buffer,ye.uniformBlocks.viewBlock.buffer],uniformBlocks:{modelBlock:{buffer:0},viewBlock:{buffer:1}},uniforms:{u_color:{value:new Float32Array([1,0,0])}},drawCommand:{mode:H.LINES,elementsCount:ie.length/2}},Ee={program:L,vertexArray:{vertexBuffers:[ye.vertexArray.verticesBuffers[0]],elementBuffer:ye.vertexArray.elementBuffer},uniformBuffers:[ye.uniformBlocks.viewBlock.buffer],uniformBlocks:{basicModelBlock:{uniforms:{u_model:{value:Qt.matrix.array},u_color:{value:[1,1,0]}}},viewBlock:{buffer:0}},drawCommand:{mode:H.TRIANGLES,elementsCount:ye.drawCommand.elementsCount}},ge=jt.trianglesIndicesArray(),Te=jt.verticesArray(),Ae=jt.uvsArray(),_e=(new C).setIdentity(),Re={program:v,vertexArray:{vertexAttributes:{a_position:{array:Te,type:j.VEC3}},elementIndices:ge},uniforms:{u_world:{value:_e.array},u_viewDirectionProjectionInverse:{value:Jt.array},u_skybox:{value:Lt}},drawCommand:{mode:H.TRIANGLES,elementsCount:ge.length}},we={program:D,vertexArray:{vertexAttributes:{a_position:{array:Te,type:j.VEC3},a_uv:{array:Ae,type:j.VEC2}},elementIndices:ge},uniforms:{u_depthWorld:{value:_e.array},u_depthTex:{value:Ft}},drawCommand:{mode:H.TRIANGLES,elementsCount:ge.length}},be={program:S,vertexArray:{vertexAttributes:{a_position:{array:Te,type:j.VEC3},a_uv:{array:Ae,type:j.VEC2}},elementIndices:ge},uniforms:{u_world:{value:_e.array},u_tex:{value:Bt}},drawCommand:{mode:H.TRIANGLES,elementsCount:ge.length}},ve=(qt.createPacket(p,me),qt.createPacket(p,Ee),qt.createPacket(p,Re)),Ie=qt.createPacket(p,we),Ne=qt.createPacket(p,be),Se=ut.createFramebuffer(p),xe=$t.getMaxSamples(p);ut.attachRenderbuffer(p,Se,{renderbuffer:ut.createRenderbuffer(p,{internalFormat:rt.DEPTH_COMPONENT24,width:a.width,height:a.height,samples:xe}),attachment:et.DEPTH_ATTACHMENT},{renderbuffer:ut.createRenderbuffer(p,{internalFormat:rt.RGBA8,width:a.width,height:a.height,samples:xe}),attachment:et.COLOR_ATTACHMENT0});const Me=ut.createFramebuffer(p);ut.attachTexture(p,Me,{textureTarget:tt.TEXTURE_2D,texture:Bt,attachment:et.COLOR_ATTACHMENT0},{textureTarget:tt.TEXTURE_2D,texture:Ft,attachment:et.DEPTH_ATTACHMENT}),$t.viewport(p,0,0,p.canvas.width,p.canvas.height),$t.enable(p,Ht.DEPTH_TEST),$t.enable(p,Ht.CULL_FACE),$t.enable(p,Ht.BLEND),$t.blendFunction(p,Gt.SRC_ALPHA,Gt.ONE_MINUS_SRC_ALPHA);let Ce=0,Pe=0,Oe=0,Le=1;Wt.getRotation(new x),Wt.getTranslation(new c),new c([2,-2,-2]),x.fromAxisAngle(l.down,Math.PI/3),E.initialize(a),ut.unbindFramebuffer(p);const Be=new class{constructor(t,e){m.set(this,void 0),this.camera=t,this.rotationSpeed=e?.rotationSpeed??50,this.translationSpeed=e?.translationSpeed??8,function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?a.call(t,r):a?a.value=r:e.set(t,r)}(this,m,new s,"f")}update(t){const{camera:e,rotationSpeed:r,translationSpeed:n}=this,a=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,m,"f"),{transform:s}=e,i=s.getTranslation(g),c=s.getBackward(T),{array:h}=c,{origin:u,up:f,down:p}=l;let y=s.getUp(A).dot(f);if(E.getKey(o.Z)||E.getKey(o.ARROW_UP)){const e=s.getBackward(A).scale(n*t);s.translate(e)}if(E.getKey(o.Q)||E.getKey(o.ARROW_LEFT)){const e=s.getLeft(A).scale(n*t);s.translate(e)}if(E.getKey(o.S)||E.getKey(o.ARROW_DOWN)){const e=s.getForward(A).scale(n*t);s.translate(e)}if(E.getKey(o.D)||E.getKey(o.ARROW_RIGHT)){const e=s.getRight(A).scale(n*t);s.translate(e)}if(E.getMouseButtonDown(d.RIGHT)&&a.copy(E.getPointerScreenPosition()),E.getMouseButton(d.RIGHT)){const e=E.getPointerScreenPosition();if(!e.equals(a)){const n=(a.x-e.x)*r*t,o=(a.y-e.y)*r*t;if(i.copy(s.getTranslation(A)),0!==n||0!==o){y=Math.sign(s.getUp(A).dot(f)),c.toSpherical(u);const t=h[1],e=h[2],r=t+y*-o;r<=0||r>=Math.PI?(h[2]=(e-n+Math.PI)%(2*Math.PI),h[1]=r<0?-r:Math.PI-(r-Math.PI),y*=-1):(h[2]=(e-n)%(2*Math.PI),h[1]=t+y*-o),c.toCartesian(u),s.lookAt(i.add(c),y>0?f:p)}a.copy(e)}}}}(Kt);qt.setPacketValues(p,ye,pe),$t.clearColor(p,Zt.BLACK.normalize()),h.font="18px 'Open Sans'",h.strokeStyle="black",h.fillStyle="white";t=function(n){if(function(t){Pe=(t*=.001)-Ce,e=1/Pe,h.clearRect(0,0,i.width,i.height),h.shadowBlur=2,h.strokeText(`${e.toFixed(1)} FPS`,20,20),h.shadowBlur=0,h.fillText(`${e.toFixed(1)} FPS`,20,20)}(n),Pe=(n*=.001)-Ce,Ce=n,!r)return;Be.update(Pe),Qt.setMatrix(Kt.transform.matrix),Wt.rotate(x.fromAxisAngle(l.down,Math.PI/128)),Oe+=Pe*Le*.5,(Oe>1||Oe<0)&&(Le*=-1),$t.clear(p,Ut.COLOR_BUFFER_BIT|Ut.DEPTH_BUFFER_BIT),Jt.copy(Kt.projection).mult((new C).setIdentity().setRotation(Kt.view.getRotation())).invert(),$t.viewport(p,0,0,a.width,a.height),ut.bindFramebuffer(p,Se),$t.clear(p,Ut.COLOR_BUFFER_BIT|Ut.DEPTH_BUFFER_BIT),$t.depthFunction(p,kt.LEQUAL),qt.drawPacket(p,ve),$t.depthFunction(p,kt.LESS),qt.setPacketValues(p,ye,{uniformBlocks:{modelBlock:{uniforms:{"models[0].u_model":{value:Wt.matrix.array},"models[0].u_modelView":{value:Kt.view.mult(Wt.matrix).array},"models[0].u_normal":{value:Kt.view.mult(Wt.matrix).invert().transpose().array}}},viewBlock:{uniforms:{u_view:{value:Kt.view.array},u_projection:{value:Kt.projection.array}}},lightsBlock:{uniforms:{"lights[0].u_lightWorldPos":{value:Array.from(Qt.getTranslation(new c))},"lights[0].u_lightDirection":{value:Array.from(Qt.getBackward(new c))}}}}}),qt.drawPacket(p,ye),qt.setPacketValues(p,ve,{uniforms:{u_viewDirectionProjectionInverse:{value:Jt.array}}}),ut.blit(p,Se,Me,[0,0,a.width,a.height],[0,0,a.width,a.height],Ut.COLOR_BUFFER_BIT,Tt.LINEAR),ut.blit(p,Se,Me,[0,0,a.width,a.height],[0,0,a.width,a.height],Ut.DEPTH_BUFFER_BIT,Tt.NEAREST),ut.unbindFramebuffer(p),qt.drawPacket(p,Ne);const s=a.width/4,o=a.height/4;$t.viewport(p,0,a.height-o,s,o),$t.depthFunction(p,kt.ALWAYS),qt.drawPacket(p,Ie),E.clear(),requestAnimationFrame(t)}}()}catch(t){console.trace(t)}}var Jt,te,ee,re,ne,ae,se,ie,oe,ce,le,he,ue,de,fe,pe,ye,me,Ee,ge=function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(t,r):a?a.value=r:e.set(t,r),r},Te=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Ae{constructor(t){this.target=t.target,this.changeType=t.changeType,this.propertyName=t.propertyName??null,this.oldValue=t.oldValue??void 0,this.newValue=t.newValue??void 0,this.removedIndex=t.removedIndex??0,this.removedItems=new Re(t.removedItems??[]),this.insertedIndex=t.insertedIndex??0,this.insertedItems=new Re(t.insertedItems??[]),this.sortedIndices=t.sortedIndices??[]}static get PROPERTY_CHANGE(){return 1}static get LIST_REMOVE(){return 2}static get LIST_INSERT(){return 3}static get LIST_SORT(){return 4}get PROPERTY_CHANGE(){return Ae.PROPERTY_CHANGE}get LIST_REMOVE(){return Ae.LIST_REMOVE}get LIST_INSERT(){return Ae.LIST_INSERT}get LIST_SORT(){return Ae.LIST_SORT}}var _e=Ae;Jt=new WeakMap;var Re=class{constructor(t){Jt.set(this,void 0),ge(this,Jt,t.slice(),"f")}get length(){return Te(this,Jt,"f").length}item(t){return Te(this,Jt,"f")[t]??null}values(){return Te(this,Jt,"f").values()}};class we{constructor(t){te.set(this,void 0),ee.set(this,void 0),this.type=t,ge(this,te,null,"f"),ge(this,ee,null,"f")}get currentTarget(){return Te(this,te,"f")}get target(){return Te(this,ee,"f")}}te=new WeakMap,ee=new WeakMap,we.ModelEventTargetAccessor=new class{setCurrentTarget(t,e){t instanceof we&&ge(t,te,e,"f")}setTarget(t,e){t instanceof we&&ge(t,ee,e,"f")}};var be=we.ModelEventTargetAccessor;delete we.ModelEventTargetAccessor;var ve=we;re=new WeakMap;class Ie extends class{constructor(){re.set(this,void 0),ge(this,re,new Map,"f")}receiveEvent(t){const{type:e}=t,r=Te(this,re,"f").get(e);be.setCurrentTarget(t,this),r&&r.forEach((e=>{e(t)}))}addEventListener(t,e){const r=Te(this,re,"f").get(t);r?r.push(e):Te(this,re,"f").set(t,[e])}removeEventListener(t,e){const r=Te(this,re,"f").get(t);if(r){const n=r.findIndex((t=>t==e));n>-1&&r.splice(n,1),0==r.length&&Te(this,re,"f").delete(t)}}dispatchEvent(t){be.setTarget(t,this),this.receiveEvent(t)}}{constructor(){super(),ne.add(this),ae.set(this,void 0),se.set(this,void 0),ie.set(this,void 0),ge(this,ae,null,"f"),ge(this,se,[],"f"),ge(this,ie,!1,"f")}get parentNode(){return Te(this,ae,"f")}setParent(t){if(null!==t){let e=t==this,{parentNode:r}=t;for(;!e&&null!==r;)({parentNode:r}=r),e=r==this;if(e)throw new TypeError("Failed to set parent on ModelNode: circular reference detected in the hierarchy.");ge(this,ae,t,"f")}else ge(this,ae,null,"f")}beginChanges(){ge(this,ie,!0,"f")}endChanges(){this.dispatchEvent(new ve("modelchange")),Te(this,se,"f").splice(0),ge(this,ie,!1,"f")}getRecords(){return Te(this,se,"f").slice()}receiveEvent(t){super.receiveEvent(t);const{parentNode:e}=this;e&&e.receiveEvent(t)}}ae=new WeakMap,se=new WeakMap,ie=new WeakMap,ne=new WeakSet,oe=function(t,e,r){const n=Te(this,se,"f"),a=new _e({target:this,changeType:_e.PROPERTY_CHANGE,propertyName:t,oldValue:e,newValue:r});n.push(a),Te(this,ie,"f")||(this.dispatchEvent(new ve("modelchange")),n.splice(0))},ce=function(t){Te(this,se,"f").push(t),Te(this,ie,"f")||(this.dispatchEvent(new ve("modelchange")),Te(this,se,"f").splice(0))},Ie.ModelNodeRecordsAccessor=new class{triggerChange(t,e,r,n){t instanceof Ie&&Te(t,ne,"m",oe).call(t,e,r,n)}handleRecord(t,e){t instanceof Ie&&Te(t,ne,"m",ce).call(t,e)}};var Ne=Ie.ModelNodeRecordsAccessor;delete Ie.ModelNodeRecordsAccessor;var Se=Ie;const xe=function(){return(t,e)=>{const{constructor:r}=t,{prototype:n}=r;Object.defineProperty(n,e,{set:function(t){const r=Ce.getProperty(this,e);return Ce.setProperty(this,e,t),t!==r&&Ne.triggerChange(this,e,r,t),!0},get:function(){return Ce.getProperty(this,e)},enumerable:!0})}};class Me extends Ie{constructor(){super(),le.set(this,void 0),ge(this,le,new Map,"f")}}le=new WeakMap,Me.ModelReactivePropertiesAccessor=new class{setProperty(t,e,r){t instanceof Me&&Te(t,le,"f").set(e,r)}getProperty(t,e){if(t instanceof Me)return Te(t,le,"f").get(e)}};var Ce=Me.ModelReactivePropertiesAccessor;delete Me.ModelReactivePropertiesAccessor;var Pe=Me;he=new WeakMap;var Oe=class extends Ie{constructor(t){super(),he.set(this,void 0),ge(this,he,t?.slice()??[],"f")}setParent(t){super.setParent(t),Te(this,he,"f").forEach((e=>{e.setParent(t)}))}get length(){return Te(this,he,"f").length}get(t){return Te(this,he,"f")[t]??null}index(t){return Te(this,he,"f").indexOf(t)}values(){return Te(this,he,"f").values()}sort(t){const e=Te(this,he,"f").map(((t,e)=>({item:t,index:e})));e.sort(((e,r)=>t(e.item,r.item))),ge(this,he,e.map((t=>t.item)),"f");const r=new _e({target:this,changeType:_e.LIST_SORT,sortedIndices:e.map((t=>t.index))});Ne.handleRecord(this,r)}prepend(...t){const e=Te(this,he,"f"),{parentNode:r}=this;r&&t.forEach((t=>{t.setParent(r)})),e.splice(0,0,...t);const n=new _e({target:this,changeType:_e.LIST_INSERT,insertedIndex:0,insertedItems:t});Ne.handleRecord(this,n)}append(...t){const e=Te(this,he,"f"),{length:r}=e,{parentNode:n}=this;n&&t.forEach((t=>{t.setParent(n)})),e.push(...t);const a=new _e({target:this,changeType:_e.LIST_INSERT,insertedIndex:r,insertedItems:t});Ne.handleRecord(this,a)}insert(t,...e){const r=Te(this,he,"f"),{length:n}=r;if(Math.abs(t)<=n){if(t>=0){const{parentNode:a}=this;e.forEach((t=>{t.setParent(a)})),t<n?r.splice(t,0,...e):r.push(...e)}else if(t<0){t=n-t;const{parentNode:a}=this;a&&e.forEach((t=>{t.setParent(a)})),r.splice(t,0,...e)}const a=new _e({target:this,changeType:_e.LIST_INSERT,insertedIndex:t,insertedItems:e.slice()});Ne.handleRecord(this,a)}}remove(t){const e=Te(this,he,"f"),r=e.indexOf(t);if(r>-1){const t=e.splice(r,1)[0],{parentNode:n}=this;n&&t.setParent(null);const a=new _e({target:this,changeType:_e.LIST_REMOVE,removedIndex:r,removedItems:[t]});Ne.handleRecord(this,a)}}clear(){const t=Te(this,he,"f"),{length:e}=t;if(e>0){const e=t.splice(0),{parentNode:r}=this;r&&e.forEach((t=>{t.setParent(null)}));const n=new _e({target:this,changeType:_e.LIST_REMOVE,removedIndex:0,removedItems:e});Ne.handleRecord(this,n)}}};de=new WeakMap,fe=new WeakMap,pe=new WeakMap,ye=new WeakMap,ue=new WeakSet,me=function(){const t=Te(this,fe,"f").splice(0);t.length>0&&Te(this,de,"f").call(this,t)},Ee=function(t){if(!Te(this,pe,"f")){const{target:e,currentTarget:r}=t,n=Te(this,ye,"f").get(r);if(n){const{options:t}=n,{properties:a,propertiesFilter:s,childList:i,subtree:o}=t;o?a&&e instanceof Se?(s?Te(this,fe,"f").push(...e.getRecords().filter((t=>{const{propertyName:e}=t;return s.includes(e)}))):Te(this,fe,"f").push(...e.getRecords()),Te(this,ue,"m",me).call(this)):i&&e instanceof Oe&&(Te(this,fe,"f").push(...e.getRecords()),Te(this,ue,"m",me).call(this)):e==r&&(a&&e instanceof Se?(s?Te(this,fe,"f").push(...e.getRecords().filter((t=>{const{propertyName:e}=t;return s.includes(e)}))):Te(this,fe,"f").push(...e.getRecords()),Te(this,ue,"m",me).call(this)):i&&e instanceof Oe&&(Te(this,fe,"f").push(...e.getRecords()),Te(this,ue,"m",me).call(this)))}}};var Le=class{constructor(t){ue.add(this),de.set(this,void 0),fe.set(this,void 0),pe.set(this,void 0),ye.set(this,void 0),ge(this,de,t,"f"),ge(this,fe,[],"f"),ge(this,pe,!1,"f"),ge(this,ye,new WeakMap,"f")}observe(t,e){ge(this,pe,!1,"f");const r=Te(this,ye,"f");let n=r.get(t);if(n)r.set(t,n);else{const a=Te(this,ue,"m",Ee).bind(this);t.addEventListener("modelchange",a),n={listener:a,options:e},r.set(t,n)}}unobserve(t){let e=Te(this,ye,"f").get(t);if(e){const{listener:r}=e;t.removeEventListener("modelchange",r)}}disconnect(){Te(this,fe,"f").splice(0),ge(this,pe,!0,"f")}};function Be(t){return t.replace(/(?<!^)(?=[A-Z])/g,"-").toLowerCase()}const Fe=function(t){return(e,r)=>{const{constructor:n}=e,{prototype:a}=n,s=String(r),{defaultValue:i=null,observed:o=!1,name:c=Be(s)}=t;if(o){const t=Reflect.get(n,"observedAttributes",n);Array.isArray(t)?t.push(c):Object.defineProperty(n,"observedAttributes",{value:[c],writable:!1})}const{type:l}=t;switch(l){case Boolean:Object.defineProperty(a,s,{get:function(){return this.hasAttribute(c)},set:function(t){t?this.setAttribute(c,""):this.removeAttribute(c)}});break;case Object:Object.defineProperty(a,s,{get:function(){const t=this.getAttribute(c);return null!==t?JSON.parse(t):i},set:function(t){null!==t?this.setAttribute(c,JSON.stringify(t)):this.removeAttribute(c)}});break;case Number:Object.defineProperty(a,s,{get:function(){const t=this.getAttribute(c);return null!==t?parseFloat(t):i},set:function(t){null!==t?this.setAttribute(c,t):this.removeAttribute(c)}});break;default:Object.defineProperty(a,s,{get:function(){const t=this.getAttribute(c);return null!==t?t:i},set:function(t){null!==t?this.setAttribute(c,t):this.removeAttribute(c)}})}}},Ue=function(t){return e=>{const{name:r,options:n}=t;return customElements.get(r)||customElements.define(r,e,n),e}},De=function(t){return(e,r)=>{const{constructor:n}=e,{prototype:a}=n,s=String(r),{selector:i}=t,o=t.withinShadowRoot?function(){return this.shadowRoot.querySelector(i)}:function(){return this.querySelector(i)};Object.defineProperty(a,s,{get:o})}};function ke(t,e){if(e){const{options:r,attributes:n,dataset:a,children:s,listeners:i}=e,o=document.createElement(t,r);if(n&&Object.entries(n).forEach((([t,e])=>{void 0!==e&&("boolean"==typeof e?o.toggleAttribute(Be(t),e):o.setAttribute(Be(t),String(e)))})),a){const{dataset:t}=o;Object.keys(a).forEach((e=>{t[e]=String(a[e])}))}return s&&("function"==typeof s?s(o):"object"==typeof s&&"length"in s?o.append(...Array.from(s)):o.append(s)),i&&Object.entries(i).forEach((([t,e])=>{Array.isArray(e)?o.addEventListener(t,e[0],e[1]):o.addEventListener(t,e)})),o}return document.createElement(t)}const Ge=new WeakMap;new FinalizationRegistry((t=>{const{model:e,reactiveElement:r}=t,n=Ge.get(e);if(void 0!==n){const{reactiveElementsArray:t}=n;t.splice(t.indexOf(r),1)}})),new Le((t=>{t.forEach((t=>{const{target:e,propertyName:r,oldValue:n,newValue:a}=t,{reactiveElementsArray:s}=Ge.get(e);s.forEach((t=>{const{elementRef:e,react:s,properties:i}=t,o=e.deref();o&&i.includes(r)&&s(o,r,n,a)}))}))}));const Ve=new WeakMap;new FinalizationRegistry((t=>{const{list:e,reactiveChildElement:r}=t,n=Ve.get(e);if(n){const{reactiveChildElementsArray:t}=n;t.splice(t.indexOf(r),1)}})),new Le((t=>{let e=null;Array.from(t.values()).forEach((t=>{const{target:r}=t,n=r,{length:a}=n,{reactiveChildElementsArray:s}=Ve.get(n);s.forEach((r=>{const{parentRef:n,mapping:s,placeholder:i}=r,o=n.deref();if(o){const{firstChild:r,children:n}=o,{length:c}=n;i&&a>0&&r==i&&o.removeChild(i);const{changeType:l,LIST_INSERT:h,LIST_REMOVE:u,LIST_SORT:d}=t;switch(l){case h:{const{insertedIndex:e,insertedItems:r}=t,a=Array.from(r.values()).map(s),{length:i}=n;e<i?n[e].before(...a):o.append(...a);break}case u:{const{removedIndex:r,removedItems:a}=t,{length:s}=a;e=e??document.createRange();const i=r+(s-1);i<c&&(e.setStartBefore(n[r]),e.setEndAfter(n[i]),e.deleteContents());break}case d:{const{sortedIndices:e}=t,r=Array.from(n);o.append(...e.filter((t=>t<c)).map((t=>r[t])));break}}0==a&&i&&o.append(i)}}))}))}));var He,Xe,je=r(193),We=r(147),ze=r(336),Ye=r(769),qe=r(923),$e=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i};const Ke="hsl(var(--theme-tint, 203), 92%, 80%, 50%)",Ze="hsl(var(--theme-tint, 203), 92%, 50%, 50%)",Qe="hsl(var(--theme-tint, 203), 92%, 75%, 75%)",Je="hsl(var(--theme-tint, 203), 92%, 50%, 50%)";class tr extends Pe{constructor(){super(),He.add(this),this.stylesheet=new CSSStyleSheet,this.stylesheet.replace(`\n            :root {\n                --theme-accent-color: hsl(var(--theme-tint, 203), 92%, 50%, 50%);\n                --theme-hovered-item-color: ${Ke};\n                --theme-focused-item-color: ${Ze};\n                --theme-focused-item-outline-color: hsl(var(--theme-tint, 203), 92%, 50%);\n                --theme-selected-item-color: ${Qe};\n                --theme-activated-item-color: ${Je};\n                --theme-droptarget-item-color: hsl(var(--theme-tint, 203), 92%, 50%, 50%);\n\n                --theme-arrow-color: var(--font-color);\n                --theme-arrow-icon-collapsed: var(--arrow-right);\n                --theme-arrow-icon-expanded: var(--arrow-dropdown);\n\n                --theme-sortorder-indicator-color: var(--font-color);\n                --theme-sortorder-indicator-ascending: var(--arrow-dropup);\n                --theme-sortorder-indicator-descending: var(--arrow-dropdown);\n            }\n            \n            @font-face {\n                font-family: "Open Sans";\n                src: url(${qe}) format("truetype")\n            }\n\n            :root {\n                font-size: 10px;\n                font-family: "Open Sans";\n                accent-color: var(--theme-accent-color);\n            }\n\n            ::selection {\n                background-color: var(--theme-selected-item-color);\n            }\n        `),this.addEventListener("modelchange",function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,He,"m",Xe).bind(this)),this.tint=203,this.arrowRightImage=je,this.arrowDropDownImage=We,this.arrowDropUpImage=ze,this.checkedImage=We}images(){return new Map([["checkedImage",this.checkedImage],["arrowRightImage",this.arrowRightImage],["arrowDropDownImage",this.arrowDropDownImage],["arrowDropUpImage",this.arrowDropUpImage]])}}He=new WeakSet,Xe=function(){const{stylesheet:t}=this,e=t.cssRules[0].styleMap;this.getRecords().forEach((t=>{const{propertyName:r,newValue:n}=t;switch(r){case"tint":e.set("--theme-tint",String(n));break;case"checkedImage":e.set("--theme-checked-image",`url(${String(n)})`);break;case"arrowRightImage":e.set("--theme-arrow-right-image",`url(${String(n)})`);break;case"arrowDropDown":e.set("--theme-arrow-dropdown-image",`url(${String(n)})`);break;case"arrowDropUp":e.set("--theme-arrow-dropup-image",`url(${String(n)})`)}}))},$e([xe()],tr.prototype,"tint",void 0),$e([xe()],tr.prototype,"checkedImage",void 0),$e([xe()],tr.prototype,"arrowRightImage",void 0),$e([xe()],tr.prototype,"arrowDropDownImage",void 0),$e([xe()],tr.prototype,"arrowDropUpImage",void 0),new tr;var er,rr,nr,ar,sr=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i},ir=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let or=class extends HTMLElement{constructor(){super(),er.add(this);const t=this.attachInternals();this.internals=t,t.role="menuitem";const e=this.attachShadow({mode:"open"}),r=new CSSStyleSheet;r.replace(ar),e.adoptedStyleSheets=[r],e.append(nr.content.cloneNode(!0))}connectedCallback(){const{tabIndex:t}=this;this.tabIndex=t}attributeChangedCallback(t,e,r){const{internals:n}=this;switch(t){case"type":switch(r){case"checkbox":case"radio":n.role=`menuitem${r}`;break;default:n.role="menuitem"}break;case"checked":n.ariaChecked=String(null!==r);break;case"disabled":n.ariaDisabled=String(null!==r);break;case"expanded":n.ariaExpanded=String(null!==r);break;case"label":n.ariaLabel=r}}toggle(t){const{type:e,expanded:r}=this;switch(e){case"menu":case"submenu":{const e=t??!r;this.expanded=e,e&&ir(this,er,"m",rr).call(this),this.dispatchEvent(new Event("toggle",{bubbles:!0}));break}}}expand(){const{type:t,expanded:e}=this;switch(t){case"menu":case"submenu":e||(this.expanded=!0,ir(this,er,"m",rr).call(this))}}collapse(){const{type:t,expanded:e}=this;switch(t){case"menu":case"submenu":e&&(this.expanded=!1)}}};er=new WeakSet,rr=function(){const{menu:t}=this;if(null!==t){const{width:e,height:r}=this.getBoundingClientRect(),{style:n}=t,{width:a,height:s}=t.getBoundingClientRect(),{clientWidth:i,clientHeight:o}=document.body,{type:c,offsetLeft:l,offsetTop:h}=this,u=l+e+a-i,d=h+s-o;"menu"===c?(n.setProperty("left",`${u>0?l+e-a:l}px`),n.setProperty("top",`${d>0?h-s:h+r}px`)):(n.setProperty("left",`${u>0?l-a:l+e}px`),n.setProperty("top",`${d>0?h+r-s:h}px`))}},(nr=ke("template")).content.append(ke("span",{attributes:{part:"icon"}}),ke("span",{attributes:{part:"label"},children:[ke("slot")]}),ke("span",{attributes:{part:"arrow"}}),ke("slot",{attributes:{name:"menu"}})),ar=`\n            :host {\n                display: flex;\n                user-select: none;\n                white-space: nowrap;\n                box-sizing: border-box;\n            }\n            \n            :host([disabled]) {\n                opacity: 0.38;\n                pointer-events: none;\n            }\n            \n            :host(:focus-within) {\n                background-color: ${Ze};\n            }\n            \n            :host(:is([type="menu"], [type="submenu"])) ::slotted([slot="menu"]) {\n                z-index: 1;\n                position: absolute;\n            }\n            \n            :host(:is([type="menu"], [type="submenu"]):not([expanded])) ::slotted([slot="menu"]) {\n                width: 0;\n                height: 0;\n                padding: 0;\n                opacity: 0;\n                pointer-events: none;\n                overflow: hidden;\n            }\n            \n            :host([type="submenu"]) [part="icon"] {\n                visibility: hidden;\n            }\n            \n            :host([type="menu"]) [part="icon"],\n            :host(:not([type="submenu"])) [part="arrow"] {\n                display: none;\n            }\n            \n            :host(:is([type="checkbox"], [type="radio"])[checked]) [part="icon"]::before {\n                -webkit-mask-image: var(--theme-arrow-done-image, url(${Ye}));\n                mask-image: var(--theme-arrow-done-image, url(${Ye}));\n                background-color: black;\n            }\n            \n            :host([type="submenu"]) [part="arrow"]::after {\n                -webkit-mask-image: var(--theme-arrow-right-image, url(${je}));\n                mask-image: var(--theme-arrow-right-image, url(${je}));\n                background-color: black;\n            }\n            \n            [part="icon"],\n            [part="label"],\n            [part="arrow"] {\n                pointer-events: none;\n            }\n            \n            [part="icon"] {\n                flex: none;\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n                padding: 2px;\n                overflow: hidden;\n                margin-right: 4px;\n            }\n            \n            [part="label"] {\n                flex: auto;\n                line-height: 18px;\n                padding: 2px;\n                margin-left: 8px;\n                margin-right: 8px;\n            }\n            \n            :host(:is(:not([type]), [type="button"], [type="radio"], [type="checkbox"])[checked]) [part="icon"] {\n                background-color: var(--theme-activated-item-color, ${Je});\n            }\n            \n            :host(:is(:not([type]), [type="button"], [type="radio"], [type="checkbox"])) [part="icon"]::before {\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n                content: "";\n                mask-size: 18px 18px;\n                -webkit-mask-size: 18px 18px;\n\n                mask-image: none;\n                -webkit-mask-image: none;\n                background-color: none;\n            }\n            \n            [part="arrow"] {\n                flex: none;\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n                margin: 1px 4px 1px 1px;\n            }\n            \n            [part="arrow"]::after {\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n                margin: 1px;\n                content: "";\n                mask-size: 18px 18px;\n                -webkit-mask-size: 18px 18px;\n\n                mask-image: none;\n                -webkit-mask-image: none;\n                background-color: none;\n            }\n\n            :host(:hover):host-context(e-menubar:focus),\n            :host(:hover):host-context(e-menubar:not(:focus-within)) {\n                background-color: var(--theme-hovered-item-color, ${Ke});\n            }\n        `,sr([De({selector:":scope > e-menu[slot=menu]"})],or.prototype,"menu",void 0),sr([Fe({type:String})],or.prototype,"name",void 0),sr([Fe({type:String,observed:!0})],or.prototype,"label",void 0),sr([Fe({type:String})],or.prototype,"value",void 0),sr([Fe({type:String})],or.prototype,"hotkey",void 0),sr([Fe({type:Boolean,observed:!0})],or.prototype,"disabled",void 0),sr([Fe({type:Boolean,observed:!0})],or.prototype,"checked",void 0),sr([Fe({type:Boolean,observed:!0})],or.prototype,"expanded",void 0),sr([Fe({type:Boolean})],or.prototype,"overflown",void 0),sr([Fe({type:String,defaultValue:"button",observed:!0})],or.prototype,"type",void 0),or=sr([Ue({name:"e-menuitem"})],or);var cr,lr,hr=or,ur=Object.assign((function(t){const{label:e,name:r,type:n,value:a,trigger:s,menu:i}=t;return i&&(i.slot="menu"),ke("e-menuitem",{attributes:{tabindex:-1,title:e,name:r,value:a,type:n},children:i?[e,i]:[e],listeners:{click:s}})}),{prototype:hr.prototype,button:t=>new ur({...t,type:"button"}),checkbox:t=>new ur({...t,type:"checkbox"}),radio:t=>new ur({...t,type:"radio"}),menu:t=>new ur({...t,type:"menu"}),submenu:t=>new ur({...t,type:"submenu"})}),dr=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i};let fr=class extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(lr),t.adoptedStyleSheets=[e],t.append(cr.content.cloneNode(!0));const r=this.attachInternals();r.role="group",this.internals=r}attributeChangedCallback(t,e,r){const{internals:n}=this;"label"===t&&(n.ariaLabel=r)}};(cr=ke("template")).content.append(ke("span",{attributes:{part:"label"}}),ke("slot")),lr='\n            :host {\n                display: flex;\n                flex-direction: column;\n            }\n            \n            [part="label"] {\n                font-weight: bold;\n            }\n            \n            :host([label]) [part="label"] {\n                padding-bottom: 6px;\n            }\n        ',dr([Fe({type:String})],fr.prototype,"name",void 0),dr([Fe({type:String,observed:!0})],fr.prototype,"label",void 0),fr=dr([Ue({name:"e-menuitemgroup"})],fr);var pr,yr,mr,Er,gr,Tr,Ar,_r,Rr,wr,br,vr,Ir,Nr,Sr,xr,Mr,Cr,Pr,Or,Lr,Br=fr,Fr=(Object.assign((function(t){const{name:e,items:r}=t;return ke("e-menuitemgroup",{attributes:{name:e},children:r})}),{prototype:Br.prototype,radios:t=>{const{name:e,items:r}=t;return ke("e-menuitemgroup",{attributes:{name:e},children:r.map((({label:t,value:r})=>new ur({name:e,label:t,type:"radio",value:r})))})}}),function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}),Ur=function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(t,r):a?a.value=r:e.set(t,r),r},Dr=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let kr=Cr=class extends HTMLElement{constructor(){super(),pr.add(this),yr.set(this,void 0),mr.set(this,void 0),Ur(this,mr,-1,"f"),Ur(this,yr,document.createTreeWalker(this,NodeFilter.SHOW_ELEMENT,Dr(this,pr,"m",Tr).bind(this)),"f");const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(Or),t.adoptedStyleSheets=[e],t.append(Pr.content.cloneNode(!0)),this.addEventListener("click",Dr(this,pr,"m",vr).bind(this)),this.addEventListener("mouseover",Dr(this,pr,"m",Mr).bind(this)),this.addEventListener("mouseout",Dr(this,pr,"m",xr).bind(this)),this.addEventListener("focusin",Dr(this,pr,"m",Ir).bind(this)),this.addEventListener("focusout",Dr(this,pr,"m",Nr).bind(this)),this.addEventListener("keydown",Dr(this,pr,"m",Sr).bind(this))}items(){return Array.from(this.querySelectorAll(":is(:scope, :scope > e-menuitemgroup) > e-menuitem"))}get activeIndex(){return Dr(this,mr,"f")}get activeItem(){const{activeIndex:t}=this;return this.querySelector(":is(:scope, :scope > e-menuitemgroup) > e-menuitem:focus-within")??t>-1?this.items()[t]??null:null}connectedCallback(){const t=this.getAttribute("tabindex");this.tabIndex=null!==t?parseInt(t):-1}positionContextual(t,e){const{style:r}=this,{width:n,height:a}=this.getBoundingClientRect(),{scrollX:s,scrollY:i}=window,o=t+s,c=e+i,{clientWidth:l,clientHeight:h}=document.body,u=o+n-l,d=c+a-h;r.setProperty("left",`${u>0?o-n:o}px`),r.setProperty("top",`${d>0?c-a:c}px`)}firstItem(){const t=Dr(this,yr,"f");return t.currentNode=t.root,t.firstChild()}};yr=new WeakMap,mr=new WeakMap,pr=new WeakSet,Er=function(){this.querySelectorAll(":is(:scope, :scope > e-menuitemgroup) > e-menuitem[expanded]").forEach((t=>{t.collapse()}))},gr=function(t){return Array.from(this.querySelectorAll(":is(:scope, :scope > e-menuitemgroup) > e-menuitem")).find((e=>e.contains(t)))??null},Tr=function(t){return t instanceof hr?NodeFilter.FILTER_ACCEPT:t instanceof Br?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT},Ar=function(){const t=Dr(this,yr,"f");return t.currentNode=t.root,t.lastChild()},_r=function(t){const e=Dr(this,yr,"f");return e.currentNode=t,e.previousNode()},Rr=function(t){const e=Dr(this,yr,"f");return e.currentNode=t,e.nextNode()},wr=function(t){const{menu:e}=t;return e instanceof Cr?e.firstItem():null},br=function(t){null!==t&&Ur(this,mr,this.items().indexOf(t),"f")},vr=function(t){const{target:e}=t,r=e.closest("e-menuitem");if(r){const{type:t,checked:e}=r;switch(t){case"checkbox":r.checked=!e;break;case"radio":{const{name:t,value:e}=r;r.checked=!0,this.querySelectorAll(`:is(:scope, :scope > e-menuitemgroup) > e-menuitem[type=radio][name=${t}]`).forEach((t=>{t.checked=t.value==e}));break}case"menu":case"submenu":r.toggle()}}t.stopPropagation()},Ir=function(t){const{target:e}=t;if(e instanceof hr){const t=Dr(this,pr,"m",gr).call(this,e);t&&Dr(this,pr,"m",br).call(this,t)}},Nr=function(t){const{relatedTarget:e}=t;if(!this.contains(e)){const{contextual:t}=this;if(t)try{this.remove()}catch(t){}else{const{activeItem:t}=this;t?.expanded&&t.collapse(),Dr(this,pr,"m",br).call(this,null)}}},Sr=function(t){const{key:e}=t,{activeItem:r}=this;switch(e){case"ArrowUp":(r?Dr(this,pr,"m",_r).call(this,r)??Dr(this,pr,"m",Ar).call(this):this.firstItem())?.focus({preventScroll:!0}),t.stopPropagation();break;case"ArrowDown":(r?Dr(this,pr,"m",Rr).call(this,r)??this.firstItem():this.firstItem())?.focus({preventScroll:!0}),t.stopPropagation();break;case"Home":this.firstItem()?.focus({preventScroll:!0}),t.stopPropagation();break;case"End":Dr(this,pr,"m",Ar).call(this)?.focus({preventScroll:!0}),t.stopPropagation();break;case"Enter":case" ":if(r){const{type:e}=r;switch(e){case"menu":case"submenu":r.expand(),r.expanded&&Dr(this,pr,"m",wr).call(this,r)?.focus({preventScroll:!0});break;default:r.click()}t.stopPropagation()}break;case"Escape":if(r)if(t.composedPath().find((t=>t instanceof on))==this){const{contextual:e}=this;e&&(this.blur(),this.dispatchEvent(new Event("close",{bubbles:!0})),t.stopPropagation())}else r.collapse(),r.focus({preventScroll:!0}),t.stopPropagation();break;case"ArrowLeft":r&&(t.composedPath().find((t=>t instanceof on))==this||(r.collapse(),r.focus({preventScroll:!0}),t.stopPropagation()));break;case"ArrowRight":if(r){const{type:e}=r;"submenu"===e&&(r.expanded||(r.expand(),Dr(this,pr,"m",wr).call(this,r)?.focus({preventScroll:!0}),t.stopPropagation()))}}},xr=function(t){const{target:e,relatedTarget:r}=t;if(e instanceof hr){const n=Dr(this,pr,"m",gr).call(this,e);if(null!==n&&("submenu"!=n.type||n.expanded||Lr.get(n)?.cancel(),t.composedPath().find((t=>t instanceof on))==this)){const{activeItem:e}=this;if("submenu"==e?.type&&e.expanded){let t=Lr.get(e);t&&t.cancel(),t=e.animate(null,{duration:200}),Lr.set(e,t);const{finished:r}=t;r.then((()=>{e.collapse()})).catch((()=>{})).finally((()=>{Lr.delete(e)}))}const{left:n,right:a,top:s,bottom:i}=(()=>{const t=this.closest("e-menuitem");if(t&&!t.expanded){t.expand();const e=this.getBoundingClientRect();return t.collapse(),e}return this.getBoundingClientRect()})(),{clientX:o,clientY:c}=t,l=!(n>o||a<o||s>c||i<c),h=this.contains(r);l&&h&&(r instanceof on&&r!==this?r.focus({preventScroll:!0}):(this.focus({preventScroll:!0}),Dr(this,pr,"m",br).call(this,null))),l||(this.focus({preventScroll:!0}),Dr(this,pr,"m",br).call(this,null))}}},Mr=function(t){const{target:e}=t;if(e instanceof hr){const r=Dr(this,pr,"m",gr).call(this,e);if(null!==r&&("submenu"===r.type&&r.expanded&&Lr.get(r)?.cancel(),t.composedPath().find((t=>t instanceof on))==this)){const{activeItem:t}=this;if("submenu"===t?.type&&t.expanded&&!t.contains(e)){let e=Lr.get(t);e&&e.cancel(),e=t.animate(null,{duration:400}),Lr.set(t,e);const{finished:r}=e;r.then((()=>{t.collapse()})).catch((()=>{})).finally((()=>{Lr.delete(t)}))}if(Dr(this,pr,"m",br).call(this,r),r.focus({preventScroll:!0}),"submenu"===r.type)if(r.expanded)r.menu?.focus({preventScroll:!0});else{let t=Lr.get(r);t&&t.cancel(),t=r.animate(null,{duration:200}),Lr.set(r,t);const{finished:e}=t;e.then((()=>{const{activeItem:t}=this;Dr(this,pr,"m",Er).call(this),t&&(Lr.get(t)?.cancel(),t.expand(),t.menu?.focus({preventScroll:!0}))})).catch((()=>{})).finally((()=>{Lr.delete(r)}))}}}},(Pr=ke("template")).content.append(ke("slot")),Or="\n            :host {\n                display: flex;\n                flex-direction: column;\n            \n                padding: 3px;\n                background-color: white;\n                width: max-content;\n                box-sizing: border-box;\n            \n                -webkit-box-shadow: rgba(0, 0, 0, 0.2) 0 1px 3px;\n                box-shadow: rgba(0, 0, 0, 0.2) 0 1px 3px;\n            }\n            \n            :host([contextual]) {\n                z-index: 1;\n                position: absolute;\n            }\n        ",Lr=new WeakMap,Fr([Fe({type:String})],kr.prototype,"name",void 0),Fr([Fe({type:Boolean})],kr.prototype,"contextual",void 0),kr=Cr=Fr([Ue({name:"e-menu"})],kr);var Gr,Vr,Hr,Xr,jr,Wr,zr,Yr,qr,$r,Kr,Zr,Qr,Jr,tn,en,rn,nn,an,sn,on=kr,cn=(Object.assign((function(t){const{name:e,children:r}=t;return ke("e-menu",{attributes:{name:e,tabindex:-1},children:r})}),{prototype:on.prototype}),function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}),ln=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)},hn=function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(t,r):a?a.value=r:e.set(t,r),r};let un=class extends HTMLElement{constructor(){super(),Gr.add(this),Vr.set(this,void 0),Hr.set(this,void 0),hn(this,Hr,document.createTreeWalker(this,NodeFilter.SHOW_ELEMENT,ln(this,Gr,"m",Xr).bind(this)),"f"),hn(this,Vr,-1,"f");const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(sn),t.adoptedStyleSheets=[e],t.append(an.content.cloneNode(!0)),this.addEventListener("click",ln(this,Gr,"m",rn).bind(this)),this.addEventListener("focus",ln(this,Gr,"m",Qr).bind(this)),this.addEventListener("focusin",ln(this,Gr,"m",Jr).bind(this)),this.addEventListener("focusout",ln(this,Gr,"m",tn).bind(this)),this.addEventListener("mouseover",ln(this,Gr,"m",en).bind(this)),this.addEventListener("keydown",ln(this,Gr,"m",nn).bind(this))}connectedCallback(){const t=this.getAttribute("tabindex");this.tabIndex=null!==t?parseInt(t):-1}items(){return Array.from(this.querySelectorAll(":is(:scope, :scope > e-menuitemgroup) > e-menuitem"))}get activeIndex(){return ln(this,Vr,"f")}get activeItem(){const{activeIndex:t}=this;return this.querySelector(":is(:scope, :scope > e-menuitemgroup) > e-menuitem:focus-within")??t>-1?this.items()[t]??null:null}firstItem(){const t=ln(this,Hr,"f");return t.currentNode=t.root,t.firstChild()}};Vr=new WeakMap,Hr=new WeakMap,Gr=new WeakSet,Xr=function(t){return t instanceof hr&&!t.disabled&&!t.hidden?NodeFilter.FILTER_ACCEPT:t instanceof Br?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT},jr=function(){const t=ln(this,Hr,"f");return t.currentNode=t.root,t.lastChild()},Wr=function(t){const e=ln(this,Hr,"f");return e.currentNode=t,e.previousSibling()},zr=function(t){const e=ln(this,Hr,"f");return e.currentNode=t,e.nextSibling()},Yr=function(t){const{menu:e}=t;if(e){const t=ln(this,Hr,"f");return t.currentNode=e,t.firstChild()}return null},qr=function(t){const{activeItem:e,expanded:r}=this;null!==e&&e!==t&&e.collapse(),null!==t?(r&&t.expand(),hn(this,Vr,this.items().indexOf(t),"f")):hn(this,Vr,-1,"f")},$r=function(){return Array.from(this.querySelectorAll(":is(:scope, :scope > e-menuitemgroup) > e-menuitem"))},Kr=function(t){return t.closest(":is(e-menubar, e-menu)")==this},Zr=function(t){return ln(this,Gr,"a",$r).find((e=>e.contains(t)))??null},Qr=function(t){const{relatedTarget:e}=t,{activeItem:r}=this;this.contains(e)||(r??this.firstItem())?.focus()},Jr=function(t){const{target:e}=t;if(e instanceof Element){const t=ln(this,Gr,"m",Zr).call(this,e);ln(this,Gr,"m",qr).call(this,t),this.tabIndex=-1}},tn=function(t){const{target:e,relatedTarget:r}=t;if(e instanceof HTMLElement){const t=ln(this,Gr,"m",Zr).call(this,e);t&&t.collapse()}!this.contains(r)&&(this.expanded=!1,this.tabIndex=0)},en=function(t){const{target:e}=t,{expanded:r,activeItem:n}=this;if(e instanceof hr&&ln(this,Gr,"m",Kr).call(this,e)&&e!==n&&r){const{menu:t}=e;t&&(e.expand(),t.focus({preventScroll:!0}))}},rn=function(t){const{target:e}=t,{expanded:r,activeItem:n}=this;if(e instanceof hr&&ln(this,Gr,"m",Kr).call(this,e)){const t=!r;if(this.expanded=t,t){n&&!n.expanded&&n.expand();const{menu:t}=e;t?.focus({preventScroll:!0})}else n&&(n.collapse(),n.blur())}},nn=function(t){const{key:e}=t,{expanded:r}=this;let{activeItem:n}=this;switch(e){case"ArrowLeft":(n?ln(this,Gr,"m",Wr).call(this,n)??ln(this,Gr,"m",jr).call(this):this.firstItem())?.focus({preventScroll:!0}),({activeItem:n}=this),r&&n&&ln(this,Gr,"m",Yr).call(this,n)?.focus({preventScroll:!0});break;case"ArrowRight":(n?ln(this,Gr,"m",zr).call(this,n)??this.firstItem():ln(this,Gr,"m",jr).call(this))?.focus({preventScroll:!0}),({activeItem:n}=this),r&&n&&ln(this,Gr,"m",Yr).call(this,n)?.focus({preventScroll:!0});break;case"Enter":case" ":n&&(this.expanded=!r,!r)&&ln(this,Gr,"m",Yr).call(this,n)?.focus({preventScroll:!0});break;case"Escape":r?(this.expanded=!1,n&&(n.collapse(),n.focus({preventScroll:!0}))):this.focus({preventScroll:!0}),t.stopPropagation()}},(an=ke("template")).content.append(ke("slot")),sn="\n            :host {\n                position: relative;\n                display: flex;\n                flex-direction: row;\n                width: max-content;\n            }\n            \n            :host(:focus) {\n                outline: 1px solid var(--theme-focused-item-outline-color, hsl(var(--theme-tint, 203), 92%, 50%));\n                outline-offset: -1px;\n            }\n        ",cn([Fe({type:String})],un.prototype,"name",void 0),cn([Fe({type:Boolean})],un.prototype,"expanded",void 0),un=cn([Ue({name:"e-menubar"})],un);var dn,fn,pn,yn,mn,En,gn,Tn=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i},An=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let _n=class extends HTMLElement{constructor(){super(),dn.add(this);const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(gn),t.adoptedStyleSheets=[e],t.append(En.content.cloneNode(!0)),this.addEventListener("keydown",An(this,dn,"m",mn).bind(this)),this.addEventListener("click",An(this,dn,"m",pn).bind(this)),this.addEventListener("focusout",An(this,dn,"m",yn).bind(this))}connectedCallback(){const t=this.getAttribute("tabindex");this.tabIndex=null!==t?parseInt(t):-1}toggle(t){const{expanded:e}=this;t??!e?this.expand():this.collapse()}expand(){const{expanded:t}=this;t||(this.expanded=!0,An(this,dn,"m",fn).call(this))}collapse(){const{expanded:t}=this;t&&(this.expanded=!1)}};dn=new WeakSet,fn=function(){const{menu:t}=this;if(null!==t){const{width:e,height:r}=this.getBoundingClientRect(),{style:n}=t,{width:a,height:s}=t.getBoundingClientRect(),{clientWidth:i,clientHeight:o}=document.body,{offsetLeft:c,offsetTop:l}=this,h=c+e+a-i,u=l+s-o;n.setProperty("left",(h>0?e-a:0)+"px"),n.setProperty("top",`${u>0?-s:r}px`)}},pn=function(t){const{target:e}=t,{menu:r}=this;if(r&&!r.contains(e)){this.toggle();const{expanded:t}=this;t&&r?.focus({preventScroll:!0})}},yn=function(t){const{relatedTarget:e}=t;!this.contains(e)&&this.collapse()},mn=function(t){const{key:e}=t,{expanded:r}=this;switch(e){case"ArrowDown":case"Enter":r||(this.expand(),this.firstItem?.focus({preventScroll:!0}),t.stopPropagation());break;case"Escape":r&&this.collapse(),this.focus({preventScroll:!0}),t.stopPropagation()}},(En=ke("template")).content.append(ke("slot"),ke("slot",{attributes:{name:"menu"}})),gn=`\n            :host {\n                position: relative;\n                display: inline-block;\n                padding: 2px;\n                line-height: 18px;\n                user-select: none;\n                white-space: nowrap;\n                cursor: pointer;\n            }\n            \n            :host(:focus) {\n                outline: 1px solid var(--theme-focused-item-outline-color, hsl(var(--theme-tint, 203), 92%, 50%));\n                outline-offset: -1px;\n            }\n            \n            :host(:focus-within:not(:focus)) {\n                background-color: var(--theme-focused-item-color, ${Ze});\n            }\n            \n            :host(:hover:not(:focus-within)) {\n                background-color: var(--theme-hovered-item-color, ${Ke});\n            }\n            \n            :host([disabled]) {\n                color: lightgray;\n            }\n            \n            ::slotted([slot="menu"]) {\n                z-index: 1;\n                position: absolute;\n                color: initial;\n            }\n            \n            :host(:not([expanded])) ::slotted([slot="menu"]) {\n                opacity: 0;\n                pointer-events: none;\n            }\n            \n            :host::after {\n                display: inline-block;\n                text-align: center;\n                width: 18px;\n                height: 18px;\n                content: "";\n            }\n        `,Tn([De({selector:":scope > e-menu[slot=menu]"})],_n.prototype,"menu",void 0),Tn([De({selector:":scope > e-menu[slot=menu] e-menuitem"})],_n.prototype,"firstItem",void 0),Tn([Fe({type:String})],_n.prototype,"name",void 0),Tn([Fe({type:Boolean})],_n.prototype,"disabled",void 0),Tn([Fe({type:Boolean})],_n.prototype,"expanded",void 0),_n=Tn([Ue({name:"e-menubutton"})],_n);var Rn,wn,bn,vn,In,Nn=_n,Sn=(Object.assign((function(t){const{menu:e}=t;return e.slot="menu",ke("e-menubutton",{attributes:{tabindex:-1},children:[e]})}),{prototype:Nn.prototype}),function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i});let xn=class extends HTMLElement{constructor(){super(),Rn.add(this);const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(vn),t.adoptedStyleSheets=[e],t.append(bn.content.cloneNode(!0))}connectedCallback(){const{tabIndex:t}=this;this.tabIndex=t}attributeChangedCallback(t,e,r){switch(t){case"label":break;case"iconed":{const{shadowRoot:t}=this;if(null!==r)t.prepend(In.cloneNode(!0));else{const t=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,Rn,"m",wn).call(this);t&&t.remove()}break}}}};Rn=new WeakSet,wn=function(){return this.shadowRoot.querySelector("[part=icon]")},(bn=ke("template")).content.append(ke("slot"),ke("slot",{attributes:{name:"select"}}),ke("slot",{attributes:{name:"menubutton"}})),In=ke("span",{attributes:{part:"icon"}}),vn=`\n            :host {\n                display: flex;\n                user-select: none;\n                white-space: nowrap;\n                cursor: pointer;\n                line-height: 22px;\n            }\n            \n            :host([disabled]) {\n                opacity: 0.38;\n                pointer-events: none;\n            }\n            \n            :host(:hover) {\n                background-color: var(--theme-hovered-item-color, ${Ke});\n            }\n            \n            :host([pressed]),\n            :host(:active) {\n                background-color: var(--theme-activated-item-color, ${Je});\n            }\n            \n            :host(:not([iconed])) [part="icon"] {\n                display: none;\n            }\n\n            [part="icon"] {\n                flex: none;\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n                padding: 2px;\n                overflow: hidden;\n            }\n            \n            [part="icon"]::before {\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n                content: "";\n                mask-size: 18px 18px;\n                -webkit-mask-size: 18px 18px;\n                background-color: none;\n                -webkit-mask-image: none;\n                mask-image: none;\n                filter: none;\n            }\n            \n            :host(:focus) {\n                outline: 1px solid var(--theme-focused-item-outline-color, hsl(var(--theme-tint, 203), 92%, 50%));\n                outline-offset: -1px;\n            }\n            \n            :host([type="select"]:focus) ::slotted(e-select) {\n                border-color: transparent;\n            }\n        `,Sn([De({selector:":scope > e-menubutton[slot=menubutton]"})],xn.prototype,"menubutton",void 0),Sn([De({selector:":scope > e-select[slot=select]"})],xn.prototype,"select",void 0),Sn([Fe({type:Boolean})],xn.prototype,"active",void 0),Sn([Fe({type:Boolean})],xn.prototype,"pressed",void 0),Sn([Fe({type:Boolean})],xn.prototype,"expanded",void 0),Sn([Fe({type:Boolean,observed:!0})],xn.prototype,"iconed",void 0),Sn([Fe({type:String,observed:!0})],xn.prototype,"value",void 0),Sn([Fe({type:String})],xn.prototype,"name",void 0),Sn([Fe({type:String,observed:!0})],xn.prototype,"label",void 0),Sn([Fe({type:String})],xn.prototype,"type",void 0),xn=Sn([Ue({name:"e-toolbaritem"})],xn);var Mn,Cn,Pn=xn,On=Object.assign((function(t){const{label:e,name:r,type:n,value:a,trigger:s,menubutton:i,select:o}=t;return i&&(i.slot="menubutton"),o&&(o.slot="select"),ke("e-toolbaritem",{attributes:{tabindex:-1,title:e,name:r,value:a,type:n},children:i?[i]:o?[o]:void 0,listeners:{click:s}})}),{prototype:Pn.prototype,button:t=>new On({...t,type:"button"}),checkbox:t=>new On({...t,type:"checkbox"}),radio:t=>new On({...t,type:"radio"}),menubutton:t=>new On({...t,type:"menubutton"}),select:t=>new On({...t,type:"select"})}),Ln=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i};let Bn=class extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(Cn),t.adoptedStyleSheets=[e],t.append(Mn.content.cloneNode(!0))}attributeChangedCallback(t,e,r){switch(t){case"label":{const t=this.shadowRoot.querySelector("[part='label']");t&&(t.textContent=r);break}}}};(Mn=ke("template")).content.append(ke("slot")),Cn="\n            :host {\n                display: flex;\n                width: max-content;\n                flex-direction: row;\n            }\n        ",Ln([Fe({type:String})],Bn.prototype,"name",void 0),Ln([Fe({type:String,observed:!0})],Bn.prototype,"label",void 0),Bn=Ln([Ue({name:"e-toolbaritemgroup"})],Bn);var Fn,Un,Dn,kn,Gn,Vn,Hn,Xn,jn,Wn,zn,Yn,qn,$n,Kn,Zn,Qn,Jn,ta=Bn,ea=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i},ra=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let na=class extends HTMLElement{constructor(){super(),Fn.add(this),Un.set(this,void 0),function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?a.call(t,r):a?a.value=r:e.set(t,r)}(this,Un,document.createTreeWalker(this,NodeFilter.SHOW_ELEMENT,ra(this,Fn,"m",Dn).bind(this)),"f");const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(Qn),t.adoptedStyleSheets=[e],t.append(Zn.content.cloneNode(!0)),this.addEventListener("click",ra(this,Fn,"m",Xn).bind(this)),this.addEventListener("contextmenu",ra(this,Fn,"m",jn).bind(this)),this.addEventListener("dblclick",ra(this,Fn,"m",Wn).bind(this)),this.addEventListener("focus",ra(this,Fn,"m",zn).bind(this)),this.addEventListener("focusin",ra(this,Fn,"m",Yn).bind(this)),this.addEventListener("focusout",ra(this,Fn,"m",qn).bind(this)),this.addEventListener("mousedown",ra(this,Fn,"m",$n).bind(this)),this.addEventListener("keydown",ra(this,Fn,"m",Kn).bind(this))}get activeItem(){return this.querySelector("e-toolbaritem[active]")}items(){return Array.from(this.querySelectorAll(":is(:scope, :scope > e-toolbaritemgroup) > e-toolbaritem"))}connectedCallback(){const{tabIndex:t}=this;this.tabIndex=t}firstItem(){const t=ra(this,Un,"f");return t.currentNode=t.root,t.firstChild()}};Un=new WeakMap,Fn=new WeakSet,Dn=function(t){return t instanceof Pn?NodeFilter.FILTER_ACCEPT:t instanceof ta?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT},kn=function(){const t=ra(this,Un,"f");return t.currentNode=t.root,t.lastChild()},Gn=function(t){const e=ra(this,Un,"f");return e.currentNode=t,e.previousSibling()},Vn=function(t){const e=ra(this,Un,"f");return e.currentNode=t,e.nextSibling()},Hn=function(t){const{activeItem:e}=this;null!==e&&e!==t&&(e.active=!1),null!==t&&(t.active=!0)},Xn=function(t){const{target:e}=t,r=e.closest("e-toolbaritem");if(r){const{type:t,pressed:n}=r;switch(t){case"checkbox":r.pressed=!n;break;case"radio":r.pressed=!0;break;case"menubutton":{const{menubutton:t}=r;if(t&&!t.contains(e)){const e=!Jn.get(r);t.toggle(e),e&&t.firstItem?.focus({preventScroll:!0})}break}case"select":{const{select:t}=r;if(t&&!t.contains(e)){const e=!Jn.get(r);t.toggle(e)}break}}}t.stopPropagation()},jn=function(t){t.stopPropagation()},Wn=function(t){t.stopPropagation()},zn=function(t){const{relatedTarget:e}=t,{activeItem:r}=this;this.contains(e)||(r??this.firstItem())?.focus()},Yn=function(t){const{target:e}=t,r=e.closest("e-toolbaritem");r&&(ra(this,Fn,"m",Hn).call(this,r),this.tabIndex=-1)},qn=function(t){const{relatedTarget:e}=t;!this.contains(e)&&(this.tabIndex=0)},$n=function(t){const{target:e}=t,r=e.closest("e-toolbaritem");if(r){const{type:t}=r;switch(t){case"menubutton":{const{menubutton:t}=r;t&&!t.contains(e)&&Jn.set(r,t.expanded);break}case"select":{const{select:t}=r;t&&!t.contains(e)&&Jn.set(r,t.expanded);break}}}},Kn=function(t){const{key:e}=t,{activeItem:r}=this;switch(e){case"Enter":case" ":if(r){const{type:e}=r;switch(e){case"menubutton":{const{menubutton:t}=r;t&&(t.expand(),t.firstItem?.focus({preventScroll:!0}));break}case"select":{const{select:t}=r;t&&t.expand();break}default:r.click()}t.stopPropagation()}break;case"ArrowLeft":if(r){const t=ra(this,Fn,"m",Gn).call(this,r);t&&t.focus({preventScroll:!0})}else{const t=this.firstItem();t&&t.focus({preventScroll:!0})}t.stopPropagation();break;case"ArrowRight":if(r){const t=ra(this,Fn,"m",Vn).call(this,r);t&&t.focus({preventScroll:!0})}else{const t=ra(this,Fn,"m",kn).call(this);t&&t.focus({preventScroll:!0})}t.stopPropagation();break;case"ArrowDown":if(r){const{type:e}=r;"select"===e&&(r.select?.expand(),t.stopPropagation())}break;case"Home":{const e=this.firstItem();e&&e.focus({preventScroll:!0}),t.stopPropagation();break}case"End":{const e=ra(this,Fn,"m",kn).call(this);e&&e.focus({preventScroll:!0}),t.stopPropagation();break}}},(Zn=ke("template")).content.append(ke("slot")),Jn=new WeakMap,Qn="\n            :host {\n                display: flex;\n                flex-direction: row;\n            }\n        ",ea([Fe({type:String})],na.prototype,"name",void 0),ea([Fe({type:String})],na.prototype,"orientation",void 0),na=ea([Ue({name:"e-toolbar"})],na);var aa,sa,ia,oa,ca,la,ha,ua=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i},da=function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(t,r):a?a.value=r:e.set(t,r),r},fa=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let pa=class extends HTMLElement{constructor(){super(),aa.add(this),sa.set(this,void 0),ia.set(this,void 0);const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(ha),t.adoptedStyleSheets=[e],da(this,sa,null,"f"),da(this,ia,!1,"f"),this.addEventListener("pointerdown",fa(this,aa,"m",ca).bind(this)),this.addEventListener("pointermove",fa(this,aa,"m",la).bind(this)),this.addEventListener("pointerup",fa(this,aa,"m",oa).bind(this))}attributeChangedCallback(t,e,r){switch(t){case"controls":{const{controls:t}=this;da(this,sa,document.getElementById(t),"f");break}}}};sa=new WeakMap,ia=new WeakMap,aa=new WeakSet,oa=function(t){const{pointerId:e}=t;this.releasePointerCapture(e),da(this,ia,!1,"f")},ca=function(t){const{pointerId:e}=t,{controls:r}=this;da(this,sa,document.getElementById(r),"f"),this.setPointerCapture(e),da(this,ia,!0,"f")},la=function(t){if(fa(this,ia,"f")){const e=fa(this,sa,"f");if(null!==e){const r=window.getComputedStyle(e),{movementX:n,movementY:a}=t,{width:s,height:i}=e.getBoundingClientRect(),o=e.parentElement??document.body,{left:c,right:l,top:h,bottom:u}=o.getBoundingClientRect(),d=parseFloat(r.getPropertyValue("left")),f=Math.max(c,Math.min(Math.trunc(d+n),l-s)),p=parseFloat(r.getPropertyValue("top")),y=Math.max(h,Math.min(Math.trunc(p+a),u-i));e.style.setProperty("left",`${f}px`),e.style.setProperty("top",`${y}px`),this.dispatchEvent(new CustomEvent("move"))}}},ha=`\n            :host {\n                display: block;\n                            \n                width: 24px;\n                height: 12px;\n                \n                background-color: var(--theme-selected-item-color, ${Qe});\n\n                -webkit-mask-image: url("/assets/dots.png");\n                mask-image: url("/assets/dots.png");\n\n                -webkit-mask-repeat: repeat;\n                mask-repeat: repeat;\n                cursor: move;\n            }\n        `,ua([Fe({type:String,observed:!0})],pa.prototype,"controls",void 0),pa=ua([Ue({name:"e-handle"})],pa);var ya,ma,Ea=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i};let ga=class extends HTMLElement{constructor(){super(...arguments),ya.add(this)}connectedCallback(){const{src:t}=this;t&&function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,ya,"m",ma).call(this,t)}};ya=new WeakSet,ma=async function(t){this.outerHTML=await fetch(t).then((t=>{if(t.ok)return t.text();throw new Error(t.statusText)})),this.dispatchEvent(new Event("load",{bubbles:!0}))},Ea([Fe({type:String})],ga.prototype,"src",void 0),ga=Ea([Ue({name:"e-import"})],ga);var Ta,Aa,_a,Ra,wa,ba=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i};let va=class extends HTMLElement{constructor(){super(),Ta.add(this);const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(wa),t.adoptedStyleSheets=[e],t.replaceChildren(_a.content.cloneNode(!0))}attributeChangedCallback(t,e,r){"type"===t&&function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,Ta,"m",Aa).call(this)}};Ta=new WeakSet,Aa=function(){const{type:t,shadowRoot:e}=this;switch(t){case"spinner":e.replaceChildren(Ra.content.cloneNode(!0));break;case"bar":e.replaceChildren(_a.content.cloneNode(!0))}},(_a=ke("template")).content.append(ke("div",{attributes:{part:"bar"},children:[ke("div",{attributes:{part:"slider"},children:[ke("div",{attributes:{part:"cursor"}})]})]})),(Ra=ke("template")).content.append(ke("div",{attributes:{part:"spinner"}})),wa=`\n            :host {\n                display: inline-block;\n            }\n\n            :host(:is(:not([type]), [type="bar"])) {\n                border: 1px solid gainsboro;\n                border-radius: 4px;\n            }\n        \n            [part="bar"] {\n                position: relative;\n                overflow: hidden;\n                height: 6px;\n                width: 100%;\n                width: 86px;\n                border-radius: 4px;\n                background-color: whitesmoke;\n            }\n        \n            [part="slider"] {\n                display: flex;\n                position: absolute;\n                width: 100%;\n                height: 100%;\n                animation-name: slider;\n            }\n        \n            [part="slider"],\n            [part="cursor"] {\n                border-radius: 4px;\n                will-change: transform;\n                animation-duration: 1s;\n                animation-timing-function: linear;\n                animation-iteration-count: infinite;\n            }\n        \n            [part="cursor"] {\n                display: block;\n                width: 32px;\n                background-color: var(--theme-activated-item-color, ${Qe});\n                animation-name: cursor;\n            }\n        \n            :host([type="spinner"]) {\n                display: inline-block;\n                width: 20px;\n                height: 20px;\n            }\n        \n            [part="spinner"] {\n                display: inline-block;\n                width: 18px;\n                height: 18px;\n            }\n        \n            [part="spinner"]::after {\n                content: "";\n                display: block;\n                width: 12px;\n                height: 12px;\n                border-radius: 50%;\n                border-width: 4px;\n                border-style: solid;\n                border-color: transparent var(--theme-activated-item-color, ${Qe});\n                animation: spin 1.2s linear infinite;\n            }\n        \n            @keyframes slider {\n                0% {\n                    transform: translateX(0%);\n                }\n                100% {\n                    transform: translateX(100%);\n                }\n            }\n        \n            @keyframes cursor {\n                0% {\n                    transform: translateX(-100%);\n                }\n                100% {\n                    transform: translateX(100%);\n                }\n            }\n        \n            @keyframes spin {\n                0% {\n                    transform: rotate(0);\n                }\n                100% {\n                    transform: rotate(360deg);\n                }\n            }\n        `,ba([Fe({type:String,defaultValue:"bar",observed:!0})],va.prototype,"type",void 0),va=ba([Ue({name:"e-loader"})],va);var Ia,Na;let Sa=class extends HTMLElement{constructor(){super(),Ia.set(this,void 0);const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;e.replace(Na),t.adoptedStyleSheets=[e],function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?a.call(t,r):a?a.value=r:e.set(t,r)}(this,Ia,this.attachInternals(),"f"),(function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,Ia,"f")).role="separator"}};Ia=new WeakMap,Na="\n            :host {\n                display: block;\n                margin: 10px 0 10px 27px;\n                border: none;\n                border-top: 1px solid lightgrey;\n            }\n        ",Sa=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}([Ue({name:"e-separator"})],Sa);var xa,Ma,Ca,Pa,Oa,La,Ba,Fa,Ua,Da,ka,Ga,Va,Ha=function(t,e,r,n){var a,s=arguments.length,i=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(i=(s<3?a(i):s>3?a(e,r,i):a(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i},Xa=function(t,e,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(t,r):a?a.value=r:e.set(t,r),r},ja=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let Wa=class extends HTMLElement{constructor(){super(),xa.add(this),Ma.set(this,void 0),Ca.set(this,void 0),Pa.set(this,void 0),Oa.set(this,void 0);const t=this.attachShadow({mode:"open"}),e=new CSSStyleSheet;var r;e.replace(Va),t.adoptedStyleSheets=[e],t.append(Ga.content.cloneNode(!0)),Xa(this,Ma,null,"f"),Xa(this,Oa,null,"f"),Xa(this,Ca,(r=this,{handleEvent(t){const{type:e}=t;switch(e){case"mouseenter":ja(r,xa,"m",Ua).call(r);break;case"mouseleave":ja(r,xa,"m",Da).call(r)}}}),"f"),Xa(this,Pa,function(t){return{handleEvent(e){const{type:r}=e;"keydown"===r&&ja(t,xa,"m",ka).call(t,e)}}}(this),"f")}get target(){return ja(this,Ma,"f")}connectedCallback(){ja(this,xa,"m",La).call(this)}attributeChangedCallback(t,e,r){"for"===t&&ja(this,xa,"m",La).call(this)}show(t){const{immediate:e=!1}=t??{};let r=ja(this,Oa,"f");if(null!==r){const{id:t}=r;"hide"===t&&r.cancel()}if(this.visible)Xa(this,Oa,null,"f");else{this.hidden=!1,r=this.animate([{opacity:0},{opacity:1}],{id:"show",delay:e?0:200,duration:e?0:100});const{finished:t}=r;t.then((()=>{this.visible=!0})).catch((t=>{})),Xa(this,Oa,r,"f"),ja(this,xa,"m",Fa).call(this)}}hide(t){const{immediate:e=!1}=t??{};let r=ja(this,Oa,"f");if(null!==r){const{id:t}=r;"show"===t&&r.cancel()}if(this.visible){r=this.animate([{opacity:1},{opacity:0}],{id:"hide",delay:e?0:100,duration:e?0:100});const{finished:t}=r;t.then((()=>{this.visible=!1,this.hidden=!0})).catch((t=>{})),Xa(this,Oa,r,"f")}else Xa(this,Oa,null,"f")}};Ma=new WeakMap,Ca=new WeakMap,Pa=new WeakMap,Oa=new WeakMap,xa=new WeakSet,La=function(){const{htmlFor:t}=this;if(t){const e=this.getRootNode();if(e instanceof Document||e instanceof ShadowRoot){const r=e.getElementById(t);if(null!==r){const t=ja(this,Ma,"f"),e=ja(this,Ca,"f");t&&(t.removeEventListener("mouseenter",e),t.removeEventListener("mouseleave",e)),r.addEventListener("mouseenter",e),r.addEventListener("mouseleave",e)}Xa(this,Ma,r,"f")}}},Ba=function(){return this.shadowRoot.querySelector("[part=arrow]")},Fa=function(){const t=ja(this,Ma,"f");if(null!==t){const{top:e,bottom:r,left:n,right:a}=t.getBoundingClientRect(),{width:s,height:i}=this.getBoundingClientRect(),o=s/2,c=i/2,l=(a+n)/2,h=(r+e)/2,{position:u,style:d}=this,f=ja(this,xa,"m",Ba).call(this),{style:p}=f,{width:y,height:m}=f.getBoundingClientRect(),E=y/2,g=m/2,{clientWidth:T}=document.body;switch(u){case"top":d.setProperty("top",e-i-g+"px"),d.setProperty("left",`${Math.max(0,Math.min(l-o,T-s))}px`),p.setProperty("top",e-g+"px"),p.setProperty("left",`${l}px`);break;case"bottom":d.setProperty("top",`${r+g}px`),d.setProperty("left",`${Math.max(0,Math.min(l-o,T-s))}px`),p.setProperty("top",`${r+g}px`),p.setProperty("left",`${l}px`);break;case"left":d.setProperty("top",h-c+"px"),d.setProperty("left",n-s-E+"px"),p.setProperty("top",`${h}px`),p.setProperty("left",n-E+"px");break;case"right":d.setProperty("top",h-c+"px"),d.setProperty("left",`${a+E}px`),p.setProperty("top",`${h}px`),p.setProperty("left",`${a+E}px`)}}},Ua=function(){this.show();const t=ja(this,Oa,"f");if(t){const e=ja(this,Pa,"f"),{finished:r}=t;r.then((()=>{document.addEventListener("keydown",e)})).catch((t=>{}))}},Da=function(){this.hide();const t=ja(this,Oa,"f");if(t){const e=ja(this,Pa,"f"),{finished:r}=t;r.then((()=>{document.removeEventListener("keydown",e)})).catch((t=>{}))}},ka=function(t){const{key:e}=t;"Escape"===e&&this.hide({immediate:!0})},(Ga=ke("template")).content.append(ke("div",{attributes:{part:"container"},children:[ke("span",{attributes:{part:"arrow"}}),ke("slot")]})),Va='\n            :host {\n                position: fixed;\n                display: inline-block;\n                z-index: 1;\n                padding: 4px;\n                border-radius: 3px;\n                box-sizing: border-box;\n                background-color: white;\n                border: 1px solid black;\n                pointer-events: none;\n            }\n            \n            :host([hidden]) {\n                display: none;\n            }\n\n            :host(:not([visible])) {\n                opacity: 0;\n            }\n            \n            [part="arrow"] {\n                display: inline-block;\n                position: fixed;\n                z-index: 1;\n                width: 4px;\n                height: 4px;\n                box-sizing: border-box;\n                background-color: white;\n                border: 1px solid black;\n                border-width: 0 1px 1px 0;\n            }\n            \n            :host(:is(:not([position]), [position="top"])) [part="arrow"] {\n                transform: translate(-2px, -2px) rotate(45deg);\n            }\n            \n            :host(:is([position="bottom"])) [part="arrow"] {\n                transform: translate(-2px, -2px) rotate(225deg);\n            }\n            \n            :host(:is([position="left"])) [part="arrow"] {\n                transform: translate(-2px, -2px) rotate(315deg);\n            }\n            \n            :host(:is([position="right"])) [part="arrow"] {\n                transform: translate(-2px, -2px) rotate(135deg);\n            }        \n        ',Ha([Fe({type:String,observed:!0,name:"for"})],Wa.prototype,"htmlFor",void 0),Ha([Fe({type:String,defaultValue:"top"})],Wa.prototype,"position",void 0),Ha([Fe({type:Boolean})],Wa.prototype,"visible",void 0),Wa=Ha([Ue({name:"e-tooltip"})],Wa);const za=ke("e-menubar",{children:[ke("e-menuitem",{attributes:{type:"menu"},children:["File",ke("e-menu",{attributes:{slot:"menu"},children:[ke("e-menuitem",{attributes:{type:"button"},children:"Action 1"})]})]}),ke("e-menuitem",{attributes:{type:"menu"},children:["Help",ke("e-menu",{attributes:{slot:"menu"},children:[ke("e-menuitem",{attributes:{type:"button"},children:"About"})]})]})]}),Ya=ke("e-toolbar",{children:[ke("e-toolbaritem",{attributes:{id:"play-pause",type:"checkbox",name:"play-pause",iconed:!0}})]}),qa=[ke("e-tooltip",{attributes:{for:"play-pause"},children:"Play/pause rendering"})];async function $a(){document.body.prepend(za),za.after(Ya),document.body.append(...qa),Qt()}})(),main=n})();
//# sourceMappingURL=main.js.map