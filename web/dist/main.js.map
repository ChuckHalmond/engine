{"version":3,"file":"main.js","mappings":"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","sources":["webpack://main/webpack/bootstrap","webpack://main/webpack/runtime/define property getters","webpack://main/webpack/runtime/hasOwnProperty shorthand","webpack://main/webpack/runtime/make namespace object","webpack://main/./src/engine/libs/patterns/injectors/Injector.ts","webpack://main/./src/engine/libs/maths/MathError.ts","webpack://main/./src/engine/libs/maths/algebra/vectors/Vector2.ts","webpack://main/./src/engine/core/input/Input.ts","webpack://main/./src/engine/utils/Snippets.ts","webpack://main/./src/engine/libs/patterns/pools/Pool.ts","webpack://main/./src/engine/libs/patterns/pools/StackPool.ts","webpack://main/./src/engine/libs/maths/algebra/vectors/Vector3.ts","webpack://main/./src/engine/libs/maths/extensions/pools/Vector3Pools.ts","webpack://main/./src/engine/libs/maths/geometry/primitives/Triangle.ts","webpack://main/./src/engine/libs/maths/Snippets.ts","webpack://main/./src/engine/libs/maths/extensions/lists/TriangleList.ts","webpack://main/./src/engine/libs/maths/extensions/pools/Vector2Pools.ts","webpack://main/./src/engine/libs/maths/extensions/lists/Vector2List.ts","webpack://main/./src/engine/libs/maths/extensions/lists/Vector3List.ts","webpack://main/./src/engine/libs/maths/statistics/random/UUIDGenerator.ts","webpack://main/./src/engine/libs/physics/collisions/BoundingBox.ts","webpack://main/./src/engine/libs/physics/collisions/BoundingSphere.ts","webpack://main/./src/engine/libs/maths/extensions/pools/lists/TriangleListPools.ts","webpack://main/./src/engine/libs/maths/extensions/pools/lists/Vector3ListPools.ts","webpack://main/./src/engine/core/rendering/scenes/geometries/GeometryUtils.ts","webpack://main/./src/engine/core/rendering/scenes/geometries/Geometry.ts","webpack://main/./src/engine/core/rendering/scenes/geometries/lib/polyhedron/CubeGeometry.ts","webpack://main/./src/engine/core/rendering/scenes/geometries/lib/polyhedron/IcosahedronGeometry.ts","webpack://main/./src/engine/core/rendering/scenes/geometries/geometry.ts","webpack://main/./src/engine/core/rendering/scenes/geometries/lib/QuadGeometry.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLConstants.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLFramebufferUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLBufferUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLAttributeUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLVertexArrayUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLTextureUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLUniformUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLUniformBlockUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLDrawUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLPacketUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLShaderUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLProgramUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLRenderbuffersUtilities.ts","webpack://main/./src/engine/core/rendering/webgl/WebGLRendererUtilities.ts","webpack://main/./src/engine/libs/graphics/colors/Color.ts","webpack://main/./src/engine/libs/maths/algebra/matrices/Matrix4.ts","webpack://main/./src/engine/core/logger/Logger.ts","webpack://main/./src/engine/libs/patterns/messaging/brokers/SingleTopicMessageBroker.ts","webpack://main/./src/engine/resources/ResourceError.ts","webpack://main/./src/engine/resources/ResourceFetcher.ts","webpack://main/./src/engine/resources/Resources.ts","webpack://main/./src/samples/scenes/SimpleScene.ts","webpack://main/./main.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export { Injector };\r\nexport { InjectorBase };\r\nexport { Inject };\r\nexport { Register };\r\n\r\ninterface InjectorConstructor {\r\n    readonly prototype: Injector;\r\n    new<C extends Constructor<any>>(args: {defaultCtor: C, onDefaultOverride: (constructor: C) => void}): Injector<C>;\r\n}\r\n\r\ninterface Injector<C extends Constructor<any> = Constructor<any>> {\r\n    readonly defaultCtor: C;\r\n    overrideDefaultCtor(constructor: C): void;\r\n    forceQualifier(qualifier: string): void;\r\n    unforceQualifier(): void;\r\n    getConstructor(qualifier?: string): C;\r\n    inject(args?: { qualifier?: string, args?: ConstructorParameters<C> }): InstanceType<C>;\r\n    register(constructor: C, qualifier: string): void; \r\n}\r\n\r\nclass InjectorBase<C extends Constructor<any> = Constructor<any>> implements Injector<C> {\r\n    private _forcedQualifier?: string;\r\n    private _constructors: Map<string, C>;\r\n    private _defaultCtor: C;\r\n    private _onDefaultOverride: (constructor: C) => void;\r\n\r\n    public get defaultCtor(): C {\r\n        return this._defaultCtor;\r\n    }\r\n\r\n    public overrideDefaultCtor(constructor: C): void {\r\n        this._defaultCtor = constructor;\r\n        this._onDefaultOverride(constructor);\r\n    }\r\n\r\n    constructor(args: {defaultCtor: C, onDefaultOverride: (constructor: C) => void}) {\r\n        this._defaultCtor = args.defaultCtor;\r\n        this._onDefaultOverride = args.onDefaultOverride;\r\n        this._constructors = new Map();\r\n    }\r\n\r\n    public forceQualifier(qualifier: string): void {\r\n        this._forcedQualifier = qualifier;\r\n    }\r\n\r\n    public unforceQualifier(): void {\r\n        delete this._forcedQualifier;\r\n    }\r\n\r\n    public getConstructor(qualifier?: string): C {\r\n        const qualifierValue = this._forcedQualifier || qualifier;\r\n        if (typeof qualifierValue === 'undefined') {\r\n            return this._defaultCtor;\r\n        }\r\n        const constructor = this._constructors.get(qualifierValue);\r\n        if (typeof constructor === 'undefined') {\r\n            throw new Error(`No constructor for qualifier ${qualifierValue}`);\r\n        }\r\n        return constructor;\r\n    }\r\n\r\n    public inject(args?: { qualifier?: string, args?: ConstructorParameters<C> }): InstanceType<C> {\r\n        const constructor = this.getConstructor(args?.qualifier);\r\n        if (args?.args) {\r\n            const parameters = Array.from(args.args);\r\n            return new constructor(...parameters);\r\n        }\r\n        return new constructor();\r\n    }\r\n\r\n    public register(constructor: C, qualifier: string): void {\r\n        if (!this._constructors.has(qualifier)) {\r\n            this._constructors.set(qualifier, constructor);\r\n        }\r\n    }\r\n}\r\n\r\nconst Injector: InjectorConstructor = InjectorBase;\r\n\r\ntype UnwrappedInjectorConstructor<I> = I extends Injector<infer C> ? C : never;\r\n\r\ninterface RegisterDecorator {\r\n    <I extends Injector>(injector: I, qualifier?: string): <C extends UnwrappedInjectorConstructor<I>>(ctor: C) => C;\r\n}\r\n\r\nconst Register: RegisterDecorator = function<\r\n    I extends Injector\r\n>(injector: I, qualifier?: string): any {\r\n    return <C extends UnwrappedInjectorConstructor<I>>(\r\n        ctor: C\r\n    ) => {\r\n        if (typeof qualifier !== 'undefined') {\r\n            injector.register(ctor, qualifier);\r\n        }\r\n        injector.register(ctor, ctor.name);\r\n        return ctor;\r\n    }\r\n}\r\n\r\nfunction Inject<\r\n    I extends Injector,\r\n    P extends ConstructorParameters<UnwrappedInjectorConstructor<I>>,\r\n>(injector: I, options?: {qualifier?: string, args?: P}): any {\r\n    return (\r\n        target: any,\r\n        propertyKey: string\r\n    ) => {\r\n        const instance = injector.inject(options);\r\n\r\n        Object.defineProperty(target, propertyKey, {\r\n            value: instance\r\n        });\r\n    }\r\n}","export class MathError extends Error {\r\n    name = 'MathError';\r\n}","import { Injector } from \"../../../patterns/injectors/Injector\";\r\nimport { MathError } from \"../../MathError\";\r\n\r\nexport { Vector2Values };\r\nexport { Vector2Injector };\r\nexport { Vector2 };\r\nexport { Vector2Base };\r\n\r\ntype Vector2Values = [number, ...number[]] & { length: 2 };\r\n\r\ninterface Vector2Constructor {\r\n\treadonly prototype: Vector2;\r\n\tnew(): Vector2;\r\n\tnew(values: Vector2Values): Vector2;\r\n\tnew(values?: Vector2Values): Vector2;\r\n}\r\n\r\ninterface Vector2 {\r\n\treadonly array: ArrayLike<number>;\r\n\tvalues: Vector2Values;\r\n\tx: number;\r\n\ty: number;\r\n\tsetValues(v: Vector2Values): this;\r\n\tsetArray(array: WritableArrayLike<number>): this;\r\n\tcopy(vec: Vector2): this;\r\n\tclone(): this;\r\n\tequals(vec: Vector2): boolean;\r\n\tsetZeros(): this;\r\n\tadd(vec: Vector2): this;\r\n\taddScalar(k: number): this;\r\n\tsub(vec: Vector2): this;\r\n\tlerp(vec: Vector2, t: number): this;\r\n\tclamp(min: Vector2, max: Vector2): this;\r\n\tmultScalar(k: number): this;\r\n\tcross(vec: Vector2): number;\r\n\tdot(vec: Vector2): number;\r\n\tlen(): number;\r\n\tlenSq(): number;\r\n\tdist(vec: Vector2): number;\r\n\tdistSq(vec: Vector2): number;\r\n\tnormalize(): this;\r\n\tnegate(): this;\r\n\tmult(vec: Vector2): this;\r\n\taddScaled(vec: Vector2, k: number): this;\r\n\tcopyAndSub(vecA: Vector2, vecB: Vector2): this;\r\n\twriteIntoArray(out: WritableArrayLike<number>, offset?: number): void;\r\n    readFromArray(arr: ArrayLike<number>, offset?: number): this;\r\n}\r\n\r\nclass Vector2Base {\r\n\tprotected _array: WritableArrayLike<number>;\r\n\r\n\tconstructor()\r\n\tconstructor(values: Vector2Values)\r\n\tconstructor(values?: Vector2Values) {\r\n\t\tthis._array = (values) ? [\r\n\t\t\tvalues[0], values[1]\r\n\t\t] : [0, 0];\r\n\t}\r\n\r\n\tpublic get array(): ArrayLike<number> {\r\n\t\treturn this._array;\r\n\t}\r\n\r\n\tpublic get values(): Vector2Values {\r\n\t\treturn [\r\n\t\t\tthis._array[0],\r\n\t\t\tthis._array[1]\r\n\t\t];\r\n\t}\r\n\r\n\tpublic set values(values: Vector2Values) {\r\n\t\tthis._array[0] = values[0];\r\n\t\tthis._array[1] = values[1];\r\n\t}\r\n\r\n\tpublic get x() {\r\n\t\treturn this._array[0];\r\n\t}\r\n\r\n\tpublic set x(x: number) {\r\n\t\tthis._array[0] = x;\r\n\t}\r\n\r\n\tpublic get y() {\r\n\t\treturn this._array[1];\r\n\t}\r\n\r\n\tpublic set y(y: number) {\r\n\t\tthis._array[1] = y;\r\n\t}\r\n\r\n\tpublic setArray(array: WritableArrayLike<number>): this {\r\n\t\tif (array.length < 2) {\r\n\t\t\tthrow new MathError(`Array must be of length 2 at least.`);\r\n\t\t}\r\n\t\tthis._array = array;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic setValues(v: Vector2Values): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = v[0];\r\n\t\to[1] = v[1];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic equals(vec: Vector2Base): boolean {\r\n\t\tconst v = vec._array;\r\n\t\tconst o = this._array;\r\n\t\t\r\n\t\treturn v[0] === o[0]\r\n\t\t\t&& v[1] === o[1];\r\n\t}\r\n\r\n\tpublic copy(vec: Vector2Base): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec._array;\r\n\r\n\t\to[0] = v[0];\r\n\t\to[1] = v[1];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic clone(): this {\r\n\t\treturn new Vector2Base(this.values) as this;\r\n\t}\r\n\r\n\tpublic setZeros(): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = 0;\r\n\t\to[1] = 0;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic add(vec: Vector2Base): this {\r\n\t\tconst v = vec._array;\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] + v[0];\r\n\t\to[1] = o[1] + v[1];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic addScalar(k: number): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] + k;\r\n\t\to[1] = o[1] + k;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic sub(vec: Vector2Base): this {\r\n\t\tconst v = vec._array;\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] - v[0];\r\n\t\to[1] = o[1] - v[1];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic lerp(vec: Vector2Base, t: number): this {\r\n\t\tconst v = vec._array;\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = t * (v[0] - o[0]);\r\n\t\to[1] = t * (v[1] - o[1]);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic clamp(min: Vector2Base, max: Vector2Base): this {\r\n\t\tconst o = this._array;\r\n\t\tconst l = min._array;\r\n\t\tconst g = max._array;\r\n\r\n\t\to[0] = Math.min(g[0], Math.min(o[0], l[0])),\r\n\t\to[1] = Math.min(g[1], Math.min(o[1], l[1]))\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic multScalar(k: number): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] * k;\r\n\t\to[1] = o[1] * k;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic cross(vec: Vector2Base): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec._array;\r\n\r\n\t\treturn a[0] * b[1] - a[1] * b[0];\r\n\t}\r\n\r\n\tpublic dot(vec: Vector2Base): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec._array;\r\n\r\n\t\treturn (a[0] * b[0]) + (a[1] * b[1]);\r\n\t}\r\n\r\n\tpublic len(): number {\r\n\t\tconst v = this._array;\r\n\r\n\t\treturn Math.sqrt(v[0] * v[0] + v[1] * v[1]);\r\n\t}\r\n\r\n\tpublic lenSq(): number {\r\n\t\tconst v = this._array;\r\n\r\n\t\treturn v[0] * v[0] + v[1] * v[1];\r\n\t}\r\n\r\n\tpublic dist(vec: Vector2Base): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec._array;\r\n\r\n\t\tconst dx = a[0] - b[0];\r\n\t\tconst dy = a[1] - b[1];\r\n\r\n\t\treturn Math.sqrt(dx * dx + dy * dy);\r\n\t}\r\n\r\n\tpublic distSq(vec: Vector2Base): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec._array;\r\n\r\n\t\tconst dx = a[0] - b[0];\r\n\t\tconst dy = a[1] - b[1];\r\n\r\n\t\treturn dx * dx + dy * dy;\r\n\t}\r\n\r\n\tpublic normalize(): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\tconst lenSq = o[0] * o[0] + o[1] * o[1];\r\n\t\tconst len = Math.sqrt(lenSq);\r\n\t\tif (len > Number.EPSILON) {\r\n\t\t\to[0] = o[0] / len;\r\n\t\t\to[1] = o[1] / len;\r\n\t\t}\r\n\t\telse {\r\n\t\t\to[0] = 0;\r\n\t\t\to[1] = 0;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic negate(): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = -o[0];\r\n\t\to[1] = -o[1];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic mult(vec: Vector2Base): this {\r\n\t\tconst v = vec._array;\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] * v[0];\r\n\t\to[1] = o[1] * v[1];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic addScaled(vec: Vector2Base, k: number): this {\r\n\t\tconst v = vec._array;\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] + v[0] * k;\r\n\t\to[1] = o[1] + v[1] * k;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic writeIntoArray(out: WritableArrayLike<number>, offset: number = 0): void {\r\n\t\tconst v = this._array;\r\n\r\n\t\tout[offset    ] = v[0];\r\n\t\tout[offset + 1] = v[1];\r\n    }\r\n    \r\n    public readFromArray(arr: ArrayLike<number>, offset: number = 0): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = arr[offset    ];\r\n\t\to[1] = arr[offset + 1];\r\n\r\n\t\treturn this;\r\n    }\r\n\r\n\tpublic copyAndSub(vecA: Vector2Base, vecB: Vector2Base): this {\r\n\t\tconst o = this._array;\r\n\t\tconst a = vecA._array;\r\n\t\tconst b = vecB._array;\r\n\t\r\n\t\to[0] = a[0] - b[0];\r\n\t\to[1] = a[1] - b[1];\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nvar Vector2: Vector2Constructor = Vector2Base;\r\nconst Vector2Injector: Injector<Vector2Constructor> = new Injector({\r\n\tdefaultCtor: Vector2Base,\r\n\tonDefaultOverride:\r\n\t\t(ctor: Vector2Constructor) => {\r\n\t\t\tVector2 = ctor;\r\n\t\t}\r\n});","import { Vector2 } from \"../../libs/maths/algebra/vectors/Vector2\";\r\n\r\nexport { Key };\r\nexport { KeyModifier };\r\nexport { HotKey };\r\nexport { MouseButton };\r\nexport { Input };\r\n\r\nenum Key {\r\n    A = 'a',\r\n    B = 'b',\r\n    C = \"c\",\r\n    D = \"d\",\r\n    E = \"e\",\r\n    F = \"f\",\r\n    G = \"g\",\r\n    H = \"h\",\r\n    I = \"i\",\r\n    J = \"j\",\r\n    K = \"k\",\r\n    L = \"l\",\r\n    M = \"m\",\r\n    O = \"o\",\r\n    P = \"p\",\r\n    Q = \"q\",\r\n    R = \"r\",\r\n    S = \"s\",\r\n    T = \"t\",\r\n    U = \"u\",\r\n    V = \"v\",\r\n    W = \"w\",\r\n    X = \"x\",\r\n    Y = \"y\",\r\n    Z = \"z\",\r\n    ENTER = \"Enter\",\r\n    BACKSPACE = \"Backspace\",\r\n    ARROW_DOWN = \"ArrowDown\",\r\n    ARROW_LEFT = \"ArrowLeft\",\r\n    ARROW_RIGHT = \"ArrowRight\",\r\n    ARROW_UP = \"ArrowUp\",\r\n    SHIFT = \"Shift\"\r\n}\r\n\r\nenum KeyModifier {\r\n    Alt = \"Alt\",\r\n    Control = \"Control\",\r\n    Shift = \"Shift\",\r\n}\r\n\r\nfunction displayKeyModifier(mode: KeyModifier): string {\r\n    switch (mode) {\r\n        case KeyModifier.Control:\r\n            return \"Ctrl\";\r\n        default:\r\n            return mode;\r\n    }\r\n}\r\n\r\nenum MouseButton {\r\n    LEFT = 1,\r\n    WHEEL = 2,\r\n    RIGHT = 3,\r\n    FORWARD = 4,\r\n    BACK = 5\r\n}\r\n\r\nconst BUTTONS_MAP: Array<MouseButton> = [\r\n    MouseButton.LEFT, MouseButton.WHEEL, MouseButton.RIGHT, MouseButton.BACK, MouseButton.FORWARD\r\n];\r\n\r\nconst KEYS_INDICES = Object.values(Key).reduce(\r\n    (map, key, index) => {\r\n        map[key] = index;\r\n        return map;\r\n    },\r\n    {} as any\r\n);\r\n\r\nconst INPUT_EVENT: List<number> = {\r\n    \"DOWN\": 0,\r\n    \"REPEAT\": 1,\r\n    \"UP\": 2\r\n};\r\n\r\nconst testKeyModifier = (mod: KeyModifier, event: KeyboardEvent) => {\r\n    switch (mod) {\r\n        case 'Alt':\r\n            return event.altKey;\r\n        case 'Control':\r\n            return event.ctrlKey;\r\n        case 'Shift':\r\n            return event.shiftKey;\r\n        default:\r\n            return () => true;\r\n    }\r\n}\r\n\r\nclass HotKey {\r\n\r\n    public readonly key: Key;\r\n    public readonly mod1?: KeyModifier;\r\n    public readonly mod2?: KeyModifier;\r\n\r\n    constructor(key: Key, mod1?: KeyModifier, mod2?: KeyModifier) {\r\n        this.key = key;\r\n        this.mod1 = mod1;\r\n        this.mod2 = mod2;\r\n    }\r\n\r\n    public toString(): string {\r\n        return `${this.mod1 ? `${displayKeyModifier(this.mod1)}+` : ''}${this.mod2 ? `${displayKeyModifier(this.mod2)}+` : ''}${(this.key.length === 1) ? this.key.toUpperCase() : this.key}`;\r\n    }\r\n\r\n    /*public static fromString(str: string): HotKey | null {\r\n        const keys = Object.values(Key);\r\n        const keyModifiers = Object.values(KeyModifier);\r\n\r\n        let key: Key;\r\n        let mod1: KeyModifier | undefined;\r\n        let mod2: KeyModifier | undefined;\r\n\r\n        const keysStr = str.split(' + ');\r\n        if (keysStr.length >= 1) {\r\n            key = keysStr[0] as Key;\r\n            if (!keys.indexOf(key)) {\r\n                return null;\r\n            }\r\n            if (keysStr.length >= 2) {\r\n                mod1 = keysStr[1] as KeyModifier;\r\n                if (!keyModifiers.indexOf(mod1)) {\r\n                    return null;\r\n                }\r\n            }\r\n            if (keysStr.length >= 3) {\r\n                mod2 = keysStr[2] as KeyModifier;\r\n                if (!keyModifiers.indexOf(mod2)) {\r\n                    return null;\r\n                }\r\n            }\r\n            return new HotKey(key, mod1, mod2);\r\n        }\r\n        return null;\r\n    }*/\r\n\r\n    public test(event: KeyboardEvent): boolean {\r\n        return ((!this.mod1 || testKeyModifier(this.mod1, event)) && (!this.mod2 || testKeyModifier(this.mod2, event)) && event.key === this.key);\r\n    }\r\n}\r\n\r\nclass Input {\r\n    \r\n    private static readonly keysCount = Object.keys(Key).length;\r\n    private static readonly mouseButtonsCount = Object.keys(MouseButton).length;\r\n\r\n    private static readonly keyFlags = new Array<boolean>(Object.keys(INPUT_EVENT).length * Input.keysCount);\r\n    private static readonly mouseFlags = new Array<boolean>(Object.keys(INPUT_EVENT).length * Input.mouseButtonsCount);\r\n\r\n    private static readonly mousePos = new Vector2();\r\n    private static wheelDelta = 0;\r\n\r\n    public static clear() {\r\n        this.keyFlags.fill(false);\r\n\r\n        // Keeps the INPUT_EVENT.REPEAT section values\r\n        this.mouseFlags.fill(false, INPUT_EVENT.DOWN * this.mouseButtonsCount, INPUT_EVENT.REPEAT * this.mouseButtonsCount);\r\n        this.mouseFlags.fill(false, INPUT_EVENT.UP * this.mouseButtonsCount);\r\n\r\n        this.wheelDelta = 0;\r\n    }\r\n\r\n    private static initializePointerHandlers(element: HTMLElement) {\r\n        element.addEventListener('pointerdown', (event: MouseEvent) => {\r\n            this.mouseFlags[INPUT_EVENT.DOWN * this.mouseButtonsCount + BUTTONS_MAP[event.button]] = true;\r\n            this.mouseFlags[INPUT_EVENT.REPEAT * this.mouseButtonsCount + BUTTONS_MAP[event.button]] = true;\r\n            /*if (document.activeElement === element) {\r\n                event.preventDefault();\r\n            }*/\r\n        });\r\n\r\n        element.addEventListener('pointerup', (event: MouseEvent) => {\r\n            this.mouseFlags[INPUT_EVENT.REPEAT * this.mouseButtonsCount + BUTTONS_MAP[event.button]] = false;\r\n            this.mouseFlags[INPUT_EVENT.UP * this.mouseButtonsCount + BUTTONS_MAP[event.button]] = true;\r\n        });\r\n\r\n        element.addEventListener('contextmenu', (event: MouseEvent) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n        element.addEventListener('pointermove', (event: MouseEvent) => {\r\n            this.mousePos.setValues([(event.clientX / element.clientWidth) - 0.5, (event.clientY / element.clientHeight) - 0.5]);\r\n        });\r\n\r\n        element.addEventListener('wheel', (event: WheelEvent) => {\r\n            this.wheelDelta = Math.min(event.deltaY, 1000) / 1000;\r\n        }, {passive: true});\r\n    }\r\n\r\n    private static initializeKeyboardHandlers(element: HTMLElement) {\r\n        element.addEventListener('keydown', (event: KeyboardEvent) => {\r\n            this.keyFlags[(!event.repeat ? INPUT_EVENT.DOWN : INPUT_EVENT.REPEAT) * this.keysCount + KEYS_INDICES[event.key as Key]] = true;\r\n        });\r\n\r\n        element.addEventListener('keyup', (event: KeyboardEvent) => {\r\n            this.keyFlags[INPUT_EVENT.UP * this.keysCount + KEYS_INDICES[event.key as Key]] = true;\r\n            this.keyFlags[INPUT_EVENT.DOWN * this.keysCount + KEYS_INDICES[event.key as Key]] = false;\r\n            this.keyFlags[INPUT_EVENT.REPEAT * this.keysCount + KEYS_INDICES[event.key as Key]] = false;\r\n        });\r\n    }\r\n\r\n    public static initialize(elem: HTMLElement) {\r\n        this.initializePointerHandlers(elem);\r\n        this.initializeKeyboardHandlers(elem);\r\n    }\r\n\r\n    /*public static getAxis(axisName: string) {\r\n\r\n    }\r\n\r\n    public static getButton(buttonName: string) {\r\n\r\n    }\r\n\r\n    public static getButtonUp(buttonName: string) {\r\n\r\n    }\r\n\r\n    public static getButtonDown(buttonName: string) {\r\n\r\n    }*/\r\n\r\n    public static getKey(key: Key): boolean {\r\n        return this.keyFlags[INPUT_EVENT.REPEAT * this.keysCount + KEYS_INDICES[key]];\r\n    }\r\n\r\n    public static getKeyUp(key: Key): boolean {\r\n        return this.keyFlags[INPUT_EVENT.UP * this.keysCount + KEYS_INDICES[key]];\r\n    }\r\n\r\n    public static getKeyDown(key: Key): boolean {\r\n        return this.keyFlags[INPUT_EVENT.DOWN * this.keysCount + KEYS_INDICES[key]];\r\n    }\r\n\r\n    public static getMouseButton(button: MouseButton): boolean {\r\n        return this.mouseFlags[INPUT_EVENT.REPEAT * this.mouseButtonsCount + button];\r\n    }\r\n\r\n    public static getMouseButtonPosition(): Vector2 {\r\n        return this.mousePos;\r\n    }\r\n\r\n    public static getWheelDelta(): number {\r\n        return this.wheelDelta;\r\n    }\r\n\r\n    public static getMouseButtonDown(button: MouseButton): boolean {\r\n        return this.mouseFlags[INPUT_EVENT.DOWN * this.mouseButtonsCount + button];\r\n    }\r\n\r\n    public static getMouseButtonUp(button: MouseButton): boolean {\r\n        return this.mouseFlags[INPUT_EVENT.UP * this.mouseButtonsCount + button];\r\n    }\r\n}","export { isNotNull };\r\nexport { crashIfNull };\r\nexport { hasMemberOfPrototype };\r\nexport { isOfPrototype };\r\nexport { hasFunctionMember };\r\nexport { buildArrayFromIndexedArrays };\r\nexport { safeQuerySelector };\r\n\r\nfunction isNotNull<O extends any>(obj: O): obj is Exclude<O, null> {\r\n    return !(obj === null);\r\n}\r\n\r\nfunction crashIfNull<O extends any>(obj: O): Exclude<O, null> {\r\n    if (isNotNull(obj)) {\r\n        return obj;\r\n    }\r\n    throw new TypeError(`Argument is null.`);\r\n}\r\n\r\nfunction hasMemberOfPrototype<K extends string, P extends object>(obj: any, key: K, ctor: new(...args: any) => P): obj is { [key in K]: P } {\r\n    return !!obj && (obj[key]).constructor.prototype === ctor.prototype;\r\n}\r\n\r\nfunction isOfPrototype<P extends object>(obj: any, ctor: new(...args: any) => P): obj is P {\r\n    return obj.constructor.prototype === ctor.prototype;\r\n}\r\n\r\nfunction hasFunctionMember<K extends string>(obj: any, key: K): obj is { [key in K]: Function } {\r\n    return (typeof obj[key] === 'function');\r\n}\r\n\r\nfunction buildArrayFromIndexedArrays(arrays: number[][], indexes: ArrayLike<number>): number[] {\r\n    const len = indexes.length;\r\n    const array = [];\r\n    let i = -1;\r\n    while (++i < len) {\r\n        array.push(...arrays[indexes[i]]);\r\n    }\r\n    return array;\r\n}\r\n\r\nfunction safeQuerySelector<E extends Element>(parent: ParentNode, query: string): E {\r\n    const element = parent.querySelector(query);\r\n    if (isNotNull(element)) {\r\n        return element as E;\r\n    }\r\n    throw new Error(`Query '${query}' returned no result.`);\r\n}","export { PoolAutoExtendPolicy };\r\nexport { Pool };\r\nexport { PoolBase };\r\n\r\nenum PoolAutoExtendPolicy {\r\n    NO_AUTO_EXTEND,\r\n    AUTO_EXTEND_ONE,\r\n    AUTO_EXTEND_POW2\r\n}\r\n\r\ninterface Pool<O extends object = object> {\r\n    readonly ctor: Constructor<O>;\r\n    readonly autoExtendPolicy: PoolAutoExtendPolicy;\r\n    acquireTemp<N extends number>(n: N, func: SplittedTupleFunction<O, N, void>): void;\r\n    acquire(): O;\r\n    release(n: number): void;\r\n    extend(n: number): void;\r\n    clear(): void;\r\n    setAutoExtendPolicy(autoExtendPolicy: PoolAutoExtendPolicy): void;\r\n}\r\n\r\nabstract class PoolBase<O extends object = object> implements Pool<O> {\r\n    protected _ctor: Constructor<O>;\r\n    protected _autoExtendPolicy: PoolAutoExtendPolicy;\r\n    protected _autoExtendTicks: number;\r\n    protected _autoExtend: (() => void);\r\n\r\n    protected constructor(constructor: Constructor<O>, policy?: PoolAutoExtendPolicy) {\r\n        this._ctor = constructor;\r\n        this._autoExtendPolicy = policy || PoolAutoExtendPolicy.AUTO_EXTEND_ONE;\r\n        this._autoExtendTicks = 0;\r\n        this._autoExtend = this.getAutoExtendFunction(this._autoExtendPolicy);\r\n    }\r\n\r\n    public get ctor(): Constructor<O> {\r\n        return this._ctor;\r\n    }\r\n\r\n    public get autoExtendPolicy(): PoolAutoExtendPolicy {\r\n        return this._autoExtendPolicy;\r\n    }\r\n\r\n    public setAutoExtendPolicy(autoExtendPolicy: PoolAutoExtendPolicy): void {\r\n        this._autoExtendPolicy = autoExtendPolicy;\r\n        this._autoExtend = this.getAutoExtendFunction(this._autoExtendPolicy);\r\n    }\r\n\r\n    protected getAutoExtendFunction(autoExtdPolicy: PoolAutoExtendPolicy): () => void {\r\n        switch (autoExtdPolicy) {\r\n            case PoolAutoExtendPolicy.NO_AUTO_EXTEND:\r\n                return () => {\r\n                    this._autoExtendTicks++;\r\n                    return;\r\n                }\r\n            case PoolAutoExtendPolicy.AUTO_EXTEND_ONE:\r\n                return () => {\r\n                    this.extend(1);\r\n                    this._autoExtendTicks++;\r\n                }\r\n            case PoolAutoExtendPolicy.AUTO_EXTEND_POW2:\r\n                return () => {\r\n                    this.extend(Math.pow(2, this._autoExtendTicks));\r\n                    this._autoExtendTicks++;\r\n                }\r\n        }\r\n    }\r\n\r\n    public abstract acquireTemp<N extends number>(n: N, func: SplittedTupleFunction<O, N, void>): void;\r\n    public abstract acquire(): O;\r\n    public abstract release(n: number): void;\r\n    public abstract extend(n: number): void;\r\n    public abstract clear(): void;\r\n}","import { PoolAutoExtendPolicy, PoolBase, Pool } from \"./Pool\";\r\n\r\nexport { StackPool };\r\nexport { StackPoolBase };\r\n\r\ninterface StackPool<O extends object = object> extends Pool<O> {}\r\n\r\ninterface StackPoolConstructor {\r\n    readonly prototype: StackPool;\r\n    new<O extends object, C extends Constructor<O>>(constructor: C, options?: {args?: ConstructorParameters<C>, policy?: PoolAutoExtendPolicy, size?: number}): StackPool<O>;\r\n}\r\n\r\nclass StackPoolBase<O extends object = object> extends PoolBase<O> implements Pool<O> {\r\n    private _objects: Array<O>;\r\n    private _top: number;\r\n\r\n    constructor(constructor: Constructor<O>, options?: {args?: any, policy?: PoolAutoExtendPolicy, size?: number}) {\r\n        super(constructor, options?.policy);\r\n        this._objects = Array(options?.size || 0).fill(0).map(() => {\r\n            return new this.ctor(options?.args);\r\n        });\r\n        this._top = 0;\r\n    }\r\n    \r\n    public acquireTemp<N extends number>(n: N, func: (...args: O[]) => void): void {\r\n        const top = this._top;\r\n        const target = top + n;\r\n        const obj = this._objects;\r\n\r\n        while (obj.length < target) {\r\n            this._autoExtend();\r\n        }\r\n        this._top = target;\r\n        \r\n        switch (n) {\r\n            case 1:\r\n                func(obj[top]);\r\n                break;\r\n            case 2:\r\n                func(obj[top], obj[top + 1]);\r\n                break;\r\n            case 3:\r\n                func(obj[top], obj[top + 1], obj[top + 2]);\r\n                break;\r\n            case 4:\r\n                func(obj[top], obj[top + 1], obj[top + 2], obj[top + 3]);\r\n                break;\r\n            case 5:\r\n                func(obj[top], obj[top + 1], obj[top + 2], obj[top + 3], obj[top + 4]);\r\n                break;\r\n            case 6:\r\n                func(obj[top], obj[top + 1], obj[top + 2], obj[top + 3], obj[top + 4], obj[top + 5]);\r\n                break;\r\n            case 7:\r\n                func(obj[top], obj[top + 1], obj[top + 2], obj[top + 3], obj[top + 4], obj[top + 5], obj[top + 6]);\r\n                break;\r\n            case 8:\r\n                func(obj[top], obj[top + 1], obj[top + 2], obj[top + 3], obj[top + 4], obj[top + 5], obj[top + 6], obj[top + 7]);\r\n                break;\r\n            default:\r\n                func(...obj.slice(top, top + n));\r\n                break;\r\n        };\r\n\r\n        this._top = top;\r\n    }\r\n    \r\n    public acquire(): O {\r\n        if (this._top + 1 > this._objects.length) {\r\n            this._autoExtend();\r\n        }\r\n        \r\n        return this._objects[this._top++];\r\n    }\r\n    \r\n    public release(n: number): void {\r\n        const target = this._top - n;\r\n        if (target > 0) {\r\n            this._top = target;\r\n        }\r\n        else {\r\n            this._top = 0;\r\n        }\r\n    }\r\n\r\n    public extend(n: number): void {\r\n        this._objects.push(...Array(n).fill(0).map(() => {\r\n            return new this.ctor();\r\n        }));\r\n    }\r\n    \r\n    public clear(): void {\r\n        this._objects = [];\r\n        this._top = 0;\r\n        this._autoExtendTicks = 0;\r\n    }\r\n}\r\n\r\nconst StackPool: StackPoolConstructor = StackPoolBase;","import { Matrix3 } from \"engine/libs/maths/algebra/matrices/Matrix3\";\r\nimport { Injector } from \"../../../patterns/injectors/Injector\";\r\nimport { MathError } from \"../../MathError\";\r\n\r\nexport { Vector3Values };\r\nexport { Vector3Constructor };\r\nexport { Vector3 };\r\nexport { Vector3Base };\r\nexport { Vector3Injector };\r\n\r\ntype Vector3Values = [number, ...number[]] & { length: 3 };\r\n\r\ninterface Vector3Constructor {\r\n\treadonly prototype: Vector3;\r\n\tnew(): Vector3;\r\n\tnew(values: Vector3Values): Vector3;\r\n\tmult(mat: Matrix3, vec: Vector3): Vector3;\r\n}\r\n\r\ninterface Vector3 {\r\n\treadonly array: ArrayLike<number>;\r\n\tvalues: Vector3Values;\r\n\tx: number;\r\n\ty: number;\r\n\tz: number;\r\n\tsetArray(array: WritableArrayLike<number>): this;\r\n\tsetValues(v: Vector3Values): this;\r\n\tequals(vec: Vector3): boolean;\r\n\tcopy(vec: Vector3): this;\r\n\tclone(): this;\r\n\tsetZeros(): this;\r\n\tadd(vec: Vector3): this;\r\n\taddScalar(k: number): this;\r\n\tsub(vec: Vector3): this;\r\n\tlerp(vec: Vector3, t: number): this;\r\n\tmax(vecB: Vector3): this;\r\n\tmin(vecB: Vector3): this;\r\n\tclamp(min: Vector3, max: Vector3): this;\r\n\tmultScalar(k: number): this;\r\n\tcross(vec: Vector3): this;\r\n\tdot(vec: Vector3): number;\r\n\tlen(): number;\r\n\tlenSq(): number;\r\n\tdist(vec: Vector3): number;\r\n\tdistSq(vec: Vector3): number;\r\n\tnormalize(): this;\r\n\tnegate(): this;\r\n\tmult(vec: Vector3): this;\r\n\tmult(mat: Matrix3): this;\r\n\taddScaled(vec: Vector3, k: number): this;\r\n\tcopyAndSub(vecA: Vector3, vecB: Vector3): this;\r\n\tcopyAndCross(vecA: Vector3, vecB: Vector3): this;\r\n\twriteIntoArray(out: WritableArrayLike<number>, offset?: number): void;\r\n    readFromArray(arr: ArrayLike<number>, offset?: number): this;\r\n}\r\n\r\nclass Vector3Base {\r\n\tprotected _array: WritableArrayLike<number>;\r\n\r\n\tconstructor()\r\n\tconstructor(values: Vector3Values)\r\n\tconstructor(values?: Vector3Values) {\r\n\t\tthis._array = (values) ? [\r\n\t\t\tvalues[0], values[1], values[2]\r\n\t\t] : [0, 0, 0];\r\n\t}\r\n\r\n\tpublic get array(): ArrayLike<number> {\r\n\t\treturn this._array;\r\n\t}\r\n\r\n\tpublic get values(): Vector3Values {\r\n\t\treturn [\r\n\t\t\tthis._array[0],\r\n\t\t\tthis._array[1],\r\n\t\t\tthis._array[2]\r\n\t\t];\r\n\t}\r\n\r\n\tpublic set values(values: Vector3Values) {\r\n\t\tthis._array[0] = values[0];\r\n\t\tthis._array[1] = values[1];\r\n\t\tthis._array[2] = values[2];\r\n\t}\r\n\r\n\tpublic get x() {\r\n\t\treturn this._array[0];\r\n\t}\r\n\r\n\tpublic set x(x: number) {\r\n\t\tthis._array[0] = x;\r\n\t}\r\n\r\n\tpublic get y() {\r\n\t\treturn this._array[1];\r\n\t}\r\n\r\n\tpublic set y(y: number) {\r\n\t\tthis._array[1] = y;\r\n\t}\r\n\r\n\tpublic get z() {\r\n\t\treturn this._array[2];\r\n\t}\r\n\r\n\tpublic set z(z: number) {\r\n\t\tthis._array[2] = z;\r\n\t}\r\n\r\n\tpublic setArray(array: WritableArrayLike<number>): this {\r\n\t\tif (array.length < 3) {\r\n\t\t\tthrow new MathError(`Array must be of length 3 at least.`);\r\n\t\t}\r\n\t\tthis._array = array;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic setValues(v: Vector3Values): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = v[0];\r\n\t\to[1] = v[1];\r\n\t\to[2] = v[2];\r\n\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tpublic copy(vec: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\r\n\t\to[0] = v[0];\r\n\t\to[1] = v[1];\r\n\t\to[2] = v[2];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic clone(): this {\r\n\t\treturn new Vector3Base(this.values) as this;\r\n\t}\r\n\r\n\tpublic equals(vec: Vector3): boolean {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\t\t\r\n\t\treturn v[0] === o[0]\r\n\t\t\t&& v[1] === o[1]\r\n\t\t\t&& v[2] === o[2];\r\n\t}\r\n\r\n\tpublic setZeros(): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = 0;\r\n\t\to[1] = 0;\r\n\t\to[2] = 0;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic add(vec: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\r\n\t\to[0] = o[0] + v[0];\r\n\t\to[1] = o[1] + v[1];\r\n\t\to[2] = o[2] + v[2];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic addScalar(k: number): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] + k;\r\n\t\to[1] = o[1] + k;\r\n\t\to[2] = o[2] + k;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic sub(vec: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\r\n\t\to[0] = o[0] - v[0];\r\n\t\to[1] = o[1] - v[1];\r\n\t\to[2] = o[2] - v[2];\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic lerp(vec: Vector3, t: number): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\r\n\t\to[0] = t * (v[0] - o[0]);\r\n\t\to[1] = t * (v[1] - o[1]);\r\n\t\to[2] = t * (v[2] - o[2]);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic max(vecB: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst b = vecB.array;\r\n\t\t\r\n\t\to[0] = Math.max(o[0], b[0]);\r\n\t\to[1] = Math.max(o[1], b[1]);\r\n\t\to[2] = Math.max(o[2], b[2]);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic min(vecB: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst b = vecB.array;\r\n\r\n\t\to[0] = Math.min(o[0], b[0]);\r\n\t\to[1] = Math.min(o[1], b[1]);\r\n\t\to[2] = Math.min(o[2], b[2]);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic clamp(min: Vector3, max: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst l = min.array;\r\n\t\tconst g = max.array;\r\n\r\n\t\to[0] = Math.min(g[0], Math.max(o[0], l[0]));\r\n\t\to[1] = Math.min(g[1], Math.max(o[1], l[1]));\r\n\t\to[2] = Math.min(g[2], Math.max(o[2], l[2]));\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic multScalar(k: number): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = o[0] * k;\r\n\t\to[1] = o[1] * k;\r\n\t\to[2] = o[2] * k;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic cross(vec: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\t\t\r\n\t\tconst t0 = o[1] * v[2] - o[2] * v[1];\r\n\t\tconst t1 = o[2] * v[0] - o[0] * v[2];\r\n\t\tconst t2 = o[0] * v[1] - o[1] * v[0];\r\n\t\t\r\n\t\to[0] = t0;\r\n\t\to[1] = t1;\r\n\t\to[2] = t2;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic dot(vec: Vector3): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec.array;\r\n\r\n\t\treturn (a[0] * b[0]) + (a[1] * b[1]) + (a[2] * b[2]);\r\n\t}\r\n\r\n\tpublic len(): number {\r\n\t\tconst a = this._array;\r\n\r\n\t\treturn Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2]);\r\n\t}\r\n\r\n\tpublic lenSq(): number {\r\n\t\tconst a = this._array;\r\n\r\n\t\treturn a[0] * a[0] + a[1] * a[1] + a[2] * a[2];\r\n\t}\r\n\r\n\tpublic dist(vec: Vector3): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec.array;\r\n\r\n\t\tconst dx = a[0] - b[0];\r\n\t\tconst dy = a[1] - b[1];\r\n\t\tconst dz = a[2] - b[2];\r\n\r\n\t\treturn Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n\t}\r\n\r\n\tpublic distSq(vec: Vector3): number {\r\n\t\tconst a = this._array;\r\n\t\tconst b = vec.array;\r\n\r\n\t\tconst dx = a[0] - b[0];\r\n\t\tconst dy = a[1] - b[1];\r\n\t\tconst dz = a[2] - b[2];\r\n\r\n\t\treturn dx * dx + dy * dy + dz * dz;\r\n\t}\r\n\r\n\tpublic normalize(): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\tconst len = this.len();\r\n\t\tif (len > Number.EPSILON) {\r\n\t\t\to[0] = o[0] / len;\r\n\t\t\to[1] = o[1] / len;\r\n\t\t\to[2] = o[2] / len;\r\n\t\t}\r\n\t\telse {\r\n\t\t\to[0] = 0;\r\n\t\t\to[1] = 0;\r\n\t\t\to[2] = 0;\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic negate(): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = -o[0];\r\n\t\to[1] = -o[1];\r\n\t\to[2] = -o[2];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic mult(mat: Matrix3): this\r\n\tpublic mult(vec: Vector3): this\r\n\tpublic mult(arg0: Matrix3 | Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tif (arg0 instanceof Vector3) {\r\n\t\t\tconst v = arg0.array;\r\n\r\n\t\t\to[0] = o[0] * v[0];\r\n\t\t\to[1] = o[1] * v[1];\r\n\t\t\to[2] = o[2] * v[2];\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst x = this.x;\r\n\t\t\tconst y = this.y;\r\n\t\t\tconst z = this.z;\r\n\r\n\t\t\tconst m = arg0.array;\r\n\r\n\t\t\tthis.x = x * m[0] + y * m[3] + z * m[6];\r\n\t\t\tthis.y = x * m[1] + y * m[4] + z * m[7];\r\n\t\t\tthis.z = x * m[2] + y * m[5] + z * m[8];\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static mult(mat: Matrix3, vec: Vector3): Vector3 {\r\n\t\tconst m = mat.array;\r\n\t\tconst v = vec.array;\r\n\r\n\t\treturn new Vector3Base([\r\n\t\t\tm[0] * v[0] + m[1] * v[1] + m[2] * v[2],\r\n\t\t\tm[3] * v[0] + m[4] * v[1] + m[5] * v[2],\r\n\t\t\tm[6] * v[0] + m[7] * v[1] + m[8] * v[2]\r\n\t\t]);\r\n\t}\r\n\r\n\tpublic writeIntoArray(out: WritableArrayLike<number>, offset: number = 0): void {\r\n\t\tconst v = this._array;\r\n\r\n\t\tout[offset    ] = v[0];\r\n\t\tout[offset + 1] = v[1];\r\n\t\tout[offset + 2] = v[2];\r\n    }\r\n    \r\n    public readFromArray(arr: ArrayLike<number>, offset: number = 0): this {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = arr[offset    ];\r\n\t\to[1] = arr[offset + 1];\r\n\t\to[2] = arr[offset + 2];\r\n\r\n\t\treturn this;\r\n    }\r\n\r\n\tpublic addScaled(vec: Vector3, k: number): this {\r\n\t\tconst o = this._array;\r\n\t\tconst v = vec.array;\r\n\r\n\t\to[0] = o[0] + v[0] * k;\r\n\t\to[1] = o[1] + v[1] * k;\r\n\t\to[2] = o[2] + v[2] * k;\r\n\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tpublic copyAndSub(vecA: Vector3, vecB: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst a = vecA.array;\r\n\t\tconst b = vecB.array;\r\n\t\r\n\t\to[0] = a[0] - b[0];\r\n\t\to[1] = a[1] - b[1];\r\n\t\to[2] = a[2] - b[2];\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic copyAndCross(vecA: Vector3, vecB: Vector3): this {\r\n\t\tconst o = this._array;\r\n\t\tconst a = vecA.array;\r\n\t\tconst b = vecB.array;\r\n\t\t\r\n\t\tconst t0 = a[1] * b[2] - a[2] * b[1];\r\n\t\tconst t1 = a[2] * b[0] - a[0] * b[2];\r\n\t\tconst t2 = a[0] * b[1] - a[1] * b[0];\r\n\r\n\t\to[0] = t0;\r\n\t\to[1] = t1;\r\n\t\to[2] = t2;\r\n\t\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nvar Vector3: Vector3Constructor = Vector3Base;\r\n\r\nconst Vector3Injector: Injector<Vector3Constructor> = new Injector({\r\n\tdefaultCtor: Vector3Base,\r\n\tonDefaultOverride:\r\n\t\t(ctor: Vector3Constructor) => {\r\n\t\t\tVector3 = ctor;\r\n\t\t}\r\n});","import { StackPool } from \"../../../patterns/pools/StackPool\";\r\nimport { Vector3, Vector3Base } from \"../../algebra/vectors/Vector3\";\r\n\r\nexport { Vector3Pool };\r\n\r\nconst Vector3Pool: StackPool<Vector3> = new StackPool(Vector3Base);","import { Injector } from \"../../../patterns/injectors/Injector\";\r\nimport { StackPool } from \"../../../patterns/pools/StackPool\";\r\nimport { Matrix4 } from \"../../algebra/matrices/Matrix4\";\r\nimport { Vector2 } from \"../../algebra/vectors/Vector2\";\r\nimport { Vector3 } from \"../../algebra/vectors/Vector3\";\r\nimport { Vector3Pool } from \"../../extensions/pools/Vector3Pools\";\r\nimport { Plane } from \"./Plane\";\r\n\r\n//  p1\r\n//  |\\\r\n//  | \\\r\n//  |  \\\r\n//  |   \\\r\n//  |    \\\r\n//  p3----p2\r\n\r\nexport { TriangleValues };\r\nexport { Triangle };\r\nexport { TriangleInjector }\r\nexport { TriangleBase };\r\nexport { TrianglePool };\r\n\r\ntype TriangleValues = Tuple<number, 9>;\r\n\r\ninterface Triangle {\r\n\treadonly point1: Vector3;\r\n    readonly point2: Vector3;\r\n\treadonly point3: Vector3;\r\n\r\n\tset(point1: Vector3, point2: Vector3, point3: Vector3): Triangle;\r\n\tgetValues(): TriangleValues;\r\n    setValues(values: TriangleValues): Triangle;\r\n    clone(): Triangle;\r\n    copy(triangle: Triangle): Triangle;\r\n    getNormal(out: Vector3): Vector3;\r\n\tgetBarycentricCoordinates(point: Vector3, out: Vector3): Vector3;\r\n\tsharedPointsWith(triangle: Triangle): IterableIterator<Vector3>;\r\n\tindexOfPoint(point: Vector3): number;\r\n\tcontainsPoint(point: Vector3): boolean;\r\n\tgetUV(point: Vector3, uv1: Vector2, uv2: Vector2, uv3: Vector2, out: Vector2): Vector2;\r\n\tisFrontFacing(direction: Vector3): boolean;\r\n\tgetArea(): number;\r\n\tgetMidpoint(out: Vector3): Vector3;\r\n\tgetPlane(out: Plane): Plane;\r\n\tclosestPointToPoint(point: Vector3, out: Vector3): Vector3;\r\n\tequals(triangle: Triangle): boolean;\r\n    translate(vec: Vector3): void;\r\n    transform(mat: Matrix4): void;\r\n\ttoString(): string;\r\n\treadFromArray(arr: ArrayLike<number>, offset: number): Triangle;\r\n\twriteIntoArray(arr: WritableArrayLike<number>, offset: number): void;\r\n}\r\n\r\ninterface TriangleConstructor {\r\n\treadonly prototype: Triangle;\r\n\tnew(): Triangle;\r\n\tnew(point1: Vector3, point2: Vector3, point3: Vector3): Triangle;\r\n\tnew(point1?: Vector3, point2?: Vector3, point3?: Vector3): Triangle;\r\n}\r\n\r\nclass TriangleBase implements Triangle {\r\n\r\n\tprivate _point1: Vector3;\r\n\tprivate _point2: Vector3;\r\n\tprivate _point3: Vector3;\r\n\r\n\tconstructor()\r\n\tconstructor(point1: Vector3, point2: Vector3, point3: Vector3)\r\n\tconstructor(point1?: Vector3, point2?: Vector3, point3?: Vector3) {\r\n\t\tthis._point1 = point1 || new Vector3();\r\n\t\tthis._point2 = point2 || new Vector3();\r\n\t\tthis._point3 = point3 || new Vector3();\r\n\t}\r\n\r\n\tpublic get point1(): Vector3 {\r\n\t\treturn this._point1;\r\n\t}\r\n\r\n\tpublic set point1(point1: Vector3) {\r\n\t\tthis._point1 = point1;\r\n\t}\r\n\r\n\tpublic get point2(): Vector3 {\r\n\t\treturn this._point2;\r\n\t}\r\n\r\n\tpublic set point2(point2: Vector3) {\r\n\t\tthis._point2 = point2;\r\n\t}\r\n\r\n\tpublic get point3(): Vector3 {\r\n\t\treturn this._point3;\r\n\t}\r\n\r\n\tpublic set point3(point3: Vector3) {\r\n\t\tthis._point3 = point3;\r\n\t}\r\n\r\n\tpublic getValues(): TriangleValues {\r\n\t\tconst point1 = this._point1,\r\n\t\t\tpoint2 = this._point2,\r\n\t\t\tpoint3 = this._point3;\r\n\t\t\r\n\t\treturn [\r\n\t\t\tpoint1.x, point1.y, point1.z,\r\n\t\t\tpoint2.x, point2.y, point2.z,\r\n\t\t\tpoint3.x, point3.y, point3.z\r\n\t\t];\r\n\t}\r\n\r\n    public set(point1: Vector3, point2: Vector3, point3: Vector3): TriangleBase {\r\n        this._point1.copy(point1);\r\n        this._point2.copy(point2);\r\n\t\tthis._point3.copy(point3);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n    public setValues(values: TriangleValues): TriangleBase {\r\n\t\t\r\n        this._point1.setValues([values[0], values[1], values[2]]);\r\n        this._point2.setValues([values[3], values[4], values[5]]);\r\n\t\tthis._point3.setValues([values[6], values[7], values[8]]);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n    public clone(): TriangleBase {\r\n        return new TriangleBase().copy(this);\r\n    }\r\n\r\n    public copy(triangle: TriangleBase): TriangleBase {\r\n        this._point1 = triangle._point1;\r\n        this._point2 = triangle._point2;\r\n        this._point3 = triangle._point3;\r\n        \r\n        return this;\r\n    }\r\n\r\n    public getNormal(out: Vector3): Vector3  {\r\n\t\tVector3Pool.acquireTemp(1, (temp) => {\r\n\t\t\tout.copyAndSub(this._point2, this.point1);\r\n\t\t\ttemp.copyAndSub(this._point3, this.point1);\r\n\t\t\tout.cross(temp).normalize();\r\n\t\t});\r\n\t\t\r\n        return out;\r\n\t}\r\n\r\n\tpublic getBarycentricCoordinates(point: Vector3, out: Vector3): Vector3 {\r\n\t\tVector3Pool.acquireTemp(3, (v1, v2, vp) => {\r\n\t\t\tv1.copyAndSub(this._point2, this._point1),\r\n\t\t\tv2.copyAndSub(this._point3, this._point1),\r\n\t\t\tvp.copyAndSub(point, this._point1);\r\n\r\n\t\t\tconst dotxx = v1.dot(v1);\r\n\t\t\tconst dotxy = v1.dot(v2);\r\n\t\t\tconst dotxz = v1.dot(vp);\r\n\t\t\tconst dotyy = v2.dot(v2);\r\n\t\t\tconst dotyz = v2.dot(vp);\r\n\r\n\t\t\tconst denom = (dotxx * dotyy - dotxy * dotxy);\r\n\t\t\tif (denom === 0) {\r\n\t\t\t\t// TODO: Handle ?\r\n\t\t\t\tout.setValues([-2, -1, -1]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst invDenom = 1 / denom;\r\n\t\t\tconst u = (dotyy * dotxz - dotxy * dotyz) * invDenom;\r\n\t\t\tconst v = (dotxx * dotyz - dotxy * dotxz) * invDenom;\r\n\r\n\t\t\tout.setValues([1 - u - v, v, u]);\r\n\t\t});\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tpublic *sharedPointsWith(triangle: TriangleBase): IterableIterator<Vector3> {\r\n\t\tif (this._point1.equals(triangle._point1) || this._point1.equals(triangle._point2) || this._point1.equals(triangle._point3)) yield this._point1;\r\n\t\tif (this._point2.equals(triangle._point1) || this._point2.equals(triangle._point2) || this._point2.equals(triangle._point3)) yield this._point2;\r\n\t\tif (this._point3.equals(triangle._point1) || this._point3.equals(triangle._point2) || this._point3.equals(triangle._point3)) yield this._point3;\r\n\t}\r\n\r\n\tpublic indexOfPoint(point: Vector3): number {\r\n\t\treturn (point.equals(this._point1)) ? 0 :\r\n\t\t\t(point.equals(this._point2)) ? 1 :\r\n\t\t\t(point.equals(this._point3)) ? 2 : -1;\r\n\t}\r\n\r\n\tpublic containsPoint(point: Vector3): boolean {\r\n\r\n\t\tlet contains = false;\r\n\t\tVector3Pool.acquireTemp(1, (pointCoords) => {\r\n\t\t\tthis.getBarycentricCoordinates(point, pointCoords);\r\n\t\t\tcontains = (pointCoords.x >= 0) && (pointCoords.y >= 0) && ((pointCoords.x + pointCoords.y) <= 1);\r\n\t\t});\r\n        \r\n\t\treturn contains;\r\n\t}\r\n\r\n\tpublic getUV(point: Vector3, uv1: Vector2, uv2: Vector2, uv3: Vector2, out: Vector2): Vector2 {\r\n\t\tVector3Pool.acquireTemp(1, (pointCoords) => {\r\n\t\t\tthis.getBarycentricCoordinates(point, pointCoords);\r\n\r\n\t\t\tout.setZeros();\r\n\t\t\tout.addScaled(uv1, pointCoords.x);\r\n\t\t\tout.addScaled(uv2, pointCoords.y);\r\n\t\t\tout.addScaled(uv3, pointCoords.z);\r\n\t\t});\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tpublic isFrontFacing(direction: Vector3): boolean {\r\n\t\tlet result = false;\r\n\r\n\t\tVector3Pool.acquireTemp(2, (v1, v2) => {\r\n\t\t\tv1.copyAndSub(this._point2, this._point1),\r\n\t\t\tv2.copyAndSub(this._point3, this._point1);\r\n\t\t\tresult = (v1.cross(v2).dot(direction) < 0);\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic getArea(): number {\r\n\t\tlet area = 0;\r\n\t\t\r\n\t\tVector3Pool.acquireTemp(2, (v1, v2) => {\r\n\t\t\tv1.copyAndSub(this._point2, this._point1),\r\n\t\t\tv2.copyAndSub(this._point3, this._point1);\r\n\t\t\tarea = v1.cross(v2).len() * 0.5;\r\n\t\t});\r\n\r\n\t\treturn area;\r\n\t}\r\n\r\n\tpublic getMidpoint(out: Vector3): Vector3 {\r\n\t\treturn out.copy(this._point1).add(this._point2).add(this._point3).multScalar(1 / 3);\r\n\t}\r\n\r\n\tpublic getPlane(out: Plane): Plane {\r\n\t\tthrow Error('Not implemented yet.');\r\n\t}\r\n\r\n\tpublic closestPointToPoint(point: Vector3, out: Vector3): Vector3 {\r\n        const point1 = this._point1,\r\n            point2 = this._point2,\r\n            point3 = this._point3;\r\n\r\n        let v, w;\r\n\t\t\r\n\t\tVector3Pool.acquireTemp(4, (vb, vc, vp, vbp) => {\r\n\t\t\tvb.copyAndSub(point2, point1),\r\n\t\t\tvc.copyAndSub(point3, point1),\r\n\t\t\tvp.copyAndSub(point, point1);\r\n\r\n\t\t\tconst d1 = vb.dot(vp);\r\n\t\t\tconst d2 = vc.dot(vp);\r\n\t\t\t\r\n\t\t\tif (d1 <= 0 && d2 <= 0) {\r\n\t\t\t\treturn out.copy(point1);\r\n\t\t\t}\r\n\r\n\t\t\tvbp.copyAndSub(point, point2);\r\n\t\t\t\r\n\t\t\tconst d3 = point1.dot(vbp);\r\n\t\t\tconst d4 = vc.dot(vbp);\r\n\t\t\t\r\n\t\t\tif (d3 >= 0 && d4 <= d3) {\r\n\t\t\t\treturn out.copy(point2);\r\n\t\t\t}\r\n\r\n\t\t\tconst dc = d1 * d4 - d3 * d2;\r\n\t\t\tif (dc <= 0 && d1 >= 0 && d3 <= 0) {\r\n\t\t\t\tv = d1 / ( d1 - d3 );\r\n\t\t\t\treturn out.copy(point1).addScaled(vb, v);\r\n\t\t\t}\r\n\r\n\t\t\tvp.copyAndSub(point, point3);\r\n\t\t\tconst d5 = vb.dot(vp);\r\n\t\t\tconst d6 = vc.dot(vp);\r\n\t\t\tif (d6 >= 0 && d5 <= d6) {\r\n\t\t\t\treturn out.copy(point3);\r\n\t\t\t}\r\n\r\n\t\t\tconst db = d5 * d2 - d1 * d6;\r\n\t\t\tif (db <= 0 && d2 >= 0 && d6 <= 0) {\r\n\t\t\t\tw = d2 / (d2 - d6);\r\n\t\t\t\treturn out.copy(point1).addScaled(vc, w);\r\n\t\t\t}\r\n\r\n\t\t\tconst da = d3 * d6 - d5 * d4;\r\n\t\t\tif (da <= 0 && (d4 - d3) >= 0 && (d5 - d6) >= 0) {\r\n\t\t\t\tvc.copyAndSub(point3, point2);\r\n\t\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\r\n\t\t\t\treturn out.copy(point2).addScaled(vc, w);\r\n\t\t\t}\r\n\r\n\t\t\tconst denom = 1 / (da + db + dc );\r\n\t\t\tv = db * denom;\r\n\t\t\tw = dc * denom;\r\n\t\t\t\r\n\t\t\tout.copy(point1).addScaled(vb, v).addScaled(vc, w);\r\n\t\t});\r\n\r\n\t\treturn out;\r\n\t}\r\n\t\r\n\tpublic equals(triangle: TriangleBase): boolean {\r\n        return triangle._point1.equals(this._point1)\r\n            && triangle._point2.equals(this._point2)\r\n            && triangle._point3.equals(this._point3);\r\n\t}\r\n\r\n    public translate(vec: Vector3): void {\r\n        this._point1.add(vec);\r\n        this._point2.add(vec);\r\n        this._point3.add(vec);\r\n    }\r\n\r\n    public transform(mat: Matrix4): void {\r\n        this._point1.setValues(mat.transformDirection(this._point1));\r\n        this._point2.setValues(mat.transformDirection(this._point2));\r\n        this._point3.setValues(mat.transformDirection(this._point3));\r\n\t}\r\n\r\n\tpublic readFromArray(arr: ArrayLike<number>, offset: number): TriangleBase {\r\n\t\tthis.point1.readFromArray(arr, offset);\r\n\t\tthis.point2.readFromArray(arr, offset + 3);\r\n\t\tthis.point3.readFromArray(arr, offset + 6);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic writeIntoArray(arr: WritableArrayLike<number>, offset: number): void {\r\n\t\tthis.point1.writeIntoArray(arr, offset);\r\n\t\tthis.point2.writeIntoArray(arr, offset + 3);\r\n\t\tthis.point3.writeIntoArray(arr, offset + 6);\r\n\t}\r\n}\r\n\r\nvar Triangle: TriangleConstructor = TriangleBase;\r\nconst TriangleInjector: Injector<TriangleConstructor> = new Injector({\r\n\tdefaultCtor: TriangleBase,\r\n\tonDefaultOverride:\r\n\t\t(ctor: TriangleConstructor) => {\r\n\t\t\tTriangle = ctor;\r\n\t\t}\r\n});\r\nconst TrianglePool: StackPool<Triangle> = new StackPool(TriangleBase);","\r\nexport { deg2Rad };\r\nexport { rad2Deg };\r\nexport { qSqrt };\r\nexport { pow2 };\r\nexport { inRange };\r\nexport { clamp };\r\nexport { lerp };\r\nexport { smoothstep };\r\nexport { smootherstep };\r\nexport { randInt };\r\nexport { randFloat };\r\nexport { randFloatSpread };\r\nexport { degToRad };\r\nexport { radToDeg };\r\nexport { isPowerOfTwo };\r\nexport { ceilPowerOfTwo };\r\nexport { floorPowerOfTwo };\r\n\r\nconst DEG2RAD = Math.PI / 180;\r\nconst RAD2DEG = 180 / Math.PI;\r\n\r\nconst deg2Rad = function(deg: number): number {\r\n\treturn DEG2RAD * deg;\r\n}\r\n\r\nconst rad2Deg = function(rad: number): number {\r\n\treturn RAD2DEG / rad;\r\n}\r\n\r\nconst _bytes = new ArrayBuffer(Float32Array.BYTES_PER_ELEMENT);\r\nconst _floatView = new Float32Array(_bytes);\r\nconst _intView = new Uint32Array(_bytes);\r\n\r\nconst qSqrt = function(x: number) {\r\n\tconst halfx = x * 0.5;\r\n\r\n\t_floatView[0] = x;\r\n\t_intView[0] = 0x5f3759df -(_intView[0] >> 1);\r\n\r\n\tlet y = _floatView[0];\r\n\ty = y * (1.5 - (halfx * y * y));\r\n\r\n\treturn y;\r\n}\r\n\r\nconst pow2 = function(k: number): number {\r\n\treturn 1 << k;\r\n}\r\n\t\r\nconst inRange = function(x: number, min: number, max: number): boolean {\r\n\treturn (min <= x) && (x <= max);\r\n}\r\n\r\nconst clamp = function(value: number, min: number, max: number): number {\r\n\treturn Math.max(min, Math.min(max, value));\r\n}\r\n\r\nconst lerp = function(x: number, y: number, t: number): number {\r\n\treturn (1 - t) * x + t * y;\r\n}\r\n\r\nconst smoothstep = function(x: number, min: number, max: number): number {\r\n\tif (x <= min) return 0;\r\n\tif (x >= max) return 1;\r\n\r\n\tx = (x - min) / (max - min);\r\n\r\n\treturn x * x * (3 - 2 * x);\r\n}\r\n\r\nconst smootherstep = function(x: number, min: number, max: number): number {\r\n\tif (x <= min) return 0;\r\n\tif (x >= max) return 1;\r\n\r\n\tx = (x - min) / (max - min);\r\n\r\n\treturn x * x * x * ( x * ( x * 6 - 15) + 10);\r\n}\r\n\r\nconst randInt = function(low: number, high: number): number {\r\n\treturn low + Math.floor(Math.random() * (high - low + 1));\r\n}\r\n\r\nconst randFloat = function(low: number, high: number): number {\r\n\treturn low + Math.random() * (high - low);\r\n}\r\n\r\nconst randFloatSpread = function(range: number): number {\r\n\treturn range * (0.5 - Math.random());\r\n}\r\n\r\nconst degToRad = function(degrees: number): number {\r\n\treturn degrees * DEG2RAD;\r\n}\r\n\r\nconst radToDeg = function(radians: number): number {\r\n\treturn radians * RAD2DEG;\r\n}\r\nconst isPowerOfTwo = function(value: number): boolean {\r\n\treturn (value & (value - 1)) === 0 && value !== 0;\r\n}\r\n\r\nconst ceilPowerOfTwo = function(value: number): number {\r\n\treturn Math.pow(2, Math.ceil(Math.log(value) / Math.LN2));\r\n}\r\n\r\nconst floorPowerOfTwo = function(value: number): number {\r\n\treturn Math.pow(2, Math.floor(Math.log(value) / Math.LN2));\r\n}","import { Vector3Values } from \"../../algebra/vectors/Vector3\";\r\nimport { Triangle, TrianglePool } from \"../../geometry/primitives/Triangle\";\r\nimport { clamp } from \"../../Snippets\";\r\n\r\nexport { TriangleList };\r\nexport { TriangleListBase };\r\n\r\ninterface TriangleList {\r\n    readonly array: ArrayLike<number>;\r\n    readonly count: number;\r\n\r\n    setArray(array: WritableArrayLike<number>): this;\r\n\r\n    get(idx: number, tri: Triangle): Triangle;\r\n    set(idx: number, tri: Triangle): void;\r\n    indexOf(tri: Triangle): number;\r\n    \r\n    forEach(func: (tri: Triangle, idx: number) => void, options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): void;\r\n\r\n    getIndexedPoints(indices: Vector3Values, triangle: Triangle): void;\r\n\r\n    forIndexedPoints(func: (tri: Triangle, idx: number, pointsIndices: Vector3Values) => void, indices: ArrayLike<number>, options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): void;\r\n}\r\n\r\ninterface TriangleListConstructor {\r\n    readonly prototype: TriangleList;\r\n    new(): TriangleList;\r\n    new(array: WritableArrayLike<number>): TriangleList;\r\n}\r\n\r\nclass TriangleListBase implements TriangleList {\r\n    private _array: WritableArrayLike<number>;\r\n    \r\n    constructor()\r\n    constructor(array: WritableArrayLike<number>)\r\n    constructor(array?: WritableArrayLike<number>) {\r\n        this._array = array || [];\r\n    }\r\n    \r\n    public get array(): ArrayLike<number> {\r\n        return this._array;\r\n    }\r\n\r\n    public get count(): number {\r\n        return Math.floor(this._array.length / 9);\r\n    }\r\n\r\n    public setArray(array: WritableArrayLike<number>): this {\r\n\t\tthis._array = array;\r\n\t\treturn this;\r\n    }\r\n\r\n    public get(idx: number, tri: Triangle): Triangle {\r\n        if (idx >= this.count) {\r\n            throw new Error(`Index ${idx} out of bounds.`);\r\n        }\r\n        return tri.readFromArray(this._array, idx * 9);\r\n    }\r\n\r\n    public set(idx: number, tri: Triangle): void {\r\n        if (idx >= this.count) {\r\n            throw new Error(`Index ${idx} out of bounds.`);\r\n\r\n        }\r\n        tri.writeIntoArray(this._array, idx * 9);\r\n    }\r\n    \r\n    public indexOf(tri: Triangle): number {\r\n        const count = this.count;\r\n\r\n        let idxBuf = 0,\r\n            idxObj = 0,\r\n            indexOf = -1;\r\n        \r\n        const tempTri = TrianglePool.acquire();\r\n        {\r\n            while (idxBuf < count) {\r\n                tempTri.readFromArray(this._array, idxBuf);\r\n                if (tri.equals(tempTri)) {\r\n                    indexOf = idxObj;\r\n                    idxObj += 1;\r\n                    break;\r\n                }\r\n                idxObj += 1;\r\n                idxBuf += 9;\r\n            }\r\n        }\r\n        TrianglePool.release(1);\r\n\r\n        return indexOf;\r\n    }\r\n\r\n    public forEach(func: (triangle: Triangle, idx: number, ...args: any) => void,\r\n        options: {\r\n            idxFrom: number;\r\n            idxTo: number;\r\n        } = { idxTo: this.count, idxFrom: 0 }): void {\r\n        \r\n        const idxTo = clamp(options.idxTo, 0, this.count);\r\n        const idxFrom = clamp(options.idxFrom, 0, idxTo);\r\n        \r\n        let idxObj = idxFrom;\r\n        \r\n        const tempTri = TrianglePool.acquire();\r\n        {\r\n            while (idxObj < idxTo) {\r\n\r\n                this.get(idxObj, tempTri);\r\n\r\n                func(tempTri, idxObj);\r\n                idxObj += 1;\r\n            }\r\n        }\r\n        TrianglePool.release(1);\r\n    }\r\n\r\n    public getIndexedPoints(indices: Vector3Values, tri: Triangle): void {\r\n        tri.point1.readFromArray(this._array, indices[0]);\r\n        tri.point2.readFromArray(this._array, indices[1]);\r\n        tri.point3.readFromArray(this._array, indices[2]);\r\n    }\r\n\r\n    public forIndexedPoints(func: (tri: Triangle, idx: number, pointsIndices: Vector3Values) => void, indices: ArrayLike<number>,\r\n        options: {\r\n            idxFrom: number;\r\n            idxTo: number;\r\n        } = { idxTo: indices.length / 3, idxFrom: 0 }): void {\r\n        \r\n        const idxTo = clamp(options.idxTo, 0, indices.length / 3);\r\n        const idxFrom = clamp(options.idxFrom, 0, idxTo);\r\n        \r\n        let idxBuf = idxFrom * 3;\r\n        \r\n        const tempTri = TrianglePool.acquire();\r\n        {\r\n            const pointsIndices: Vector3Values = [0, 0, 0];\r\n            for (let idxObj = idxFrom; idxObj < idxTo; idxObj++) {\r\n                pointsIndices[0] = indices[idxBuf    ];\r\n                pointsIndices[1] = indices[idxBuf + 1];\r\n                pointsIndices[2] = indices[idxBuf + 2];\r\n                \r\n                tempTri.point1.readFromArray(this._array, pointsIndices[0] * 3);\r\n                tempTri.point2.readFromArray(this._array, pointsIndices[1] * 3);\r\n                tempTri.point3.readFromArray(this._array, pointsIndices[2] * 3);\r\n\r\n                func(tempTri, idxObj, pointsIndices);\r\n                idxBuf += 3;\r\n            }\r\n        }\r\n        TrianglePool.release(1);\r\n    }\r\n}\r\n\r\nconst TriangleList: TriangleListConstructor = TriangleListBase;","import { StackPool } from \"../../../patterns/pools/StackPool\";\r\nimport { Vector2, Vector2Base } from \"../../algebra/vectors/Vector2\";\r\n\r\nexport { Vector2Pool };\r\n\r\nconst Vector2Pool: StackPool<Vector2> = new StackPool(Vector2Base);","import { Vector2 } from \"../../algebra/vectors/Vector2\";\r\nimport { clamp } from \"../../Snippets\";\r\nimport { Vector2Pool } from \"../pools/Vector2Pools\";\r\n\r\nexport { Vector2List };\r\nexport { Vector2ListBase };\r\n\r\ninterface Vector2List {\r\n    readonly array: ArrayLike<number>;\r\n    readonly count: number;\r\n\r\n    setArray(array: WritableArrayLike<number>): this;\r\n\r\n    forEach(func: (vec: Vector2, idx: number) => void, options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): void;\r\n    indexOf(vec: Vector2): number;\r\n    get(idx: number, vec: Vector2): Vector2;\r\n    set(idx: number, vec: Vector2): void;\r\n}\r\n\r\ninterface Vector2ListConstructor {\r\n    readonly prototype: Vector2List;\r\n    new(): Vector2List;\r\n    new(array: WritableArrayLike<number>): Vector2List;\r\n}\r\n\r\nclass Vector2ListBase implements Vector2List {\r\n    private _array: WritableArrayLike<number>;\r\n\r\n    constructor()\r\n    constructor(array: WritableArrayLike<number>)\r\n    constructor(array?: WritableArrayLike<number>) {\r\n        this._array = array || [];\r\n    }\r\n\r\n    public get array(): ArrayLike<number> {\r\n        return this._array;\r\n    }\r\n\r\n    public get count(): number {\r\n        return Math.floor(this._array.length / 2);\r\n    }\r\n\r\n    public setArray(array: WritableArrayLike<number>): this {\r\n\t\tthis._array = array;\r\n\t\treturn this;\r\n    }\r\n\r\n    public forEach(func: (vec: Vector2, idx: number) => void,\r\n        options: {\r\n            idxFrom: number;\r\n            idxTo: number;\r\n        } = { idxTo: this.count, idxFrom: 0 }): void {\r\n        \r\n        const count = this.count;\r\n        const idxTo = clamp(options.idxTo, 0, count);\r\n        const idxFrom = clamp(options.idxFrom, 0, idxTo);\r\n\r\n        let idxObj = idxFrom;\r\n\r\n        Vector2Pool.acquireTemp(1, (vector) => {\r\n            while (idxObj < count) {\r\n                this.get(idxObj, vector);\r\n                func(vector, idxObj);\r\n\r\n                idxObj += 1;\r\n            }\r\n        });\r\n    }\r\n\r\n    public indexOf(vec: Vector2): number {\r\n        const count = this.count;\r\n\r\n        let idxBuf = 0,\r\n            idxObj = 0,\r\n            indexOf = -1;\r\n        \r\n            Vector2Pool.acquireTemp(1, (vector) => {\r\n            while (idxBuf < count) {\r\n                vector.readFromArray(this._array, idxBuf);\r\n                if (vector.equals(vec)) {\r\n                    \r\n                    indexOf = idxObj;\r\n                    break;\r\n                }\r\n                idxObj += 1;\r\n                idxBuf += 2;\r\n            }\r\n        });\r\n\r\n        return indexOf;\r\n    }\r\n\r\n    public get(idx: number, vec: Vector2): Vector2 {\r\n        if (idx >= this.count) {\r\n            throw new Error(`Index ${idx} out of bounds.`);\r\n        }\r\n        return vec.readFromArray(this._array, idx * 2);\r\n    }\r\n\r\n    public set(idx: number, vec: Vector2): void {\r\n        if (idx >= this.count) {\r\n            throw new Error(`Index ${idx} out of bounds.`);\r\n        }\r\n        vec.readFromArray(this._array, idx * 2);\r\n    }\r\n}\r\n\r\nconst Vector2List: Vector2ListConstructor = Vector2ListBase;","import { Vector3 } from \"../../algebra/vectors/Vector3\";\r\nimport { clamp } from \"../../Snippets\";\r\nimport { Vector3Pool } from \"../pools/Vector3Pools\";\r\n\r\nexport { Vector3List };\r\nexport { Vector3ListBase };\r\n\r\ninterface Vector3List {\r\n    readonly array: ArrayLike<number>;\r\n    readonly count: number;\r\n\r\n    setArray(array: WritableArrayLike<number>): this;\r\n\r\n    forEach(func: (vec: Vector3, idx: number) => void, options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): void;\r\n    indexOf(vec: Vector3): number;\r\n    get(idx: number, vec: Vector3): Vector3;\r\n    set(idx: number, vec: Vector3): void;\r\n}\r\n\r\ninterface Vector3ListConstructor {\r\n    readonly prototype: Vector3List;\r\n    new(): Vector3List;\r\n    new(array: WritableArrayLike<number>): Vector3List;\r\n}\r\n\r\nclass Vector3ListBase implements Vector3List {\r\n    private _array: WritableArrayLike<number>;\r\n    \r\n    constructor()\r\n    constructor(array: WritableArrayLike<number>)\r\n    constructor(array?: WritableArrayLike<number>) {\r\n        this._array = array || [];\r\n    }\r\n\r\n    public get array(): ArrayLike<number> {\r\n        return this._array;\r\n    }\r\n\r\n    public get count(): number {\r\n        return Math.floor(this._array.length / 3);\r\n    }\r\n\r\n    public setArray(array: WritableArrayLike<number>): this {\r\n\t\tthis._array = array;\r\n\t\treturn this;\r\n    }\r\n\r\n    public forEach(func: (vec: Vector3, idx: number) => void,\r\n        options: {\r\n            idxFrom: number;\r\n            idxTo: number;\r\n        } = { idxTo: this.count, idxFrom: 0 }): void {\r\n        \r\n        const count = this.count;\r\n        const idxTo = clamp(options.idxTo, 0, count);\r\n        const idxFrom = clamp(options.idxFrom, 0, idxTo);\r\n\r\n        let idxObj = idxFrom;\r\n\r\n        const tempVec = Vector3Pool.acquire();\r\n        {\r\n            while (idxObj < count) {\r\n                this.get(idxObj, tempVec);\r\n                func(tempVec, idxObj);\r\n\r\n                idxObj += 1;\r\n            }\r\n        }\r\n        Vector3Pool.release(1);\r\n    }\r\n\r\n    public forEachFromIndices(func: (vec: Vector3, idx: number, indice: number) => void, indices: ArrayLike<number>,\r\n        options: {\r\n            idxFrom: number;\r\n            idxTo: number;\r\n        } = { idxTo: indices.length / 3, idxFrom: 0 }): void {\r\n        \r\n        const idxTo = clamp(options.idxTo, 0, indices.length / 3);\r\n        const idxFrom = clamp(options.idxFrom, 0, idxTo);\r\n        \r\n        let idxBuf = idxFrom * 3;\r\n\r\n        const tempVec = Vector3Pool.acquire();\r\n        {\r\n            for (let idxObj = idxFrom; idxObj < idxTo; idxObj++) {\r\n                const indice = indices[idxBuf];\r\n                this.get(indice, tempVec);\r\n                func(tempVec, idxObj, indice);\r\n            }\r\n        }\r\n        Vector3Pool.release(1);\r\n    }\r\n\r\n    public indexOf(vec: Vector3): number {\r\n        const count = this.count;\r\n\r\n        let idxBuf = 0,\r\n            idxObj = 0,\r\n            indexOf = -1;\r\n        \r\n        const tempVec = Vector3Pool.acquire();\r\n        {\r\n            while (idxBuf < count) {\r\n                tempVec.readFromArray(this._array, idxBuf);\r\n                if (vec.equals(tempVec)) {\r\n                    \r\n                    indexOf = idxObj;\r\n                    break;\r\n                }\r\n                idxObj += 1;\r\n                idxBuf += 3;\r\n            }\r\n        }\r\n        Vector3Pool.release(1);\r\n\r\n        return indexOf;\r\n    }\r\n\r\n    public get(idx: number, vec: Vector3): Vector3 {\r\n        if (idx >= this.count) {\r\n            throw new Error(`Index ${idx} out of bounds.`);\r\n        }\r\n        return vec.readFromArray(this._array, idx * 3);\r\n    }\r\n\r\n    public set(idx: number, vec: Vector3): void {\r\n        if (idx >= this.count) {\r\n            throw new Error(`Index ${idx} out of bounds.`);\r\n        }\r\n        vec.writeIntoArray(this._array, idx * 3);\r\n    }\r\n}\r\n\r\nconst Vector3List: Vector3ListConstructor = Vector3ListBase;","export { UUID };\r\nexport { Identifiable };\r\nexport { UUIDGeneratorBase };\r\nexport { UUIDGenerator };\r\n\r\ntype UUID = string;\r\n\r\ninterface Identifiable {\r\n    readonly uuid: UUID;\r\n}\r\n\r\ninterface UUIDGenerator {\r\n    newUUID(): UUID;\r\n}\r\n\r\nclass UUIDGeneratorBase {\r\n\r\n    private _count: number;\r\n\r\n    constructor() {\r\n        this._count = 0\r\n    }\r\n\r\n    public newUUID(): UUID {\r\n        return (++this._count).toString(16);\r\n    }\r\n}\r\n\r\nconst UUIDGenerator: UUIDGenerator = new UUIDGeneratorBase();","import { Vector3 } from \"../../maths/algebra/vectors/Vector3\";\r\nimport { Vector3List } from \"../../maths/extensions/lists/Vector3List\";\r\nimport { Vector3Pool } from \"../../maths/extensions/pools/Vector3Pools\";\r\nimport { Plane } from \"../../maths/geometry/primitives/Plane\";\r\nimport { Triangle } from \"../../maths/geometry/primitives/Triangle\";\r\nimport { Injector } from \"../../patterns/injectors/Injector\";\r\nimport { StackPool } from \"../../patterns/pools/StackPool\";\r\nimport { BoundingSphere } from \"./BoundingSphere\";\r\n\r\nexport { BoundingBox };\r\nexport { BoundingBoxInjector };\r\nexport { BoundingBoxBase };\r\nexport { BoundingBoxPool };\r\n\r\ninterface BoundingBox {\r\n\tmin: Vector3;\r\n\tmax: Vector3;\r\n\t\r\n\tset(min: Vector3, max: Vector3): void;\r\n    copy(box: BoundingBox): BoundingBox;\r\n    clone(box: BoundingBox): BoundingBox;\r\n    makeEmpty(): void;\r\n    isEmpty(): boolean;\r\n\tgetCenter(out: Vector3): Vector3;\r\n\tgetSize(out: Vector3): Vector3;\r\n    setFromLengths(center: Vector3, length: number, width: number, height: number): BoundingBox;\r\n\tsetFromPoints(points: Vector3List): BoundingBox;\r\n\texpandByPoint(point: Vector3): BoundingBox;\r\n\texpandByVector(vector: Vector3): BoundingBox;\r\n\texpandByScalar(k: number): void;\r\n\tclampPoint(point: Vector3, out: Vector3): Vector3;\r\n\tdistanceToPoint(point: Vector3): number;\r\n\tintersectsPlane(plane: Plane): boolean;\r\n\tintersectsSphere(sphere: BoundingSphere): boolean;\r\n    intersectsBox(box: BoundingBox): boolean;\r\n\tgetBoundingSphere(out: BoundingSphere): BoundingSphere;\r\n    intersectsTriangle(triangle: Triangle): boolean;\r\n}\r\n\r\ninterface BoundingBoxConstructor {\r\n    readonly prototype: BoundingBox;\r\n    new(): BoundingBox;\r\n}\r\n\r\nclass BoundingBoxBase implements BoundingBox {\r\n\r\n    private _min: Vector3;\r\n\tprivate _max: Vector3;\r\n\r\n    constructor() {\r\n        this._min = new Vector3([-Infinity, -Infinity, -Infinity]);\r\n        this._max = new Vector3([+Infinity, +Infinity, +Infinity]);\r\n    }\r\n\t\r\n\tpublic get min(): Vector3 {\r\n\t\treturn this._min;\r\n\t}\r\n\r\n\tpublic set min(min: Vector3) {\r\n\t\tthis._min = min;\r\n\t}\r\n\r\n\tpublic get max(): Vector3 {\r\n\t\treturn this._max;\r\n\t}\r\n\r\n\tpublic set max(max: Vector3) {\r\n\t\tthis._max = max;\r\n\t}\r\n\r\n\tpublic set(min: Vector3, max: Vector3): void {\r\n        this._min.copy(min);\r\n        this._max.copy(max);\r\n    }\r\n\r\n    public copy(box: BoundingBoxBase): BoundingBoxBase {\r\n        this._min = box._min;\r\n        this._max = box._max;\r\n\r\n        return this;\r\n    }\r\n\r\n    public clone(box: BoundingBoxBase): BoundingBoxBase {\r\n        return new BoundingBoxBase().copy(box);\r\n    }\r\n\r\n    public makeEmpty(): void {\r\n        this._min.setValues([Infinity, Infinity, Infinity]);\r\n        this._max.setValues([+Infinity, +Infinity, +Infinity]);\r\n    }\r\n\r\n    public isEmpty(): boolean {\r\n        return (this._max.x < this._min.x) || (this._max.y < this._min.y) || (this._max.z < this._min.z);\r\n    }\r\n\r\n\tpublic getCenter(out: Vector3): Vector3 {\r\n\t\tthis.isEmpty() ? out.setValues([0, 0, 0]) : out.copy(this._min).add(this._max).multScalar(0.5);\r\n\t\treturn out;\r\n\t}\r\n    \r\n\tpublic getSize(out: Vector3): Vector3 {\r\n\t\tthis.isEmpty() ? out.setValues([0, 0, 0]) : out.copy(this._max).sub(this._min);\r\n\t\treturn out;\r\n\t}\r\n\r\n    public setFromLengths(center: Vector3, length: number, width: number, height: number): BoundingBoxBase {\r\n        this._min.setValues([center.x - length / 2, center.y - width / 2, center.z - height / 2]);\r\n        this._max.setValues([center.x + length / 2, center.y + width / 2, center.z + height / 2]);\r\n\r\n        return this;\r\n    }\r\n\r\n\tpublic setFromPoints(points: Vector3List): BoundingBoxBase {\r\n        this.makeEmpty();\r\n\t\t\r\n        points.forEach((vec: Vector3) => {\r\n            this.expandByPoint(vec);\r\n        });\r\n        \r\n        return this;\r\n    }\r\n    \r\n\tpublic expandByPoint(point: Vector3): BoundingBoxBase {\r\n\t\tthis._min.min(point);\r\n        this._max.min(point);\r\n        \r\n        return this;\r\n    }\r\n\r\n\tpublic expandByVector(vector: Vector3): BoundingBoxBase {\r\n\t\tthis._min.sub(vector);\r\n        this._max.add(vector);\r\n        \r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic expandByScalar(k: number) {\r\n\t\tthis._min.addScalar(-k);\r\n\t\tthis._max.addScalar(k);\r\n\r\n\t\treturn this;\r\n    }\r\n    \r\n\tpublic clampPoint(point: Vector3, out: Vector3): Vector3 {\r\n\t\treturn out.copy(point).clamp(this._min, this._max);\r\n\t}\r\n\r\n\tpublic distanceToPoint(point: Vector3): number {\r\n\r\n\t\tlet dist = 0;\r\n\r\n\t\tVector3Pool.acquireTemp(1, (temp) => {\r\n\t\t\tconst clampedPoint = temp.copy(point).clamp(this._min, this._max);\r\n\t\t\tdist = clampedPoint.sub(point).len();\r\n\t\t});\r\n\r\n        return dist;\r\n\t}\r\n\r\n\tpublic intersectsPlane(plane: Plane): boolean {\r\n\t\tlet min = 0, max = 0;\r\n\r\n\t\tif (plane.normal.x > 0) {\r\n\t\t\tmin = plane.normal.x * this._min.x;\r\n\t\t\tmax = plane.normal.x * this._max.x;\r\n        }\r\n        else {\r\n\t\t\tmin = plane.normal.x * this._max.x;\r\n\t\t\tmax = plane.normal.x * this._min.x;\r\n\t\t}\r\n\r\n\t\tif (plane.normal.y > 0) {\r\n\t\t\tmin += plane.normal.y * this._min.y;\r\n\t\t\tmax += plane.normal.y * this._max.y;\r\n        }\r\n        else {\r\n\t\t\tmin += plane.normal.y * this._max.y;\r\n\t\t\tmax += plane.normal.y * this._min.y;\r\n\t\t}\r\n\r\n\t\tif (plane.normal.z > 0) {\r\n\t\t\tmin += plane.normal.z * this._min.z;\r\n\t\t\tmax += plane.normal.z * this._max.z;\r\n        }\r\n        else {\r\n\t\t\tmin += plane.normal.z * this._max.z;\r\n\t\t\tmax += plane.normal.z * this._min.z;\r\n\t\t}\r\n\r\n\t\treturn (min <= -plane.constant && max >= -plane.constant);\r\n    }\r\n\r\n\tpublic intersectsSphere(sphere: BoundingSphere): boolean {\r\n        let intersects = false;\r\n\r\n        Vector3Pool.acquireTemp(1, (clamped) => {\r\n\t\t\tthis.clampPoint(sphere.center, clamped);\r\n\t\t\tintersects = clamped.distSq(sphere.center) <= (sphere.radius * sphere.radius);\r\n\t\t});\r\n\r\n\t\treturn intersects;\r\n\t}\r\n\r\n    public intersectsBox(box: BoundingBoxBase): boolean {\r\n\t\treturn !(\r\n            box._max.x < this._min.x || box._min.x > this._max.x ||\r\n\t\t\tbox._max.y < this._min.y || box._min.y > this._max.y ||\r\n            box._max.z < this._min.z || box._min.z > this._max.z\r\n        );\r\n    }\r\n\r\n\tpublic getBoundingSphere(out: BoundingSphere): BoundingSphere {\r\n\t\tout.radius = this.getSize(out.center).len() * 0.5;\r\n\t\tthis.getCenter(out.center);\r\n\r\n\t\treturn out;\r\n    }\r\n    \r\n    public intersectsTriangle(triangle: Triangle): boolean {\r\n\r\n\t\tif (this.isEmpty()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tconst point1 = triangle.point1,\r\n\t\t\tpoint2 = triangle.point2,\r\n\t\t\tpoint3 = triangle.point3;\r\n\r\n\t\tlet intersects = false;\r\n\r\n\t\tVector3Pool.acquireTemp(8,\r\n\t\t\t(center, extents, v1, v2, v3, edge1, edge2, edge3) => {\r\n\t\t\t\r\n\t\t\tthis.getCenter(center);\r\n\t\t\t\r\n\t\t\textents.copyAndSub(this._max, center),\r\n\t\t\tv1.copyAndSub(point1, center),\r\n\t\t\tv2.copyAndSub(point2, center),\r\n\t\t\tv3.copyAndSub(point3, center),\r\n\t\t\tedge1.copyAndSub(point2, point1),\r\n\t\t\tedge2.copyAndSub(point3, point2),\r\n\t\t\tedge3.copyAndSub(point1, point3);\r\n\r\n\t\t\tlet axes = new Float32Array([\r\n\t\t\t\t0, \t\t\t-edge1.z, \tedge1.y,\r\n\t\t\t\t0,\t\t\t-edge2.z, \tedge2.y,\r\n\t\t\t\t0, \t\t\t-edge3.z,\tedge3.y,\r\n\t\t\t\tedge1.z,\t0,\t\t\t-edge1.x,\r\n\t\t\t\tedge2.z,\t0,\t\t\t-edge2.x,\r\n\t\t\t\tedge3.z,\t0,\t\t\t-edge3.x,\r\n\t\t\t\t-edge1.y,\tedge1.x,\t0,\r\n\t\t\t\t-edge2.y,\tedge2.x,\t0,\r\n\t\t\t\t-edge3.y,\tedge3.x,\t0\r\n\t\t\t]);\r\n\r\n\t\t\tif (!this.satForAxes(axes, v1, v2, v3, extents)) {\r\n\t\t\t\tintersects = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\taxes = new Float32Array([\r\n\t\t\t\t1, 0, 0,\r\n\t\t\t\t0, 1, 0,\r\n\t\t\t\t0, 0, 1\r\n\t\t\t]);\r\n\t\t\tif (!this.satForAxes(axes, v1, v2, v3, extents)) {\r\n\t\t\t\tintersects = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst triangleNormal = center.copyAndCross(edge1, edge2);\r\n\t\t\tintersects = this.satForAxes(triangleNormal.values, v1, v2, v3, extents);\r\n\t\t});\r\n\r\n\t\treturn intersects;\r\n\t}\r\n\r\n\tprivate satForAxes(axes: ArrayLike<number>, v1: Vector3, v2: Vector3, v3: Vector3, extents: Vector3) {\r\n\r\n\t\tlet sat = true;\r\n\t\r\n\t\tVector3Pool.acquireTemp(1, (axis) => {\r\n\t\t\tfor (let i = 0, j = axes.length - 3; i <= j; i += 3) {\r\n\t\t\t\taxis.x = axes[i    ];\r\n\t\t\t\taxis.y = axes[i + 1];\r\n\t\t\t\taxis.z = axes[i + 2];\r\n\r\n\t\t\t\tconst r = extents.x * Math.abs(axis.x) + extents.y * Math.abs(axis.y) + extents.z * Math.abs(axis.z);\r\n\t\t\t\tconst p1 = v1.dot(axis);\r\n\t\t\t\tconst p2 = v2.dot(axis);\r\n\t\t\t\tconst p3 = v3.dot(axis);\r\n\t\r\n\t\t\t\tif (Math.max(-Math.max(p1, p2, p3), Math.min(p1, p2, p3)) > r) {\r\n\t\t\t\t\tsat = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\treturn sat;\r\n\t}\r\n}\r\n\r\nvar BoundingBox: BoundingBoxConstructor = BoundingBoxBase;\r\nconst BoundingBoxInjector: Injector<BoundingBoxConstructor> = new Injector({\r\n\tdefaultCtor: BoundingBoxBase,\r\n\tonDefaultOverride:\r\n\t\t(ctor: BoundingBoxConstructor) => {\r\n\t\t\tBoundingBox = ctor;\r\n\t\t}\r\n});\r\nconst BoundingBoxPool: StackPool<BoundingBox> = new StackPool(BoundingBoxBase);","import { Matrix4 } from \"../../maths/algebra/matrices/Matrix4\";\r\nimport { Vector3 } from \"../../maths/algebra/vectors/Vector3\";\r\nimport { Vector3List } from \"../../maths/extensions/lists/Vector3List\";\r\nimport { Plane } from \"../../maths/geometry/primitives/Plane\";\r\nimport { Injector } from \"../../patterns/injectors/Injector\";\r\nimport { BoundingBox, BoundingBoxPool } from \"./BoundingBox\";\r\n\r\nexport { BoundingSphere };\r\nexport { BoundingSphereInjector };\r\nexport { BoundingSphereBase };\r\n\r\ninterface BoundingSphere {\r\n\tcenter: Vector3;\r\n\tradius: number;\r\n\tset(center: Vector3, radius: number): BoundingSphere;\r\n\tcopy(sphere: BoundingSphere): BoundingSphere;\r\n\tclone(): BoundingSphere;\r\n\tsetFromPoints(points: Vector3List, center?: Vector3): BoundingSphere;\r\n\tisEmpty(): boolean;\r\n\tmakeEmpty(): BoundingSphere;\r\n\tcontainsPoint(point: Vector3): boolean;\r\n\tdist(point: Vector3): number;\r\n\tdistToPlane(plane: Plane): number;\r\n\tintersectsSphere(sphere: BoundingSphere): boolean;\r\n\tintersectsBox(box: BoundingBox): boolean;\r\n\tintersectsPlane(plane: Plane): boolean;\r\n\tclampPoint(point: Vector3, out: Vector3): Vector3;\r\n\tgetBoundingBox(out: BoundingBox): BoundingBox;\r\n\ttransform(mat: Matrix4): void;\r\n\ttranslate(offset: Vector3): void;\r\n}\r\n\r\ninterface BoundingSphereConstructor {\r\n    readonly prototype: BoundingSphere;\r\n    new(): BoundingSphere;\r\n}\r\n\r\nclass BoundingSphereBase implements BoundingSphere {\r\n\r\n    private _center: Vector3;\r\n\tprivate _radius: number;\r\n\t\r\n    constructor() {\r\n        this._center = new Vector3([-Infinity, -Infinity, -Infinity]);\r\n        this._radius = 0;\r\n\t}\r\n\r\n\tpublic get center(): Vector3 {\r\n\t\treturn this._center;\r\n\t}\r\n\r\n\tpublic set center(center: Vector3) {\r\n\t\tthis._center = center;\r\n\t}\r\n\r\n\tpublic get radius(): number {\r\n\t\treturn this._radius;\r\n\t}\r\n\r\n\tpublic set radius(radius: number) {\r\n\t\tthis._radius = radius;\r\n\t}\r\n\r\n\tpublic set(center: Vector3, radius: number): BoundingSphereBase {\r\n\t\tthis._center.copy(center);\r\n\t\tthis._radius = radius;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic copy(sphere: BoundingSphereBase): BoundingSphereBase {\r\n\t\tthis._center.copy(sphere._center);\r\n\t\tthis._radius = sphere._radius;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic clone(): BoundingSphereBase {\r\n\t\treturn new BoundingSphereBase().copy(this);\r\n\t}\r\n\t\r\n\tpublic setFromPoints(points: Vector3List, center?: Vector3): BoundingSphereBase {\r\n\r\n\t\tif (center !== undefined) {\r\n\t\t\tthis._center.copy(center);\r\n        }\r\n        else {\r\n\t\t\tBoundingBoxPool.acquireTemp(1, (box) => {\r\n\t\t\t\tbox.setFromPoints(points).getCenter(this._center);\r\n\t\t\t});\r\n\t\t}\r\n\r\n        let maxRadiusSq = 0;\r\n\t\t\r\n\t\tpoints.forEach((point: Vector3) => {\r\n\t\t\tmaxRadiusSq = Math.max(maxRadiusSq, this._center.distSq(point));\r\n\t\t});\r\n\r\n\t\tthis._radius = Math.sqrt(maxRadiusSq);\r\n\r\n\t\treturn this;\r\n    }\r\n\r\n\tpublic isEmpty(): boolean {\r\n\t\treturn (this._radius < 0);\r\n\t}\r\n\r\n\tpublic makeEmpty(): BoundingSphereBase {\r\n\t\tthis._center.setZeros();\r\n\t\tthis._radius = -1;\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic containsPoint(point: Vector3): boolean {\r\n\t\treturn (point.distSq(this._center) <= (this._radius * this._radius));\r\n\t}\r\n\r\n\tpublic dist(point: Vector3): number {\r\n\t\treturn (point.dist(this._center) - this._radius);\r\n\t}\r\n\r\n\tpublic distToPlane(plane: Plane): number {\r\n\t\treturn plane.distanceToPoint(this._center) - this._radius;\r\n\t}\r\n\r\n\tpublic intersectsSphere(sphere: BoundingSphereBase): boolean {\r\n        const radiusSum = this._radius + sphere._radius;\r\n        \r\n\t\treturn this._center.distSq(sphere._center) <= (radiusSum * radiusSum);\r\n\t}\r\n\r\n\tpublic intersectsBox(box: BoundingBox): boolean {\r\n\t\treturn box.intersectsSphere(this);\r\n\t}\r\n\r\n\tpublic intersectsPlane(plane: Plane): boolean {\r\n\t\treturn Math.abs(plane.distanceToPoint(this._center)) <= this._radius;\r\n\t}\r\n\r\n\tpublic clampPoint(point: Vector3, out: Vector3): Vector3 {\r\n\t\tconst deltaLenSq = this._center.distSq(point);\r\n\r\n\t\tout.copy(point);\r\n\r\n\t\tif (deltaLenSq > (this._radius * this._radius)) {\r\n\t\t\tout.sub(this._center).normalize();\r\n\t\t\tout.multScalar(this._radius).add(this._center);\r\n\t\t}\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tpublic getBoundingBox(out: BoundingBox): BoundingBox {\r\n\r\n\t\tif (this.isEmpty()) {\r\n\t\t\tout.makeEmpty();\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tout.set(this._center, this._center);\r\n\t\tout.expandByScalar(this._radius);\r\n\r\n\t\treturn out;\r\n\t}\r\n\r\n\tpublic transform(mat: Matrix4): void {\r\n\t\tthis._center.setValues(mat.transformPoint(this._center));\r\n\t\tthis._radius = this._radius * mat.getMaxScaleOnAxis();\r\n\t}\r\n\r\n\tpublic translate(offset: Vector3): void {\r\n\t\tthis._center.add(offset);\r\n\t}\r\n}\r\n\r\nvar BoundingSphere: BoundingSphereConstructor = BoundingSphereBase;\r\nconst BoundingSphereInjector: Injector<BoundingSphereConstructor> = new Injector({\r\n\tdefaultCtor: BoundingSphereBase,\r\n\tonDefaultOverride:\r\n\t\t(ctor: BoundingSphereConstructor) => {\r\n\t\t\tBoundingSphere = ctor;\r\n\t\t}\r\n});","import { StackPool } from \"../../../../patterns/pools/StackPool\";\r\nimport { TriangleList, TriangleListBase } from \"../../lists/TriangleList\";\r\n\r\nexport { TriangleListPool };\r\n\r\nconst TriangleListPool: StackPool<TriangleList> = new StackPool(TriangleListBase);","import { StackPool } from \"../../../../patterns/pools/StackPool\";\r\nimport { Vector3List, Vector3ListBase } from \"../../lists/Vector3List\";\r\n\r\nexport { Vector3ListPool };\r\n\r\nconst Vector3ListPool: StackPool<Vector3List> = new StackPool(Vector3ListBase);","import { Vector3 } from \"../../../../libs/maths/algebra/vectors/Vector3\";\r\nimport { TriangleListPool } from \"../../../../libs/maths/extensions/pools/lists/TriangleListPools\";\r\nimport { Vector3ListPool } from \"../../../../libs/maths/extensions/pools/lists/Vector3ListPools\";\r\nimport { Vector3Pool } from \"../../../../libs/maths/extensions/pools/Vector3Pools\";\r\nimport { Triangle } from \"../../../../libs/maths/geometry/primitives/Triangle\";\r\n\r\nexport { GeometryUtils };\r\n\r\nclass GeometryUtils {\r\n\r\n    public static computeTangentsAndBitangents<C extends (new(length: number) => WritableArrayLike<number>)>(\r\n        verticesArray: ArrayLike<number>, uvsArray: ArrayLike<number>, indicesArray: ArrayLike<number>, type: C): {\r\n        tangentsArray: InstanceType<C>,\r\n        bitangentsArray: InstanceType<C>\r\n    } {\r\n\r\n        const tangentsArray = new type(verticesArray.length);\r\n        const bitangentsArray = new type(verticesArray.length);\r\n\r\n        for (let i = 0; i < verticesArray.length; i += 3) {\r\n            const vertStride = 3;\r\n            const p1x = verticesArray[indicesArray[i  ] * vertStride    ],\r\n                p1y = verticesArray[indicesArray[i    ] * vertStride + 1],\r\n                p1z = verticesArray[indicesArray[i    ] * vertStride + 2],\r\n                p2x = verticesArray[indicesArray[i + 1] * vertStride    ],\r\n                p2y = verticesArray[indicesArray[i + 1] * vertStride + 1],\r\n                p2z = verticesArray[indicesArray[i + 1] * vertStride + 2],\r\n                p3x = verticesArray[indicesArray[i + 2] * vertStride    ],\r\n                p3y = verticesArray[indicesArray[i + 2] * vertStride + 1],\r\n                p3z = verticesArray[indicesArray[i + 2] * vertStride + 2];\r\n            \r\n            const edge1x = p2x - p1x,\r\n                edge1y = p2y - p1y,\r\n                edge1z = p2z - p1z;\r\n            \r\n            const edge2x = p3x - p1x,\r\n                edge2y = p3y - p1y,\r\n                edge2z = p3z - p1z;\r\n\r\n            const uvStride = 2;\r\n\r\n            const deltaUV1x = uvsArray[indicesArray[i + 1] * uvStride    ] - uvsArray[indicesArray[i] * uvStride    ],\r\n                  deltaUV1y = uvsArray[indicesArray[i + 1] * uvStride + 1] - uvsArray[indicesArray[i] * uvStride + 1],\r\n                  deltaUV2x = uvsArray[indicesArray[i + 2] * uvStride    ] - uvsArray[indicesArray[i] * uvStride    ],\r\n                  deltaUV2y = uvsArray[indicesArray[i + 2] * uvStride + 1] - uvsArray[indicesArray[i] * uvStride + 1];\r\n\r\n            const r = 1.0 / (deltaUV1x * deltaUV2y - deltaUV1y * deltaUV2x);\r\n\r\n            const tx = (edge1x * deltaUV2y - edge2x * deltaUV1y) * r;\r\n            const ty = (edge1y * deltaUV2y - edge2y * deltaUV1y) * r;\r\n            const tz = (edge1z * deltaUV2y - edge2z * deltaUV1y) * r;\r\n\r\n            const btx = (edge2x * deltaUV1x - edge1x * deltaUV2x) * r;\r\n            const bty = (edge2y * deltaUV1x - edge1y * deltaUV2x) * r;\r\n            const btz = (edge2z * deltaUV1x - edge1z * deltaUV2x) * r;\r\n\r\n            tangentsArray[indicesArray[i] * vertStride   ] = tx;\r\n            tangentsArray[indicesArray[i] * vertStride + 1] = ty;\r\n            tangentsArray[indicesArray[i] * vertStride + 2] = tz;\r\n\r\n            tangentsArray[indicesArray[i + 1] * vertStride   ] = tx;\r\n            tangentsArray[indicesArray[i + 1] * vertStride + 1] = ty;\r\n            tangentsArray[indicesArray[i + 1] * vertStride + 2] = tz;\r\n\r\n            tangentsArray[indicesArray[i + 2] * vertStride   ] = tx;\r\n            tangentsArray[indicesArray[i + 2] * vertStride + 1] = ty;\r\n            tangentsArray[indicesArray[i + 2] * vertStride + 2] = tz;\r\n\r\n            bitangentsArray[indicesArray[i] * vertStride    ] = btx;\r\n            bitangentsArray[indicesArray[i] * vertStride + 1] = bty;\r\n            bitangentsArray[indicesArray[i] * vertStride + 2] = btz;\r\n\r\n            bitangentsArray[indicesArray[i + 1] * vertStride    ] = btx;\r\n            bitangentsArray[indicesArray[i + 1] * vertStride + 1] = bty;\r\n            bitangentsArray[indicesArray[i + 1] * vertStride + 2] = btz;\r\n\r\n            bitangentsArray[indicesArray[i + 2] * vertStride    ] = btx;\r\n            bitangentsArray[indicesArray[i + 2] * vertStride + 1] = bty;\r\n            bitangentsArray[indicesArray[i + 2] * vertStride + 2] = btz;\r\n        }\r\n\r\n        return {\r\n            tangentsArray: tangentsArray as InstanceType<C>,\r\n            bitangentsArray: bitangentsArray as InstanceType<C>,\r\n        };\r\n    }\r\n\r\n    public static computeFacesNormals<C extends (new(length: number) => WritableArrayLike<number>)>(verticesArray: ArrayLike<number>, indicesArray: ArrayLike<number>, type: C): InstanceType<C> {\r\n        \r\n        const facesNormalsArray = new type(indicesArray.length);\r\n\r\n        let faces = TriangleListPool.acquire().setArray(verticesArray);\r\n        let facesNormals = Vector3ListPool.acquire().setArray(facesNormalsArray);\r\n        let normal = Vector3Pool.acquire();\r\n        \r\n        faces.forIndexedPoints((face: Triangle, idx: number) => {\r\n            face.getNormal(normal);\r\n            facesNormals.set(idx, normal);\r\n        }, indicesArray);\r\n\r\n        Vector3Pool.release(1);\r\n        Vector3ListPool.release(1);\r\n        TriangleListPool.release(1);\r\n\r\n        return facesNormalsArray as InstanceType<C>;\r\n    }\r\n    \r\n    public static computeVerticesNormals<C extends (new(length: number) => WritableArrayLike<number>)>(\r\n        verticesArray: ArrayLike<number>, indicesArray: ArrayLike<number>, weighted: boolean, type: C, facesNormalsArray?: ArrayLike<number>): InstanceType<C> {\r\n        \r\n        const verticesNormalsArray = new type(verticesArray.length);\r\n        \r\n        let verticesNormals = Vector3ListPool.acquire().setArray(verticesNormalsArray);\r\n        let vertices = Vector3ListPool.acquire().setArray(verticesArray);\r\n        let faces = TriangleListPool.acquire().setArray(verticesArray);\r\n\r\n        let facesNormals = Vector3ListPool.acquire().setArray(\r\n            facesNormalsArray ?  facesNormalsArray : this.computeFacesNormals(verticesArray, indicesArray, type)\r\n        );\r\n        \r\n        Vector3Pool.acquireTemp(2, (vertexNormalsSum, faceNormal) => {\r\n            if (weighted) {\r\n                vertices.forEach((vert: Vector3, vertIdx: number) => {\r\n                    verticesNormals.get(vertIdx, vertexNormalsSum);\r\n                    \r\n                    faces.forIndexedPoints((face: Triangle, faceIdx: number) => {\r\n                        if (face.indexOfPoint(vert) > -1) {\r\n                            facesNormals.get(faceIdx, faceNormal);\r\n                            vertexNormalsSum.add(faceNormal.multScalar(face.getArea()));\r\n                        }\r\n                    }, indicesArray);\r\n\r\n                    vertexNormalsSum.normalize();\r\n                    verticesNormals.set(vertIdx, vertexNormalsSum);\r\n                });\r\n            }\r\n            else {\r\n                faces.forIndexedPoints((face: Triangle, faceIdx: number, pointsIndices: Tuple<number, 3>) => {\r\n                    face.getNormal(faceNormal);\r\n                    verticesNormals.set(pointsIndices[0], faceNormal);\r\n                    verticesNormals.set(pointsIndices[1], faceNormal);\r\n                    verticesNormals.set(pointsIndices[2], faceNormal);\r\n                }, indicesArray);\r\n            }\r\n        });\r\n\r\n        return verticesNormalsArray as InstanceType<C>;\r\n    }\r\n}","\r\n\r\n// Vertices : counter clock-wise ordered\r\n\r\nimport { TriangleList } from \"../../../../libs/maths/extensions/lists/TriangleList\";\r\nimport { Vector2List } from \"../../../../libs/maths/extensions/lists/Vector2List\";\r\nimport { Vector3List } from \"../../../../libs/maths/extensions/lists/Vector3List\";\r\nimport { UUID, UUIDGenerator } from \"../../../../libs/maths/statistics/random/UUIDGenerator\";\r\nimport { BoundingBox } from \"../../../../libs/physics/collisions/BoundingBox\";\r\nimport { BoundingSphere } from \"../../../../libs/physics/collisions/BoundingSphere\";\r\nimport { GeometryUtils } from \"./GeometryUtils\";\r\n\r\n// FaceIndices : 3 vertices indices\r\n// FaceArea : triangle.getArea()\r\n// FaceNormal : triangle.getNormal()\r\n// FaceUV / FaceColor ?\r\n\r\n// VertexNormal => Weighted (by area) average of the normals of the faces containing the vertex (=> Varying)\r\n// - Clone the vertex array, read the face indices array\r\n\r\n// VertexIndices\r\n\r\n// PerVertex Animation / MorphTargets\r\n\r\n// SkeletalAnimation\r\n\r\n// Bones are a hierarchical tree\r\n\r\n// bonesWeights\r\n// bonesIndices\r\n\r\n// MorphTarget Animation\r\n\r\n// MorphTargets are a copy of each face, being transformed over time\r\n\r\n// morphIndices\r\n// morphTargets = []; MorphTargets are a transformed copy of faces\r\n// morphNormals = [];\r\n\r\nexport { GeometryPropertyKeys };\r\nexport { Geometry };\r\nexport { isGeometry };\r\nexport { GeometryBase };\r\n\r\nenum GeometryPropertyKeys {\r\n    vertices,\r\n    indices,\r\n    uvs,\r\n    facesNormals,\r\n    verticesNormals,\r\n    tangents,\r\n    bitangents\r\n}\r\n\r\n\r\ninterface GeometryConstructor {\r\n\r\n}\r\n\r\ninterface Geometry {\r\n    readonly isGeometry: true;\r\n    readonly uuid: UUID;\r\n    \r\n    indices: TypedArray;\r\n    vertices: Vector3List;\r\n    faces: TriangleList;\r\n    uvs: Vector2List;\r\n\r\n    facesNormals: Vector3List;\r\n    verticesNormals: Vector3List;\r\n    tangents: Vector3List;\r\n    bitangents: Vector3List;\r\n\r\n    [attrib: string]: any;\r\n\r\n    readonly boundingBox?: BoundingBox;\r\n    readonly boundingSphere?: BoundingSphere;\r\n\r\n    //builder(): GeometryBuilder;\r\n\r\n    //readonly changes: SingleTopicMessageSubscriber<{prop: GeometryPropertyKeys, section: BufferSectionValues}>;\r\n    \r\n    //copy(geometry: Geometry): Geometry;\r\n    //clone(): Geometry;\r\n\r\n    //computeFacesNormals(options?: ListLoopOptions): Geometry;\r\n    //computeVerticesNormals(weighted?: boolean, options?: ListLoopOptions): Geometry;\r\n    //computeTangentsAndBitangents(options?: ListLoopOptions): Geometry;\r\n\r\n\tcomputeBoundingBox(): BoundingBox;\r\n    computeBoundingSphere(): BoundingSphere;\r\n    \r\n    //updateVertices(vertices: TypedArray, offset?: number): Geometry;\r\n    //updateUvs(uvs: TypedArray, offset?: number): Geometry;\r\n}\r\n\r\nfunction isGeometry(obj: any): obj is Geometry {\r\n    return (obj as Geometry).isGeometry;\r\n}\r\n\r\nclass GeometryBase implements Geometry {\r\n\r\n    public readonly uuid: UUID;\r\n    public readonly isGeometry: true;\r\n    \r\n    private _boundingBox?: BoundingBox;\r\n    private _boundingSphere?: BoundingSphere;\r\n\r\n    private _indicesArray: TypedArray;\r\n\r\n    private _verticesArray: TypedArray;\r\n    private _vertices: Vector3List;\r\n    private _faces: TriangleList;\r\n\r\n    private _uvsArray: TypedArray;\r\n    private _uvs: Vector2List;\r\n\r\n    private _facesNormalsArray: TypedArray;\r\n    private _facesNormals: Vector3List;\r\n\r\n    private _verticesNormalsArray: TypedArray;\r\n    private _verticesNormals: Vector3List;\r\n\r\n    private _tangentsArray: TypedArray;\r\n    private _tangents: Vector3List;\r\n\r\n    private _bitangentsArray: TypedArray;\r\n    private _bitangents: Vector3List;\r\n\r\n    private _weightedVerticesNormals: boolean;\r\n\r\n    constructor(desc: {\r\n        vertices: TypedArray;\r\n        indices: TypedArray;\r\n        uvs: TypedArray;\r\n        weightedVerticesNormals?: boolean\r\n    }) {\r\n        this.uuid = UUIDGenerator.newUUID();\r\n        this.isGeometry = true;\r\n        \r\n        this._verticesArray = desc.vertices;\r\n        this._vertices = new Vector3List(this._verticesArray);\r\n        this._faces = new TriangleList(this._verticesArray);\r\n\r\n        this._indicesArray = desc.indices;\r\n\r\n        this._uvsArray = desc.uvs;\r\n        this._uvs = new Vector2List(this._uvsArray);\r\n\r\n        this._weightedVerticesNormals = desc.weightedVerticesNormals || false;\r\n\r\n        this._facesNormalsArray = GeometryUtils.computeFacesNormals(this._verticesArray, this._indicesArray, Float32Array);\r\n        this._facesNormals = new Vector3List(this._facesNormalsArray);\r\n        \r\n        this._verticesNormalsArray = GeometryUtils.computeVerticesNormals(this._verticesArray, this._indicesArray, this._weightedVerticesNormals, Float32Array, this._facesNormalsArray);\r\n        this._verticesNormals = new Vector3List(this._verticesNormalsArray);\r\n        \r\n        const { tangentsArray, bitangentsArray } = GeometryUtils.computeTangentsAndBitangents(this._verticesArray, this._uvsArray, this._indicesArray, Float32Array);\r\n        this._tangentsArray = tangentsArray;\r\n        this._bitangentsArray = bitangentsArray;\r\n        this._tangents = new Vector3List(this._tangentsArray);\r\n        this._bitangents = new Vector3List(this._bitangentsArray);\r\n    }\r\n\r\n    /*public builder(): GeometryBuilder {\r\n        return new GeometryBuilderBase(this);\r\n    }*/\r\n\r\n    public get indices(): TypedArray {\r\n        return this._indicesArray;\r\n    }\r\n\r\n    public get vertices(): Vector3List {\r\n        return this._vertices;\r\n    }\r\n\r\n    public get uvs(): Vector2List {\r\n        return this._uvs;\r\n    }\r\n\r\n    public get faces(): TriangleList {\r\n        return this._faces;\r\n    }\r\n\r\n    public get facesNormals(): Vector3List {\r\n        return this._facesNormals;\r\n    }\r\n\r\n    public get verticesNormals(): Vector3List {\r\n        return this._verticesNormals;\r\n    }\r\n\r\n    public get tangents(): Vector3List {\r\n        return this._tangents;\r\n    }\r\n\r\n    public get bitangents(): Vector3List {\r\n        return this._bitangents;\r\n    }\r\n\r\n    public get boundingBox(): BoundingBox | undefined {\r\n        return this._boundingBox;\r\n    }\r\n    \r\n\tpublic get boundingSphere(): BoundingSphere | undefined {\r\n        return this._boundingSphere;\r\n    }\r\n\r\n    /*public copy(geometry: GeometryBase): GeometryBase {\r\n        this._verticesArray = geometry._verticesArray.slice();\r\n        this._indicesArray = geometry._indicesArray.slice();\r\n        this._uvsArray = geometry._uvsArray.slice();\r\n        this._facesNormalsArray = geometry._facesNormalsArray.slice();\r\n        this._verticesNormalsArray = geometry._verticesNormalsArray.slice();\r\n        this._tangentsArray = geometry._tangentsArray.slice();\r\n        this._bitangentsArray = geometry._bitangentsArray.slice();\r\n\r\n        if (typeof geometry._boundingBox !== 'undefined') {\r\n            this.computeBoundingBox();\r\n        }\r\n\r\n        if (typeof geometry._boundingSphere !== 'undefined') {\r\n            this.computeBoundingSphere();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    public updateVertices(vertices: TypedArray, offset: number = 0): GeometryBase {\r\n        const idxFrom = offset;\r\n        const idxTo = offset + vertices.length;\r\n        this._verticesArray.set(vertices, offset);\r\n        this._updateFacesNormals({idxFrom, idxTo});\r\n        this._updateVerticesNormals(this._weightedVerticesNormals, {idxFrom, idxTo});\r\n        //this._changes.publish({prop: GeometryPropertyKeys.vertices, section: [idxFrom, idxTo]});\r\n        return this;\r\n    }\r\n\r\n    public updateUvs(uvs: TypedArray, offset: number = 0): GeometryBase {\r\n        const idxFrom = offset;\r\n        const idxTo = offset + uvs.length;\r\n        this._uvsArray.set(uvs, offset);\r\n        if (typeof this._tangents !== 'undefined') {\r\n            this._updateTangentsAndBitangents({idxFrom, idxTo});\r\n        }\r\n        //this._changes.publish({prop: GeometryPropertyKeys.uvs, section: [idxFrom, idxTo]});\r\n        return this;\r\n    }\r\n\r\n    public clone(): GeometryBase {\r\n        return new GeometryBase({\r\n            vertices: this._verticesArray.slice(),\r\n            indices: this._indicesArray.slice(),\r\n            uvs: this._uvsArray.slice()\r\n        }).copy(this);\r\n    }\r\n\r\n    private _updateFacesNormals(options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): GeometryBase {\r\n        GeometryUtils.computeFacesNormals(this._faces,  this._indicesArray, this._facesNormals, options);\r\n        //this._changes.publish({prop: GeometryPropertyKeys.facesNormals, section: [options?.idxFrom || 0, options?.idxTo || this._facesNormals.buffer.length]});\r\n        return this;\r\n    }\r\n\r\n    private _updateVerticesNormals(weighted: boolean = false, options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): GeometryBase {\r\n        this._weightedVerticesNormals = weighted;\r\n        if (typeof this.facesNormals === 'undefined') {\r\n            this._updateFacesNormals();\r\n        }\r\n        GeometryUtils.computeVerticesNormals(this._vertices, this._faces, this._indicesArray, this._facesNormals!, this._verticesNormals, weighted, options);\r\n        //this._changes.publish({prop: GeometryPropertyKeys.verticesNormals, section: [options?.idxFrom || 0, options?.idxTo || this._verticesNormals.buffer.length]});\r\n        return this;\r\n    }\r\n\r\n    private _updateTangentsAndBitangents(options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): GeometryBase {\r\n        //this._changes.publish({prop: GeometryPropertyKeys.tangents, section: [options?.idxFrom || 0, options?.idxTo || this._tangents.buffer.length]});\r\n        //this._changes.publish({prop: GeometryPropertyKeys.bitangents, section: [options?.idxFrom || 0, options?.idxTo || this._bitangents.buffer.length]});\r\n        GeometryUtils.computeTangentsAndBitangents(this._verticesArray, this._uvsArray, this._indicesArray, this._tangentsArray, this._bitangentsArray, options);\r\n        return this;\r\n    }*/\r\n    \r\n\tpublic computeBoundingBox(): BoundingBox {\r\n        if (this._boundingBox === undefined) {\r\n            this._boundingBox = new BoundingBox().setFromPoints(this._vertices);\r\n        }\r\n        else {\r\n            this._boundingBox.setFromPoints(this._vertices);\r\n        }\r\n        return this._boundingBox;\r\n    }\r\n    \r\n\tpublic computeBoundingSphere(): BoundingSphere {\r\n        if (this._boundingSphere === undefined) {\r\n            this._boundingSphere = new BoundingSphere().setFromPoints(this._vertices);\r\n        }\r\n        else {\r\n            this._boundingSphere.setFromPoints(this._vertices);\r\n        }\r\n        return this._boundingSphere;\r\n    }\r\n}","import { buildArrayFromIndexedArrays } from \"../../../../../../utils/Snippets\";\r\nimport { GeometryBase } from \"../../Geometry\";\r\n\r\n\r\nexport { CubeGeometry };\r\n\r\nclass CubeGeometry extends GeometryBase {\r\n\tconstructor() {\r\n\t\tsuper({\r\n\t\t\tvertices: new Float32Array(cubeVertices),\r\n\t\t\tindices: new Uint8Array(cubeIndices),\r\n\t\t\tuvs: new Float32Array(cubeUVS),\r\n\t\t})\r\n\t}\r\n}\r\n\r\n/**      \r\n *     y axis  \r\n * \t      ^   z axis\r\n *     UP |   ^  FORWARD\r\n *        | /\r\n *        +------> x axis\r\n *         RIGHT\r\n * \r\n *  left-handed coordinates system\r\n *  \r\n */\r\n\r\n /**      \r\n *      v0       v1\r\n * \t\t+_______+      o   ^ \r\n * \t    \\      /\\     /     \\\r\n *       \\   /   \\    \\     / \r\n *        \\/      \\    \\ _ /\r\n *        +--------+\r\n *       v2         v3\r\n * \r\n *  counter-clockwise winding order:\r\n * \t\tv0 -> v2 -> v1\r\n * \t\tv1 -> v2 -> v3\r\n */\r\n\r\n/**\r\n *              v0_______v1\r\n *              |\\        |\r\n *              |  \\   f1 |\r\n *              |    \\    |\r\n *              |  f0  \\  |\r\n *    v0________v2_______\\v3________v1\r\n *    |\\        |\\        |\\        |\r\n *    |  \\  f3  |  \\  f5  |  \\  f7  |\r\n *    |    \\    |    \\    |    \\    |\r\n *    | f2   \\  | f4   \\  | f6   \\  |\r\n *    v4_______\\v5_______\\v6_______\\v7\r\n *              |\\        |\r\n *              |  \\   f9 |\r\n *              |    \\    |\r\n *              |  f8  \\  |\r\n *              v4_______\\v7\r\n *              |\\        |\r\n *              |  \\  f11 |\r\n *              |    \\    |\r\n *              | f10  \\  |\r\n *              v0_______\\v1\r\n *  \r\n * v0 = [-1, +1, -1]\r\n * v1 = [+1, +1, -1]\r\n * v2 = [-1, +1, +1]\r\n * v3 = [+1, +1, +1]\r\n * v4 = [-1, -1, -1]\r\n * v5 = [-1, -1, +1]\r\n * v6 = [+1, -1, +1]\r\n * v7 = [+1, -1, -1]\r\n */\r\n\r\n/**\r\n * \ttexture mappings\r\n * \r\n *           \r\n *    uv0_____uv1\r\n *    | \\       |\r\n *    |   \\     |\r\n *    |     \\   |\r\n *    |       \\ |\r\n *    uv2_____uv3\r\n *        \r\n * \r\n * uv0 = [0,0]\r\n * uv1 = [1,0]\r\n * uv2 = [0,1]\r\n * uv3 = [1,1]\r\n */\r\n\r\nconst cubeVerticesSet = [\r\n\t[-1, +1, -1], // v0\r\n\t[+1, +1, -1], // v1\r\n\t[-1, +1, +1], // v2\r\n\t[+1, +1, +1], // v3\r\n\t[-1, -1, -1], // v4\r\n\t[-1, -1, +1], // v5\r\n\t[+1, -1, +1], // v6\r\n\t[+1, -1, -1], // v7\r\n];\r\n\r\nconst cubeVertices = buildArrayFromIndexedArrays(\r\n\tcubeVerticesSet,\r\n\t[\r\n\t\t0, 2, 3, 1, //  f0  f1\r\n\t\t0, 4, 5, 2, //  f2  f3\r\n\t\t2, 5, 6, 3, //  f4  f5\r\n\t\t3, 6, 7, 1, //  f6  f6\r\n\t\t5, 4, 7, 6, //  f8  f9\r\n\t\t4, 0, 1, 7, // f10 f11\r\n\t]\r\n);\r\n\r\nconst cubeUVsSet = [\r\n\t[0, 0],\r\n\t[1, 0],\r\n\t[0, 1],\r\n\t[1, 1],\r\n];\r\n\r\nconst cubeUVS = buildArrayFromIndexedArrays(\r\n\tcubeUVsSet,\r\n\t[\r\n\t\t0, 1, 3, 2, //  f0  f1\r\n\t\t0, 1, 3, 2, //  f2  f3\r\n\t\t0, 1, 3, 2, //  f4  f5\r\n\t\t0, 1, 3, 2, //  f6  f6\r\n\t\t0, 1, 3, 2, //  f8  f9\r\n\t\t0, 1, 3, 2, // f10 f11\r\n\t]\r\n);\r\n\r\nconst cubeIndices = [\r\n\t 0,  1,  2, //  f0\r\n\t 0,  2,  3, //  f1\r\n\t 4,  5,  6, //  f2\r\n\t 4,  6,  7, //  f3\r\n\t 8,  9, 10, //  f4\r\n\t 8, 10, 11, //  f5\r\n\t12, 13, 14, //  f6\r\n\t12, 14, 15, //  f7\r\n\t16, 17, 18, //  f8\r\n\t16, 18, 19, //  f9\r\n\t20, 21, 22, // f10\r\n\t20, 22, 23, // f11\r\n];","import { buildArrayFromIndexedArrays } from \"../../../../../../utils/Snippets\";\r\nimport { GeometryBase } from \"../../Geometry\";\r\nimport { GOLDEN_RATIO as p } from \"../../../../../../libs/maths/geometry/GeometryConstants\";\r\n\r\nexport { IcosahedronGeometry };\r\n\r\nclass IcosahedronGeometry extends GeometryBase {\r\n\r\n\tconstructor() {\r\n\t\tsuper({\r\n\t\t\tvertices: new Float32Array(icosahedronVertices),\r\n\t\t\tuvs: new Float32Array(icosahedronUVS),\r\n\t\t\tindices: new Uint8Array(icosahedronIndices)\r\n\t\t})\r\n\t}\r\n}\r\n\r\n/**\r\n * \r\n *      v0        v0        v0        v0        v0\r\n *     / \\       / \\       / \\       / \\       / \\ \r\n *    /   \\     /   \\     /   \\     /   \\     /   \\ \r\n *   /     \\   /     \\   /     \\   /     \\   /     \\ \r\n *  /  f0   \\ /  f1   \\ /  f2   \\ /  f3   \\ /  f4   \\\r\n * v1--------v2--------v3--------v4--------v5--------v1\r\n *  \\        /\\        /\\        /\\        /\\        /\\   \r\n *   \\  f5  /  \\  f7  /  \\  f9  /  \\  11  /  \\ f13  /  \\\r\n *    \\    /    \\    /    \\    /    \\    /    \\    /    \\\r\n *     \\  /  f6  \\  /  f8  \\  / f10  \\  / f12  \\  / f14  \\\r\n *      v6--------v7--------v8--------v9--------v10-------v6\r\n *       \\        /\\        /\\        /\\        /\\        /\r\n * \t      \\ f15  /  \\ f16  /  \\ f17  /  \\ f18  /  \\ f19  /\r\n *         \\    /    \\    /    \\    /    \\    /    \\    /\r\n *          \\  /      \\  /      \\  /      \\  /      \\  /\r\n *           v11       v11       v11       v11       v11\r\n * \r\n * v0  = [ 0, +p, +h]\r\n * v1  = [+h,  0, +p]\r\n * v2  = [+p, +h,  0]\r\n * v3  = [ 0, +p, -h]\r\n * v4  = [-p, +h,  0]\r\n * v5  = [-h,  0, +p]\r\n * v6  = [+p, -h,  0]\r\n * v7  = [+h,  0, -p]\r\n * v8  = [-h,  0, -p]\r\n * v9  = [-p, -h,  0]\r\n * v10 = [ 0, -p, +h]\r\n * v11 = [ 0, -p, -h]\r\n * \r\n */\r\n\r\nconst icosahedronVerticesSet = [\r\n\t[0, +p, +1], // v0\r\n\t[+1, 0, +p], // v1\r\n\t[+p, +1, 0], // v2\r\n\t[0, +p, -1], // v3\r\n\t[-p, +1, 0], // v4\r\n\t[-1, 0, +p], // v5\r\n\t[+p, -1, 0], // v6\r\n\t[+1, 0, -p], // v7\r\n\t[-1, 0, -p], // v8\r\n\t[-p, -1, 0], // v9\r\n\t[0, -p, +1], // v10\r\n\t[0, -p, -1], // v11\r\n];\r\n\r\nconst IcosahedronUVsSet = [\r\n\t[0, 0],\r\n\t[1, 0],\r\n\t[0, 1],\r\n\t[1, 1],\r\n];\r\n\r\nconst icosahedronVertices = buildArrayFromIndexedArrays(\r\n\ticosahedronVerticesSet,\r\n\t[\r\n\t\t\t0,  1,  2, // f0\r\n\t\t\t0,  2,  3, // f1\r\n\t\t\t0,  3,  4, // f2\r\n\t\t\t0,  4,  5, // f3\r\n\t\t\t0,  5,  1, // f4\r\n\t\t\t1,  6,  2, // f5\r\n\t\t\t2,  6,  7, // f6\r\n\t\t\t2,  7,  3, // f7\r\n\t\t\t3,  7,  8, // f8\r\n\t\t\t3,  8,  4, // f9\r\n\t\t\t4,  8,  9, // f10\r\n\t\t\t4,  9,  5, // f11\r\n\t\t\t5,  9, 10, // f12\r\n\t\t\t5, 10,  1, // f13\r\n\t\t\t1, 10,  6, // f14\r\n\t\t\t6, 11,  7, // f15\r\n\t\t\t7, 11,  8, // f16\r\n\t\t\t8, 11,  9, // f17\r\n\t\t\t9, 11, 10, // f18\r\n\t\t10, 11,  6, // f19\r\n\t]\r\n);\r\n\r\nconst icosahedronUVS = buildArrayFromIndexedArrays(\r\n\tIcosahedronUVsSet,\r\n\t[\r\n\t\t1, 2, 0, // f0\r\n\t\t1, 2, 0, // f1\r\n\t\t1, 2, 0, // f2\r\n\t\t1, 2, 0, // f3\r\n\t\t1, 2, 0, // f4\r\n\t\t1, 2, 0, // f5\r\n\t\t1, 2, 0, // f6\r\n\t\t1, 2, 0, // f7\r\n\t\t1, 2, 0, // f8\r\n\t\t1, 2, 0, // f9\r\n\t\t1, 2, 0, // f10\r\n\t\t1, 2, 0, // f11\r\n\t\t1, 2, 0, // f12\r\n\t\t1, 2, 0, // f13\r\n\t\t1, 2, 0, // f14\r\n\t\t1, 2, 0, // f15\r\n\t\t1, 2, 0, // f16\r\n\t\t1, 2, 0, // f17\r\n\t\t1, 2, 0, // f18\r\n\t\t1, 2, 0, // f19\r\n\t]\r\n);\r\n\r\nconst icosahedronIndices = [\r\n     0,  1,  2, // f0\r\n     3,  4,  5, // f1\r\n     6,  7,  8, // f2\r\n\t 9, 10, 11, // f3\r\n\t12, 13, 14, // f4\r\n\t15, 16, 17, // f5\r\n\t18, 19, 20, // f6\r\n\t21, 22, 23, // f7\r\n\t24, 25, 26, // f8\r\n\t27, 28, 29, // f9\r\n\t30, 31, 32, // f10\r\n   \t33, 34, 35, // f11\r\n   \t36, 37, 38, // f12\r\n   \t39, 40, 41, // f13\r\n   \t42, 43, 44, // f14\r\n  \t45, 46, 47, // f15\r\n  \t48, 49, 50, // f16\r\n  \t51, 52, 53, // f17\r\n  \t54, 55, 56, // f18\r\n  \t57, 58, 59, // f19\r\n];\r\n","\r\n\r\n// Vertices : counter clock-wise ordered\r\n\r\nimport { TriangleList } from \"../../../../libs/maths/extensions/lists/TriangleList\";\r\nimport { Vector2List } from \"../../../../libs/maths/extensions/lists/Vector2List\";\r\nimport { Vector3List } from \"../../../../libs/maths/extensions/lists/Vector3List\";\r\nimport { UUID, UUIDGenerator } from \"../../../../libs/maths/statistics/random/UUIDGenerator\";\r\nimport { BoundingBox } from \"../../../../libs/physics/collisions/BoundingBox\";\r\nimport { BoundingSphere } from \"../../../../libs/physics/collisions/BoundingSphere\";\r\nimport { GeometryUtils } from \"./GeometryUtils\";\r\n\r\n// FaceIndices : 3 vertices indices\r\n// FaceArea : triangle.getArea()\r\n// FaceNormal : triangle.getNormal()\r\n// FaceUV / FaceColor ?\r\n\r\n// VertexNormal => Weighted (by area) average of the normals of the faces containing the vertex (=> Varying)\r\n// - Clone the vertex array, read the face indices array\r\n\r\n// VertexIndices\r\n\r\n// PerVertex Animation / MorphTargets\r\n\r\n// SkeletalAnimation\r\n\r\n// Bones are a hierarchical tree\r\n\r\n// bonesWeights\r\n// bonesIndices\r\n\r\n// MorphTarget Animation\r\n\r\n// MorphTargets are a copy of each face, being transformed over time\r\n\r\n// morphIndices\r\n// morphTargets = []; MorphTargets are a transformed copy of faces\r\n// morphNormals = [];\r\n\r\nexport { GeometryPropertyKeys };\r\nexport { Geometry };\r\nexport { isGeometry };\r\nexport { GeometryBase };\r\n\r\nenum GeometryPropertyKeys {\r\n    vertices,\r\n    indices,\r\n    uvs,\r\n    facesNormals,\r\n    verticesNormals,\r\n    tangents,\r\n    bitangents\r\n}\r\n\r\n\r\ninterface GeometryConstructor {\r\n\r\n}\r\n\r\ninterface Geometry {\r\n    readonly isGeometry: true;\r\n    readonly uuid: UUID;\r\n    \r\n    indices: TypedArray;\r\n    vertices: Vector3List;\r\n    faces: TriangleList;\r\n    uvs: Vector2List;\r\n\r\n    facesNormals: Vector3List;\r\n    verticesNormals: Vector3List;\r\n    tangents: Vector3List;\r\n    bitangents: Vector3List;\r\n\r\n    [attrib: string]: any;\r\n\r\n    readonly boundingBox?: BoundingBox;\r\n    readonly boundingSphere?: BoundingSphere;\r\n\r\n    //builder(): GeometryBuilder;\r\n\r\n    //readonly changes: SingleTopicMessageSubscriber<{prop: GeometryPropertyKeys, section: BufferSectionValues}>;\r\n    \r\n    //copy(geometry: Geometry): Geometry;\r\n    //clone(): Geometry;\r\n\r\n    //computeFacesNormals(options?: ListLoopOptions): Geometry;\r\n    //computeVerticesNormals(weighted?: boolean, options?: ListLoopOptions): Geometry;\r\n    //computeTangentsAndBitangents(options?: ListLoopOptions): Geometry;\r\n\r\n\tcomputeBoundingBox(): BoundingBox;\r\n    computeBoundingSphere(): BoundingSphere;\r\n    \r\n    //updateVertices(vertices: TypedArray, offset?: number): Geometry;\r\n    //updateUvs(uvs: TypedArray, offset?: number): Geometry;\r\n}\r\n\r\nfunction isGeometry(obj: any): obj is Geometry {\r\n    return (obj as Geometry).isGeometry;\r\n}\r\n\r\nclass GeometryBase implements Geometry {\r\n\r\n    public readonly uuid: UUID;\r\n    public readonly isGeometry: true;\r\n    \r\n    private _boundingBox?: BoundingBox;\r\n    private _boundingSphere?: BoundingSphere;\r\n\r\n    private _indicesArray: TypedArray;\r\n\r\n    private _verticesArray: TypedArray;\r\n    private _vertices: Vector3List;\r\n    private _faces: TriangleList;\r\n\r\n    private _uvsArray: TypedArray;\r\n    private _uvs: Vector2List;\r\n\r\n    private _facesNormalsArray: TypedArray;\r\n    private _facesNormals: Vector3List;\r\n\r\n    private _verticesNormalsArray: TypedArray;\r\n    private _verticesNormals: Vector3List;\r\n\r\n    private _tangentsArray: TypedArray;\r\n    private _tangents: Vector3List;\r\n\r\n    private _bitangentsArray: TypedArray;\r\n    private _bitangents: Vector3List;\r\n\r\n    private _weightedVerticesNormals: boolean;\r\n\r\n    constructor(desc: {\r\n        vertices: TypedArray;\r\n        indices: TypedArray;\r\n        uvs: TypedArray;\r\n        weightedVerticesNormals?: boolean\r\n    }) {\r\n        this.uuid = UUIDGenerator.newUUID();\r\n        this.isGeometry = true;\r\n        \r\n        this._verticesArray = desc.vertices;\r\n        this._vertices = new Vector3List(this._verticesArray);\r\n        this._faces = new TriangleList(this._verticesArray);\r\n\r\n        this._indicesArray = desc.indices;\r\n\r\n        this._uvsArray = desc.uvs;\r\n        this._uvs = new Vector2List(this._uvsArray);\r\n\r\n        this._weightedVerticesNormals = desc.weightedVerticesNormals || false;\r\n\r\n        this._facesNormalsArray = GeometryUtils.computeFacesNormals(this._verticesArray, this._indicesArray, Float32Array);\r\n        this._facesNormals = new Vector3List(this._facesNormalsArray);\r\n        \r\n        this._verticesNormalsArray = GeometryUtils.computeVerticesNormals(this._verticesArray, this._indicesArray, this._weightedVerticesNormals, Float32Array, this._facesNormalsArray);\r\n        this._verticesNormals = new Vector3List(this._verticesNormalsArray);\r\n        \r\n        const { tangentsArray, bitangentsArray } = GeometryUtils.computeTangentsAndBitangents(this._verticesArray, this._uvsArray, this._indicesArray, Float32Array);\r\n        this._tangentsArray = tangentsArray;\r\n        this._bitangentsArray = bitangentsArray;\r\n        this._tangents = new Vector3List(this._tangentsArray);\r\n        this._bitangents = new Vector3List(this._bitangentsArray);\r\n    }\r\n\r\n    /*public builder(): GeometryBuilder {\r\n        return new GeometryBuilderBase(this);\r\n    }*/\r\n\r\n    public get indices(): TypedArray {\r\n        return this._indicesArray;\r\n    }\r\n\r\n    public get vertices(): Vector3List {\r\n        return this._vertices;\r\n    }\r\n\r\n    public get uvs(): Vector2List {\r\n        return this._uvs;\r\n    }\r\n\r\n    public get faces(): TriangleList {\r\n        return this._faces;\r\n    }\r\n\r\n    public get facesNormals(): Vector3List {\r\n        return this._facesNormals;\r\n    }\r\n\r\n    public get verticesNormals(): Vector3List {\r\n        return this._verticesNormals;\r\n    }\r\n\r\n    public get tangents(): Vector3List {\r\n        return this._tangents;\r\n    }\r\n\r\n    public get bitangents(): Vector3List {\r\n        return this._bitangents;\r\n    }\r\n\r\n    public get boundingBox(): BoundingBox | undefined {\r\n        return this._boundingBox;\r\n    }\r\n    \r\n\tpublic get boundingSphere(): BoundingSphere | undefined {\r\n        return this._boundingSphere;\r\n    }\r\n\r\n    /*public copy(geometry: GeometryBase): GeometryBase {\r\n        this._verticesArray = geometry._verticesArray.slice();\r\n        this._indicesArray = geometry._indicesArray.slice();\r\n        this._uvsArray = geometry._uvsArray.slice();\r\n        this._facesNormalsArray = geometry._facesNormalsArray.slice();\r\n        this._verticesNormalsArray = geometry._verticesNormalsArray.slice();\r\n        this._tangentsArray = geometry._tangentsArray.slice();\r\n        this._bitangentsArray = geometry._bitangentsArray.slice();\r\n\r\n        if (typeof geometry._boundingBox !== 'undefined') {\r\n            this.computeBoundingBox();\r\n        }\r\n\r\n        if (typeof geometry._boundingSphere !== 'undefined') {\r\n            this.computeBoundingSphere();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    public updateVertices(vertices: TypedArray, offset: number = 0): GeometryBase {\r\n        const idxFrom = offset;\r\n        const idxTo = offset + vertices.length;\r\n        this._verticesArray.set(vertices, offset);\r\n        this._updateFacesNormals({idxFrom, idxTo});\r\n        this._updateVerticesNormals(this._weightedVerticesNormals, {idxFrom, idxTo});\r\n        //this._changes.publish({prop: GeometryPropertyKeys.vertices, section: [idxFrom, idxTo]});\r\n        return this;\r\n    }\r\n\r\n    public updateUvs(uvs: TypedArray, offset: number = 0): GeometryBase {\r\n        const idxFrom = offset;\r\n        const idxTo = offset + uvs.length;\r\n        this._uvsArray.set(uvs, offset);\r\n        if (typeof this._tangents !== 'undefined') {\r\n            this._updateTangentsAndBitangents({idxFrom, idxTo});\r\n        }\r\n        //this._changes.publish({prop: GeometryPropertyKeys.uvs, section: [idxFrom, idxTo]});\r\n        return this;\r\n    }\r\n\r\n    public clone(): GeometryBase {\r\n        return new GeometryBase({\r\n            vertices: this._verticesArray.slice(),\r\n            indices: this._indicesArray.slice(),\r\n            uvs: this._uvsArray.slice()\r\n        }).copy(this);\r\n    }\r\n\r\n    private _updateFacesNormals(options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): GeometryBase {\r\n        GeometryUtils.computeFacesNormals(this._faces,  this._indicesArray, this._facesNormals, options);\r\n        //this._changes.publish({prop: GeometryPropertyKeys.facesNormals, section: [options?.idxFrom || 0, options?.idxTo || this._facesNormals.buffer.length]});\r\n        return this;\r\n    }\r\n\r\n    private _updateVerticesNormals(weighted: boolean = false, options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): GeometryBase {\r\n        this._weightedVerticesNormals = weighted;\r\n        if (typeof this.facesNormals === 'undefined') {\r\n            this._updateFacesNormals();\r\n        }\r\n        GeometryUtils.computeVerticesNormals(this._vertices, this._faces, this._indicesArray, this._facesNormals!, this._verticesNormals, weighted, options);\r\n        //this._changes.publish({prop: GeometryPropertyKeys.verticesNormals, section: [options?.idxFrom || 0, options?.idxTo || this._verticesNormals.buffer.length]});\r\n        return this;\r\n    }\r\n\r\n    private _updateTangentsAndBitangents(options?: {\r\n        idxFrom: number;\r\n        idxTo: number;\r\n    }): GeometryBase {\r\n        //this._changes.publish({prop: GeometryPropertyKeys.tangents, section: [options?.idxFrom || 0, options?.idxTo || this._tangents.buffer.length]});\r\n        //this._changes.publish({prop: GeometryPropertyKeys.bitangents, section: [options?.idxFrom || 0, options?.idxTo || this._bitangents.buffer.length]});\r\n        GeometryUtils.computeTangentsAndBitangents(this._verticesArray, this._uvsArray, this._indicesArray, this._tangentsArray, this._bitangentsArray, options);\r\n        return this;\r\n    }*/\r\n    \r\n\tpublic computeBoundingBox(): BoundingBox {\r\n        if (this._boundingBox === undefined) {\r\n            this._boundingBox = new BoundingBox().setFromPoints(this._vertices);\r\n        }\r\n        else {\r\n            this._boundingBox.setFromPoints(this._vertices);\r\n        }\r\n        return this._boundingBox;\r\n    }\r\n    \r\n\tpublic computeBoundingSphere(): BoundingSphere {\r\n        if (this._boundingSphere === undefined) {\r\n            this._boundingSphere = new BoundingSphere().setFromPoints(this._vertices);\r\n        }\r\n        else {\r\n            this._boundingSphere.setFromPoints(this._vertices);\r\n        }\r\n        return this._boundingSphere;\r\n    }\r\n}","import { buildArrayFromIndexedArrays } from \"../../../../../utils/Snippets\";\r\nimport { GeometryBase } from \"../geometry\";\r\n\r\nexport { QuadGeometry };\r\n\r\nclass QuadGeometry extends GeometryBase {\r\n\r\n\tconstructor() {\r\n\t\tsuper({\r\n\t\t\tvertices: new Float32Array(quadVertices),\r\n\t\t\tuvs: new Float32Array(quadUVS),\r\n\t\t\tindices: new Uint8Array(quadIndices)\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\n/**      \r\n *     y axis  \r\n * \t      ^   z axis\r\n *     UP |   ^  FORWARD\r\n *        | /\r\n *        +------> x axis\r\n *         RIGHT\r\n * \r\n *  left-handed coordinates system\r\n *  \r\n */\r\n\r\n /**      \r\n *      v0       v1\r\n * \t\t+_______+      o   ^ \r\n * \t    \\      /\\     /     \\\r\n *       \\   /   \\    \\     / \r\n *        \\/      \\    \\ _ /\r\n *        +--------+\r\n *       v2         v3\r\n * \r\n *  counter-clockwise winding order:\r\n * \t\tv0 -> v2 -> v1\r\n * \t\tv1 -> v2 -> v3\r\n */\r\n/**\r\n *     v0_______v1\r\n *     |\\        |\r\n *     |  \\   f1 |\r\n *     |    \\    |\r\n *     |  f0  \\  |\r\n *    v2_______\\v3\r\n *  \r\n * v0 = [-1, +1, -1]\r\n * v1 = [+1, +1, -1]\r\n * v2 = [-1, +1, +1]\r\n * v3 = [+1, +1, +1]\r\n */\r\n/**\r\n * \ttexture mappings\r\n * \r\n *           \r\n *    uv0_____uv1\r\n *    | \\       |\r\n *    |   \\     |\r\n *    |     \\   |\r\n *    |       \\ |\r\n *    uv2_____uv3\r\n *        \r\n * \r\n * uv0 = [0,0]\r\n * uv1 = [1,0]\r\n * uv2 = [0,1]\r\n * uv3 = [1,1]\r\n */\r\n\r\nconst quadVerticesSet = [\r\n\t[-1, +1, 1], // v0\r\n\t[+1, +1, 1], // v1\r\n\t[-1, -1, 1], // v2\r\n\t[+1, -1, 1], // v3\r\n];\r\n\r\nconst quadUVsSet = [\r\n\t[0, 0],\r\n\t[1, 0],\r\n\t[0, 1],\r\n\t[1, 1]\r\n];\r\n\r\nconst quadVertices = buildArrayFromIndexedArrays(\r\n\tquadVerticesSet,\r\n\t[\r\n\t\t0, 2, 3, 1, //  f0  f1\r\n\t]\r\n);\r\n\r\nconst quadUVS = buildArrayFromIndexedArrays(\r\n\tquadUVsSet,\r\n\t[\r\n\t\t0, 2, 3, 1, //  f0  f1\r\n\t]\r\n);\r\n\r\nconst quadIndices = [\r\n\t0, 1, 2, //  f0\r\n\t0, 2, 3, //  f1\r\n];","const gl = document.createElement('canvas').getContext('webgl2')!;\r\n\r\nexport { BlendingMode };\r\nexport { BlendingEquation };\r\nexport { BufferDataUsage };\r\nexport { BufferMask };\r\nexport { BufferMaskBit };\r\nexport { BufferBindingPoint };\r\nexport { BufferIndexType };\r\nexport { BufferInterpolation };\r\nexport { BufferTarget };\r\nexport { Capabilities };\r\nexport { CullFaceMode };\r\nexport { DrawMode };\r\nexport { DataType };\r\nexport { Error };\r\nexport { FramebufferAttachment };\r\nexport { FramebufferAttachmentParameter };\r\nexport { FramebufferTarget };\r\nexport { FramebufferTextureTarget };\r\nexport { FrontFace };\r\nexport { HintTarget };\r\nexport { HintMode };\r\nexport { Parameter };\r\nexport { PixelFormat };\r\nexport { PixelStorageMode };\r\nexport { PixelType };\r\nexport { RenderbufferTarget };\r\nexport { Shader };\r\nexport { ShaderType };\r\nexport { ShaderPrecision };\r\nexport { StencilAction };\r\nexport { TestFunction };\r\nexport { TextureUnits };\r\nexport { TextureParameter };\r\nexport { TextureTarget };\r\nexport { TextureMagFilter };\r\nexport { TextureMinFilter };\r\nexport { TextureWrapMode };\r\nexport { UniformQuery };\r\nexport { UniformType };\r\nexport { VertexAttribute };\r\n\r\nenum BlendingMode {\r\n    ZERO = gl.ZERO,\r\n    ONE = gl.ONE,\r\n    SRC_COLOR = gl.SRC_COLOR,\r\n    ONE_MINUS_SRC_COLOR = gl.ONE_MINUS_SRC_COLOR,\r\n    DST_COLOR = gl.DST_COLOR,\r\n    ONE_MINUS_DST_COLOR = gl.ONE_MINUS_DST_COLOR,\r\n    SRC_ALPHA = gl.SRC_ALPHA,\r\n    ONE_MINUS_SRC_ALPHA = gl.ONE_MINUS_SRC_ALPHA,\r\n    ONE_MINUS_DST_ALPHA = gl.ONE_MINUS_DST_ALPHA,\r\n    CONSTANT_COLOR = gl.CONSTANT_COLOR,\r\n    ONE_MINUS_CONSTANT_COLOR = gl.ONE_MINUS_CONSTANT_COLOR,\r\n    CONSTANT_ALPHA = gl.CONSTANT_ALPHA,\r\n    ONE_MINUS_CONSTANT_ALPHA = gl.ONE_MINUS_CONSTANT_ALPHA,\r\n    SRC_ALPHA_SATURATE = gl.SRC_ALPHA_SATURATE\r\n}\r\n\r\nenum BlendingEquation {\r\n    FUNC_ADD = gl.FUNC_ADD,\r\n    FUNC_SUBTRACT = gl.FUNC_SUBTRACT,\r\n    FUNC_REVERSE_SUBTRACT = gl.FUNC_REVERSE_SUBTRACT,\r\n    MIN = gl.MIN,\r\n    MAX = gl.MAX\r\n}\r\n\r\nenum BufferMaskBit {\r\n    DEPTH_BUFFER_BIT = gl.DEPTH_BUFFER_BIT,\r\n    STENCIL_BUFFER_BIT = gl.STENCIL_BUFFER_BIT,\r\n    COLOR_BUFFER_BIT = gl.COLOR_BUFFER_BIT\r\n}\r\n\r\nenum BufferMask {\r\n    DEPTH = gl.DEPTH,\r\n    STENCIL = gl.STENCIL,\r\n    COLOR = gl.COLOR,\r\n    DEPTH_STENCIL = gl.DEPTH_STENCIL\r\n}\r\n\r\nenum BufferDataUsage {\r\n    STATIC_DRAW = gl.STATIC_DRAW,\r\n    DYNAMIC_DRAW = gl.DYNAMIC_DRAW,\r\n    STREAM_DRAW = gl.STREAM_DRAW,\r\n    STATIC_READ = gl.STATIC_READ,\r\n    DYNAMIC_READ = gl.DYNAMIC_READ,\r\n    STREAM_READ = gl.STREAM_READ,\r\n    STATIC_COPY = gl.STATIC_COPY,\r\n    DYNAMIC_COPY = gl.DYNAMIC_COPY,\r\n    STREAM_COPY = gl.STREAM_COPY\r\n}\r\n\r\nenum BufferBindingPoint {\r\n    ARRAY_BUFFER = gl.ARRAY_BUFFER,\r\n    ELEMENT_ARRAY_BUFFER = gl.ELEMENT_ARRAY_BUFFER,\r\n    COPY_READ_BUFFER = gl.COPY_READ_BUFFER,\r\n    COPY_WRITE_BUFFER = gl.COPY_WRITE_BUFFER,\r\n    TRANSFORM_FEEDBACK_BUFFER = gl.TRANSFORM_FEEDBACK_BUFFER,\r\n    UNIFORM_BUFFER = gl.UNIFORM_BUFFER,\r\n    PIXEL_PACK_BUFFER = gl.PIXEL_PACK_BUFFER,\r\n    PIXEL_UNPACK_BUFFER = gl.PIXEL_UNPACK_BUFFER\r\n}\r\n\r\nenum BufferIndexType {\r\n    UNSIGNED_BYTE = gl.UNSIGNED_BYTE,\r\n    UNSIGNED_SHORT = gl.UNSIGNED_SHORT,\r\n    UNSIGNED_INT = gl.UNSIGNED_INT,\r\n}\r\n\r\nenum BufferInterpolation {\r\n    LINEAR = gl.LINEAR,\r\n    NEAREST = gl.NEAREST\r\n}\r\n\r\nenum BufferTarget {\r\n    ARRAY_BUFFER = gl.ARRAY_BUFFER,\r\n    ELEMENT_ARRAY_BUFFER = gl.ELEMENT_ARRAY_BUFFER,\r\n    COPY_READ_BUFFER = gl.COPY_READ_BUFFER,\r\n    COPY_WRITE_BUFFER = gl.COPY_WRITE_BUFFER,\r\n    TRANSFORM_FEEDBACK_BUFFER = gl.TRANSFORM_FEEDBACK_BUFFER,\r\n    UNIFORM_BUFFER = gl.UNIFORM_BUFFER,\r\n    PIXEL_PACK_BUFFER = gl.PIXEL_PACK_BUFFER,\r\n    PIXEL_UNPACK_BUFFER = gl.PIXEL_UNPACK_BUFFER\r\n}\r\n\r\nenum Capabilities {\r\n    BLEND = gl.BLEND,\r\n    CULL_FACE = gl.CULL_FACE,\r\n    DEPTH_TEST = gl.DEPTH_TEST,\r\n    DITHER = gl.DITHER,\r\n    POLYGON_OFFSET_FILL = gl.POLYGON_OFFSET_FILL,\r\n    SAMPLE_ALPHA_TO_COVERAGE = gl.SAMPLE_ALPHA_TO_COVERAGE,\r\n    SAMPLE_COVERAGE = gl.SAMPLE_COVERAGE,\r\n    SCISSOR_TEST = gl.SCISSOR_TEST,\r\n    STENCIL_TEST= gl.STENCIL_TEST,\r\n    RASTERIZER_DISCARD = gl.RASTERIZER_DISCARD\r\n}\r\n\r\nenum CullFaceMode {\r\n    FRONT = gl.FRONT,\r\n    BACK = gl.BACK,\r\n    FRONT_AND_BACK = gl.FRONT_AND_BACK\r\n}\r\n\r\nenum DrawMode {\r\n    POINTS = gl.POINTS,\r\n    LINE_STRIP = gl.LINE_STRIP,\r\n    LINE_LOOP = gl.LINE_LOOP,\r\n    LINES = gl.LINES,\r\n    TRIANGLE_STRIP = gl.TRIANGLE_STRIP,\r\n    TRIANGLE_FAN = gl.TRIANGLE_FAN,\r\n    TRIANGLES = gl.TRIANGLES \r\n}\r\n\r\nenum DataType {\r\n    BYTE = gl.BYTE,\r\n    SHORT = gl.SHORT,\r\n    UNSIGNED_BYTE = gl.UNSIGNED_BYTE,\r\n    UNSIGNED_SHORT = gl.UNSIGNED_SHORT,\r\n    FLOAT = gl.FLOAT,\r\n    HALF_FLOAT = gl.HALF_FLOAT \r\n}\r\n\r\nenum Error {\r\n    NO_ERROR = gl.NO_ERROR,\r\n    INVALID_ENUM = gl.INVALID_ENUM,\r\n    INVALID_OPERATION = gl.INVALID_OPERATION,\r\n    OUT_OF_MEMORY = gl.OUT_OF_MEMORY,\r\n    CONTEXT_LOST_WEBGL = gl.CONTEXT_LOST_WEBGL\r\n}\r\n\r\nenum FramebufferAttachment {\r\n    COLOR_ATTACHMENT0 = gl.COLOR_ATTACHMENT0,\r\n    COLOR_ATTACHMENT1 = gl.COLOR_ATTACHMENT1,\r\n    COLOR_ATTACHMENT2 = gl.COLOR_ATTACHMENT2,\r\n    COLOR_ATTACHMENT3 = gl.COLOR_ATTACHMENT3,\r\n    COLOR_ATTACHMENT4 = gl.COLOR_ATTACHMENT4,\r\n    COLOR_ATTACHMENT5 = gl.COLOR_ATTACHMENT5,\r\n    COLOR_ATTACHMENT6 = gl.COLOR_ATTACHMENT6,\r\n    COLOR_ATTACHMENT7 = gl.COLOR_ATTACHMENT7,\r\n    COLOR_ATTACHMENT8 = gl.COLOR_ATTACHMENT8,\r\n    COLOR_ATTACHMENT9 = gl.COLOR_ATTACHMENT9,\r\n    COLOR_ATTACHMENT10 = gl.COLOR_ATTACHMENT10,\r\n    COLOR_ATTACHMENT11 = gl.COLOR_ATTACHMENT11,\r\n    COLOR_ATTACHMENT12 = gl.COLOR_ATTACHMENT12,\r\n    COLOR_ATTACHMENT13 = gl.COLOR_ATTACHMENT13,\r\n    COLOR_ATTACHMENT14 = gl.COLOR_ATTACHMENT14,\r\n    COLOR_ATTACHMENT15 = gl.COLOR_ATTACHMENT15,\r\n    DEPTH_ATTACHMENT = gl.DEPTH_ATTACHMENT,\r\n    STENCIL_ATTACHMENT = gl.STENCIL_ATTACHMENT,\r\n    DEPTH_STENCIL_ATTACHMENT = gl.DEPTH_STENCIL_ATTACHMENT,\r\n}\r\n\r\nenum FramebufferAttachmentParameter {\r\n    FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE = gl.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE,\r\n    FRAMEBUFFER_ATTACHMENT_OBJECT_NAME = gl.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME,\r\n    FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL = gl.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL,\r\n    FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE = gl.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE,\r\n    FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE = gl.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE,\r\n    FRAMEBUFFER_ATTACHMENT_BLUE_SIZE = gl.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE,\r\n    FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING = gl.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING,\r\n    FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE = gl.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE,\r\n    FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE = gl.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE,\r\n    FRAMEBUFFER_ATTACHMENT_GREEN_SIZE = gl.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE,\r\n    FRAMEBUFFER_ATTACHMENT_RED_SIZE = gl.FRAMEBUFFER_ATTACHMENT_RED_SIZE,\r\n    FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE = gl.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE,\r\n    FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER = gl.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER\r\n}\r\n\r\nenum FramebufferTarget {\r\n    FRAMEBUFFER = gl.FRAMEBUFFER,\r\n    DRAW_FRAMEBUFFER = gl.DRAW_FRAMEBUFFER,\r\n    READ_FRAMEBUFFER = gl.READ_FRAMEBUFFER\r\n}\r\n\r\nenum FramebufferTextureTarget {\r\n    TEXTURE_2D = gl.TEXTURE_2D,\r\n    TEXTURE_CUBE_MAP_POSITIVE_X = gl.TEXTURE_CUBE_MAP_POSITIVE_X,\r\n    TEXTURE_CUBE_MAP_NEGATIVE_X = gl.TEXTURE_CUBE_MAP_NEGATIVE_X,\r\n    TEXTURE_CUBE_MAP_POSITIVE_Y = gl.TEXTURE_CUBE_MAP_POSITIVE_Y,\r\n    TEXTURE_CUBE_MAP_NEGATIVE_Y = gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,\r\n    TEXTURE_CUBE_MAP_POSITIVE_Z = gl.TEXTURE_CUBE_MAP_POSITIVE_Z,\r\n    TEXTURE_CUBE_MAP_NEGATIVE_Z = gl.TEXTURE_CUBE_MAP_NEGATIVE_Z\r\n}\r\n\r\nenum FrontFace {\r\n    CW = gl.CW,\r\n    CCW = gl.CCW\r\n}\r\n\r\nenum HintTarget {\r\n    GENERATE_MIPMAP_HINT = gl.GENERATE_MIPMAP_HINT,\r\n    FRAGMENT_SHADER_DERIVATIVE_HINT = gl.FRAGMENT_SHADER_DERIVATIVE_HINT\r\n}\r\n\r\nenum HintMode {\r\n    FASTEST = gl.FASTEST,\r\n    NICEST = gl.NICEST,\r\n    DONT_CARE = gl.DONT_CARE\r\n}\r\n\r\nenum Parameter {\r\n    ACTIVE_TEXTURE = gl.ACTIVE_TEXTURE,\t\r\n    ALIASED_LINE_WIDTH_RANGE = gl.ALIASED_LINE_WIDTH_RANGE,\r\n    ALIASED_POINT_SIZE_RANGE = gl.ALIASED_POINT_SIZE_RANGE,\r\n    ALPHA_BITS = gl.ALPHA_BITS,\r\n    ARRAY_BUFFER_BINDING = gl.ARRAY_BUFFER_BINDING,\r\n    BLEND = gl.BLEND,\r\n    BLEND_COLOR = gl.BLEND_COLOR,\r\n    BLEND_DST_ALPHA = gl.BLEND_DST_ALPHA,\r\n    BLEND_DST_RGB = gl.BLEND_DST_RGB,\r\n    BLEND_EQUATION = gl.BLEND_EQUATION,\r\n    BLEND_EQUATION_ALPHA = gl.BLEND_EQUATION_ALPHA,\r\n    BLEND_EQUATION_RGB = gl.BLEND_EQUATION_RGB,\r\n    BLEND_SRC_ALPHA = gl.BLEND_SRC_ALPHA,\r\n    BLEND_SRC_RGB = gl.BLEND_SRC_RGB,\r\n    BLUE_BITS = gl.BLUE_BITS,\r\n    COLOR_CLEAR_VALUE = gl.COLOR_CLEAR_VALUE,\r\n    COLOR_WRITEMASK = gl.COLOR_WRITEMASK,\r\n    COMPRESSED_TEXTURE_FORMATS = gl.COMPRESSED_TEXTURE_FORMATS,\r\n    CULL_FACE = gl.CULL_FACE,\r\n    CULL_FACE_MODE = gl.CULL_FACE_MODE,\r\n    CURRENT_PROGRAM = gl.CURRENT_PROGRAM,\r\n    DEPTH_BITS = gl.DEPTH_BITS,\r\n    DEPTH_CLEAR_VALUE = gl.DEPTH_CLEAR_VALUE,\r\n    DEPTH_FUNC = gl.DEPTH_FUNC,\r\n    DEPTH_RANGE = gl.DEPTH_RANGE,\r\n    DEPTH_TEST = gl.DEPTH_TEST,\r\n    DEPTH_WRITEMASK = gl.DEPTH_WRITEMASK,\r\n    DITHER = gl.DITHER,\r\n    ELEMENT_ARRAY_BUFFER_BINDING = gl.ELEMENT_ARRAY_BUFFER_BINDING,\r\n    FRAMEBUFFER_BINDING = gl.FRAMEBUFFER_BINDING,\r\n    FRONT_FACE = gl.FRONT_FACE,\r\n    GENERATE_MIPMAP_HINT = gl.GENERATE_MIPMAP_HINT,\r\n    GREEN_BITS = gl.GREEN_BITS,\t\r\n    IMPLEMENTATION_COLOR_READ_FORMAT = gl.IMPLEMENTATION_COLOR_READ_FORMAT,\t\r\n    IMPLEMENTATION_COLOR_READ_TYPE = gl.IMPLEMENTATION_COLOR_READ_TYPE,\t\r\n    LINE_WIDTH = gl.LINE_WIDTH,\r\n    MAX_COMBINED_TEXTURE_IMAGE_UNITS = gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS,\t\r\n    MAX_CUBE_MAP_TEXTURE_SIZE = gl.MAX_CUBE_MAP_TEXTURE_SIZE,\r\n    MAX_FRAGMENT_UNIFORM_VECTORS = gl.MAX_FRAGMENT_UNIFORM_VECTORS,\t\r\n    MAX_RENDERBUFFER_SIZE = gl.MAX_RENDERBUFFER_SIZE,\t\r\n    MAX_TEXTURE_IMAGE_UNITS = gl.MAX_TEXTURE_IMAGE_UNITS,\r\n    MAX_TEXTURE_SIZE = gl.MAX_TEXTURE_SIZE,\r\n    MAX_VARYING_VECTORS = gl.MAX_VARYING_VECTORS,\t\r\n    MAX_VERTEX_ATTRIBS = gl.MAX_VERTEX_ATTRIBS,\r\n    MAX_VERTEX_UNIFORM_VECTORS = gl.MAX_VERTEX_UNIFORM_VECTORS,\r\n    MAX_VIEWPORT_DIMS = gl.MAX_VIEWPORT_DIMS,\t\r\n    PACK_ALIGNMENT = gl.PACK_ALIGNMENT,\r\n    POLYGON_OFFSET_FACTOR = gl.POLYGON_OFFSET_FACTOR,\r\n    POLYGON_OFFSET_FILL = gl.POLYGON_OFFSET_FILL,\t\r\n    POLYGON_OFFSET_UNITS = gl.POLYGON_OFFSET_UNITS,\t\r\n    RED_BITS = gl.RED_BITS,\r\n    RENDERBUFFER_BINDING = gl.RENDERBUFFER_BINDING,\r\n    RENDERER = gl.RENDERER,\r\n    SAMPLE_BUFFERS = gl.SAMPLE_BUFFERS,\t\r\n    SAMPLE_COVERAGE_INVERT = gl.SAMPLE_COVERAGE_INVERT,\r\n    SAMPLE_COVERAGE_VALUE = gl.SAMPLE_COVERAGE_VALUE,\r\n    SAMPLES = gl.SAMPLES,\r\n    SCISSOR_BOX = gl.SCISSOR_BOX,\r\n    SCISSOR_TEST = gl.SCISSOR_TEST,\r\n    SHADING_LANGUAGE_VERSION = gl.SHADING_LANGUAGE_VERSION,\t\r\n    STENCIL_BACK_FAIL = gl.STENCIL_BACK_FAIL,\t\r\n    STENCIL_BACK_FUNC = gl.STENCIL_BACK_FUNC,\r\n    STENCIL_BACK_PASS_DEPTH_FAIL = gl.STENCIL_BACK_PASS_DEPTH_FAIL,\t\r\n    STENCIL_BACK_PASS_DEPTH_PASS = gl.STENCIL_BACK_PASS_DEPTH_PASS,\t\r\n    STENCIL_BACK_REF = gl.STENCIL_BACK_REF,\r\n    STENCIL_BACK_VALUE_MASK = gl.STENCIL_BACK_VALUE_MASK,\r\n    STENCIL_BACK_WRITEMASK = gl.STENCIL_BACK_WRITEMASK,\r\n    STENCIL_BITS = gl.STENCIL_BITS,\r\n    STENCIL_CLEAR_VALUE = gl.STENCIL_CLEAR_VALUE,\r\n    STENCIL_FAIL = gl.STENCIL_FAIL,\r\n    STENCIL_FUNC = gl.STENCIL_FUNC,\r\n    STENCIL_PASS_DEPTH_FAIL = gl.STENCIL_PASS_DEPTH_FAIL,\t\r\n    STENCIL_PASS_DEPTH_PASS = gl.STENCIL_PASS_DEPTH_PASS,\t\r\n    STENCIL_REF = gl.STENCIL_REF,\r\n    STENCIL_TEST = gl.STENCIL_TEST,\t\r\n    STENCIL_VALUE_MASK = gl.STENCIL_VALUE_MASK,\t\r\n    STENCIL_WRITEMASK = gl.STENCIL_WRITEMASK,\r\n    SUBPIXEL_BITS = gl.SUBPIXEL_BITS,\r\n    TEXTURE_BINDING_2D = gl.TEXTURE_BINDING_2D,\t\r\n    TEXTURE_BINDING_CUBE_MAP = gl.TEXTURE_BINDING_CUBE_MAP,\t\r\n    UNPACK_ALIGNMENT = gl.UNPACK_ALIGNMENT,\r\n    UNPACK_COLORSPACE_CONVERSION_WEBGL = gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,\r\n    UNPACK_FLIP_Y_WEBGL = gl.UNPACK_FLIP_Y_WEBGL,\r\n    UNPACK_PREMULTIPLY_ALPHA_WEBGL = gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,\r\n    VENDOR = gl.VENDOR,\r\n    VERSION = gl.VERSION,\r\n    VIEWPORT = gl.VIEWPORT,\r\n    COPY_READ_BUFFER_BINDING = gl.COPY_READ_BUFFER_BINDING,\r\n    COPY_WRITE_BUFFER_BINDING = gl.COPY_WRITE_BUFFER_BINDING,\r\n    DRAW_FRAMEBUFFER_BINDING = gl.DRAW_FRAMEBUFFER_BINDING,\r\n    FRAGMENT_SHADER_DERIVATIVE_HINT = gl.FRAGMENT_SHADER_DERIVATIVE_HINT,\r\n    MAX_3D_TEXTURE_SIZE = gl.MAX_3D_TEXTURE_SIZE,\r\n    MAX_ARRAY_TEXTURE_LAYERS = gl.MAX_ARRAY_TEXTURE_LAYERS,\r\n    MAX_CLIENT_WAIT_TIMEOUT_WEBGL = gl.MAX_CLIENT_WAIT_TIMEOUT_WEBGL,\r\n    MAX_COLOR_ATTACHMENTS = gl.MAX_COLOR_ATTACHMENTS,\r\n    MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS = gl.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,\r\n    MAX_COMBINED_UNIFORM_BLOCKS = gl.MAX_COMBINED_UNIFORM_BLOCKS,\r\n    MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS = gl.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,\r\n    MAX_DRAW_BUFFERS = gl.MAX_DRAW_BUFFERS,\r\n    MAX_ELEMENT_INDEX = gl.MAX_ELEMENT_INDEX,\r\n    MAX_ELEMENTS_INDICES = gl.MAX_ELEMENTS_INDICES,\r\n    MAX_ELEMENTS_VERTICES = gl.MAX_ELEMENTS_VERTICES,\t\r\n    MAX_FRAGMENT_INPUT_COMPONENTS = gl.MAX_FRAGMENT_INPUT_COMPONENTS,\r\n    MAX_FRAGMENT_UNIFORM_BLOCKS = gl.MAX_FRAGMENT_UNIFORM_BLOCKS,\r\n    MAX_FRAGMENT_UNIFORM_COMPONENTS = gl.MAX_FRAGMENT_UNIFORM_COMPONENTS,\r\n    MAX_PROGRAM_TEXEL_OFFSET = gl.MAX_PROGRAM_TEXEL_OFFSET,\r\n    MAX_SAMPLES = gl.MAX_SAMPLES,\r\n    MAX_SERVER_WAIT_TIMEOUT = gl.MAX_SERVER_WAIT_TIMEOUT,\r\n    MAX_TEXTURE_LOD_BIAS = gl.MAX_TEXTURE_LOD_BIAS,\r\n    MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS = gl.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,\r\n    MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS = gl.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,\r\n    MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS = gl.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,\t\r\n    MAX_UNIFORM_BLOCK_SIZE = gl.MAX_UNIFORM_BLOCK_SIZE,\r\n    MAX_UNIFORM_BUFFER_BINDINGS = gl.MAX_UNIFORM_BUFFER_BINDINGS,\r\n    MAX_VARYING_COMPONENTS = gl.MAX_VARYING_COMPONENTS,\r\n    MAX_VERTEX_OUTPUT_COMPONENTS = gl.MAX_VERTEX_OUTPUT_COMPONENTS,\r\n    MAX_VERTEX_UNIFORM_BLOCKS = gl.MAX_VERTEX_UNIFORM_BLOCKS,\r\n    MAX_VERTEX_UNIFORM_COMPONENTS = gl.MAX_VERTEX_UNIFORM_COMPONENTS,\r\n    MIN_PROGRAM_TEXEL_OFFSET = gl.MIN_PROGRAM_TEXEL_OFFSET,\r\n    PACK_ROW_LENGTH = gl.PACK_ROW_LENGTH,\r\n    PACK_SKIP_PIXELS = gl.PACK_SKIP_PIXELS,\r\n    PACK_SKIP_ROWS = gl.PACK_SKIP_ROWS,\r\n    PIXEL_PACK_BUFFER_BINDING = gl.PIXEL_PACK_BUFFER_BINDING,\r\n    PIXEL_UNPACK_BUFFER_BINDING = gl.PIXEL_UNPACK_BUFFER_BINDING,\r\n    RASTERIZER_DISCARD = gl.RASTERIZER_DISCARD,\r\n    READ_BUFFER = gl.READ_BUFFER,\r\n    READ_FRAMEBUFFER_BINDING = gl.READ_FRAMEBUFFER_BINDING,\r\n    SAMPLE_ALPHA_TO_COVERAGE = gl.SAMPLE_ALPHA_TO_COVERAGE,\r\n    SAMPLE_COVERAGE = gl.SAMPLE_COVERAGE,\r\n    SAMPLER_BINDING = gl.SAMPLER_BINDING,\r\n    TEXTURE_BINDING_2D_ARRAY = gl.TEXTURE_BINDING_2D_ARRAY,\r\n    TEXTURE_BINDING_3D = gl.TEXTURE_BINDING_3D,\r\n    TRANSFORM_FEEDBACK_ACTIVE = gl.TRANSFORM_FEEDBACK_ACTIVE,\r\n    TRANSFORM_FEEDBACK_BINDING = gl.TRANSFORM_FEEDBACK_BINDING,\r\n    TRANSFORM_FEEDBACK_BUFFER_BINDING = gl.TRANSFORM_FEEDBACK_BUFFER_BINDING,\r\n    TRANSFORM_FEEDBACK_PAUSED = gl.TRANSFORM_FEEDBACK_PAUSED,\r\n    UNIFORM_BUFFER_BINDING = gl.UNIFORM_BUFFER_BINDING,\r\n    UNIFORM_BUFFER_OFFSET_ALIGNMENT = gl.UNIFORM_BUFFER_OFFSET_ALIGNMENT,\r\n    UNPACK_IMAGE_HEIGHT = gl.UNPACK_IMAGE_HEIGHT,\r\n    UNPACK_ROW_LENGTH = gl.UNPACK_ROW_LENGTH,\r\n    UNPACK_SKIP_IMAGES = gl.UNPACK_SKIP_IMAGES,\r\n    UNPACK_SKIP_PIXELS = gl.UNPACK_SKIP_PIXELS,\r\n    UNPACK_SKIP_ROWS = gl.UNPACK_SKIP_ROWS,\r\n    VERTEX_ARRAY_BINDING = gl.VERTEX_ARRAY_BINDING\r\n}\r\n\r\nenum PixelFormat {\r\n    ALPHA = gl.ALPHA,\r\n    LUMINANCE = gl.LUMINANCE,\t \r\n    LUMINANCE_ALPHA = gl.LUMINANCE_ALPHA,\r\n    RGB\t= gl.RGB,\t \r\n    RGBA = gl.RGBA,\r\n    RGBA4 = gl.RGBA4,\r\n    RGB565 = gl.RGB565,\r\n    RGB5_A1 = gl.RGB5_A1,\r\n    DEPTH_COMPONENT = gl.DEPTH_COMPONENT,\r\n    DEPTH_STENCIL = gl.DEPTH_STENCIL,\r\n    STENCIL_INDEX8 = gl.STENCIL_INDEX8,\r\n    R8 = gl.R8,\r\n    R8UI = gl.R8UI,\r\n    R8I = gl.R8I,\r\n    R16UI = gl.R16UI,\r\n    R16I = gl.R16I,\r\n    R32UI = gl.R32UI,\r\n    R32I = gl.R32I,\r\n    RG8 = gl.RG8,\r\n    RG8UI = gl.RG8UI,\r\n    RG8I = gl.RG8I,\r\n    RG16UI = gl.RG16UI,\r\n    RG16I = gl.RG16I,\r\n    RG32UI = gl.RG32UI,\r\n    RG32I = gl.RG32I,\r\n    RGB8 = gl.RGB8,\r\n    RGBA8 = gl.RGBA8,\r\n    SRGB8_ALPHA8 = gl.SRGB8_ALPHA8,\r\n    RGB10_A2 = gl.RGB10_A2,\r\n    RGBA8UI = gl.RGBA8UI,\r\n    RGBA8I = gl.RGBA8I,\r\n    RGB10_A2UI = gl.RGB10_A2UI,\r\n    RGBA16UI = gl.RGBA16UI,\r\n    RGBA16I = gl.RGBA16I,\r\n    RGBA32I = gl.RGBA32I,\r\n    RGBA32UI = gl.RGBA32UI,\r\n    DEPTH_COMPONENT24 = gl.DEPTH_COMPONENT24,\r\n    DEPTH_COMPONENT32F = gl.DEPTH_COMPONENT32F,\r\n    DEPTH24_STENCIL8 = gl.DEPTH24_STENCIL8,\r\n    DEPTH32F_STENCIL8 = gl.DEPTH32F_STENCIL8\r\n}\r\n\r\nenum PixelStorageMode {\r\n    UNPACK_FLIP_Y_WEBGL = gl.UNPACK_FLIP_Y_WEBGL,\r\n    UNPACK_PREMULTIPLY_ALPHA_WEBGL = gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,\r\n    UNPACK_COLORSPACE_CONVERSION_WEBGL = gl.UNPACK_COLORSPACE_CONVERSION_WEBGL\r\n}\r\n\r\nenum PixelType {\r\n    BYTE = gl.BYTE,\r\n    FLOAT = gl.FLOAT,\r\n    FLOAT_32_UNSIGNED_INT_24_8_REV = gl.FLOAT_32_UNSIGNED_INT_24_8_REV,\r\n    HALF_FLOAT = gl.HALF_FLOAT,\r\n    INT = gl.INT,  \r\n    SHORT = gl.SHORT,\r\n    UNSIGNED_BYTE = gl.UNSIGNED_BYTE,\r\n    UNSIGNED_INT = gl.UNSIGNED_INT,\r\n    UNSIGNED_INT_2_10_10_10_REV = gl.UNSIGNED_INT_2_10_10_10_REV,\r\n    UNSIGNED_INT_10F_11F_11F_REV = gl.UNSIGNED_INT_10F_11F_11F_REV,\r\n    UNSIGNED_INT_5_9_9_9_REV = gl.UNSIGNED_INT_5_9_9_9_REV,\r\n    UNSIGNED_INT_24_8 = gl.UNSIGNED_INT_24_8,\r\n    UNSIGNED_SHORT = gl.UNSIGNED_SHORT,\r\n    UNSIGNED_SHORT_5_6_5 = gl.UNSIGNED_SHORT_5_6_5,\r\n    UNSIGNED_SHORT_4_4_4_4 = gl.UNSIGNED_SHORT_4_4_4_4,\r\n    UNSIGNED_SHORT_5_5_5_1 = gl.UNSIGNED_SHORT_5_5_5_1\r\n}\r\n\r\nenum RenderbufferTarget {\r\n    RENDERBUFFER = gl.RENDERBUFFER\r\n}\r\n\r\nenum Shader {\r\n    FRAGMENT_SHADER = gl.FRAGMENT_SHADER,\r\n    VERTEX_SHADER = gl.VERTEX_SHADER,\r\n    COMPILE_STATUS = gl.COMPILE_STATUS,\r\n    DELETE_STATUS = gl.DELETE_STATUS,\r\n    LINK_STATUS = gl.LINK_STATUS,\r\n    VALIDATE_STATUS = gl.VALIDATE_STATUS,\r\n    ATTACHED_SHADERS = gl.ATTACHED_SHADERS,\r\n    ACTIVE_ATTRIBUTES = gl.ACTIVE_ATTRIBUTES,\r\n    ACTIVE_UNIFORMS = gl.ACTIVE_UNIFORMS,\r\n    MAX_VERTEX_ATTRIBS = gl.MAX_VERTEX_ATTRIBS,\r\n    MAX_VERTEX_UNIFORM_VECTORS = gl.MAX_VERTEX_UNIFORM_VECTORS,\r\n    MAX_VARYING_VECTORS = gl.MAX_VARYING_VECTORS,\r\n    MAX_COMBINED_TEXTURE_IMAGE_UNITS = gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS,\r\n    MAX_VERTEX_TEXTURE_IMAGE_UNITS = gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS,\r\n    MAX_TEXTURE_IMAGE_UNITS = gl.MAX_TEXTURE_IMAGE_UNITS,\r\n    MAX_FRAGMENT_UNIFORM_VECTORS = gl.MAX_FRAGMENT_UNIFORM_VECTORS,\r\n    SHADER_TYPE = gl.SHADER_TYPE,\r\n    SHADING_LANGUAGE_VERSION = gl.SHADING_LANGUAGE_VERSION,\r\n    CURRENT_PROGRAM = gl.CURRENT_PROGRAM\r\n}\r\n\r\nenum ShaderType {\r\n    FRAGMENT_SHADER = gl.FRAGMENT_SHADER,\r\n    VERTEX_SHADER = gl.VERTEX_SHADER,\r\n}\r\n\r\nenum ShaderPrecision {\r\n    LOW_FLOAT = gl.LOW_FLOAT,\t \r\n    MEDIUM_FLOAT = gl.MEDIUM_FLOAT,\t \r\n    HIGH_FLOAT = gl.HIGH_FLOAT,\t \r\n    LOW_INT = gl.LOW_INT,\t \r\n    MEDIUM_INT = gl.MEDIUM_INT,\t \r\n    HIGH_INT = gl.HIGH_INT\r\n}\r\n\r\nenum StencilAction {\r\n    KEEP = gl.KEEP,\t \r\n    REPLACE\t= gl.REPLACE,\t \r\n    INCR = gl.INCR,\t \r\n    DECR = gl.DECR,\t \r\n    INVERT = gl.INVERT,\t \r\n    INCR_WRAP = gl.INCR_WRAP,\t \r\n    DECR_WRAP = gl.DECR_WRAP\r\n}\r\n\r\nenum TestFunction {\r\n    NEVER = gl.NEVER,\r\n    LESS = gl.LESS,\r\n    EQUAL = gl.EQUAL,\r\n    LEQUAL = gl.LEQUAL,\r\n    GREATER = gl.GREATER,\r\n    NOTEQUAL = gl.NOTEQUAL,\r\n    GEQUAL = gl.GEQUAL,\r\n    ALWAYS = gl.ALWAYS\r\n}\r\n\r\nenum TextureUnits {\r\n    TEXTURE = gl.TEXTURE,\r\n    TEXTURE0 = gl.TEXTURE0,\r\n}\r\n\r\nenum TextureParameter {\r\n    TEXTURE_MAG_FILTER = gl.TEXTURE_MAG_FILTER,\r\n    TEXTURE_MIN_FILTER = gl.TEXTURE_MIN_FILTER,\r\n    TEXTURE_WRAP_S = gl.TEXTURE_WRAP_S,\r\n    TEXTURE_WRAP_T = gl.TEXTURE_WRAP_T,\r\n    TEXTURE_BASE_LEVEL = gl.TEXTURE_BASE_LEVEL,\r\n    TEXTURE_MAX_LEVEL = gl.TEXTURE_MAX_LEVEL,\r\n    TEXTURE_MAX_LOD = gl.TEXTURE_MAX_LOD,\r\n    TEXTURE_MIN_LOD = gl.TEXTURE_MIN_LOD,\r\n    TEXTURE_WRAP_R = gl.TEXTURE_WRAP_R\r\n}\r\n\r\nenum TextureTarget {\r\n    TEXTURE_2D = gl.TEXTURE_2D,\r\n    TEXTURE_CUBE_MAP = gl.TEXTURE_CUBE_MAP,\r\n    TEXTURE_3D = gl.TEXTURE_3D,\r\n    TEXTURE_2D_ARRAY = gl.TEXTURE_2D_ARRAY,\r\n    TEXTURE_CUBE_MAP_POSITIVE_X = gl.TEXTURE_CUBE_MAP_POSITIVE_X,\r\n    TEXTURE_CUBE_MAP_NEGATIVE_X = gl.TEXTURE_CUBE_MAP_NEGATIVE_X,\r\n    TEXTURE_CUBE_MAP_POSITIVE_Y = gl.TEXTURE_CUBE_MAP_POSITIVE_Y,\r\n    TEXTURE_CUBE_MAP_NEGATIVE_Y = gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,\r\n    TEXTURE_CUBE_MAP_POSITIVE_Z = gl.TEXTURE_CUBE_MAP_POSITIVE_Z,\r\n    TEXTURE_CUBE_MAP_NEGATIVE_Z = gl.TEXTURE_CUBE_MAP_NEGATIVE_Z\r\n}\r\n\r\nenum TextureMagFilter {\r\n    LINEAR = gl.LINEAR,\r\n    NEAREST = gl.NEAREST\r\n}\r\n\r\nenum TextureMinFilter {\r\n    LINEAR = gl.LINEAR,\r\n    NEAREST = gl.NEAREST,\r\n    NEAREST_MIPMAP_NEAREST = gl.NEAREST_MIPMAP_NEAREST, \r\n    LINEAR_MIPMAP_NEAREST = gl.LINEAR_MIPMAP_NEAREST, \r\n    NEAREST_MIPMAP_LINEAR = gl.NEAREST_MIPMAP_LINEAR,\r\n    LINEAR_MIPMAP_LINEAR = gl.LINEAR_MIPMAP_LINEAR\r\n}\r\n\r\nenum TextureWrapMode {\r\n    REPEAT = gl.REPEAT,\r\n    CLAMP_TO_EDGE = gl.CLAMP_TO_EDGE, \r\n    MIRRORED_REPEAT = gl.MIRRORED_REPEAT\r\n}\r\n\r\nenum UniformQuery {\r\n    UNIFORM_TYPE = gl.UNIFORM_TYPE,\r\n    UNIFORM_SIZE = gl.UNIFORM_SIZE,\r\n    UNIFORM_BLOCK_INDEX = gl.UNIFORM_BLOCK_INDEX,\r\n    UNIFORM_OFFSET = gl.UNIFORM_OFFSET,\r\n    UNIFORM_ARRAY_STRIDE = gl.UNIFORM_ARRAY_STRIDE,\r\n    UNIFORM_MATRIX_STRIDE = gl.UNIFORM_MATRIX_STRIDE,\r\n    UNIFORM_IS_ROW_MAJOR = gl.UNIFORM_IS_ROW_MAJOR\r\n}\r\n\r\nenum UniformType {\r\n    BOOL = gl.BOOL,\t \r\n    BOOL_VEC2 = gl.BOOL_VEC2,\t \r\n    BOOL_VEC3 = gl.BOOL_VEC3,\t \r\n    BOOL_VEC4 = gl.BOOL_VEC4,\r\n    INT = gl.INT,\r\n    INT_VEC2 = gl.INT_VEC2,\t \r\n    INT_VEC3 = gl.INT_VEC3,\t \r\n    INT_VEC4 = gl.INT_VEC4,\t \r\n    INT_SAMPLER_2D = gl.INT_SAMPLER_2D,\r\n    INT_SAMPLER_3D = gl.INT_SAMPLER_3D,\r\n    INT_SAMPLER_CUBE = gl.INT_SAMPLER_CUBE,\r\n    INT_SAMPLER_2D_ARRAY = gl.INT_SAMPLER_2D_ARRAY,\r\n    UNSIGNED_INT_SAMPLER_2D = gl.UNSIGNED_INT_SAMPLER_2D,\r\n    UNSIGNED_INT_SAMPLER_3D = gl.UNSIGNED_INT_SAMPLER_3D,\r\n    UNSIGNED_INT_SAMPLER_CUBE = gl.UNSIGNED_INT_SAMPLER_CUBE,\r\n    UNSIGNED_INT_SAMPLER_2D_ARRAY = gl.UNSIGNED_INT_SAMPLER_2D_ARRAY,\r\n    UNSIGNED_INT = gl.UNSIGNED_INT,\r\n    UNSIGNED_INT_VEC2 = gl.UNSIGNED_INT_VEC2,\r\n    UNSIGNED_INT_VEC3 = gl.UNSIGNED_INT_VEC3,\r\n    UNSIGNED_INT_VEC4 = gl.UNSIGNED_INT_VEC4,\r\n    FLOAT = gl.FLOAT,\r\n    FLOAT_VEC2 = gl.FLOAT_VEC2,\t \r\n    FLOAT_VEC3 = gl.FLOAT_VEC3,\t \r\n    FLOAT_VEC4 = gl.FLOAT_VEC4,\r\n    FLOAT_MAT2 = gl.FLOAT_MAT2,\t \r\n    FLOAT_MAT3 = gl.FLOAT_MAT3,\t \r\n    FLOAT_MAT4 = gl.FLOAT_MAT4,\t \r\n    FLOAT_MAT2x3 = gl.FLOAT_MAT2x3,\r\n    FLOAT_MAT2x4 = gl.FLOAT_MAT2x4,\r\n    FLOAT_MAT3x2 = gl.FLOAT_MAT3x2,\r\n    FLOAT_MAT3x4 = gl.FLOAT_MAT3x4,\r\n    FLOAT_MAT4x2 = gl.FLOAT_MAT4x2,\r\n    FLOAT_MAT4x3 = gl.FLOAT_MAT4x3,\r\n    SAMPLER_2D = gl.SAMPLER_2D,\t \r\n    SAMPLER_3D = gl.SAMPLER_3D,\r\n    SAMPLER_CUBE = gl.SAMPLER_CUBE,\r\n    SAMPLER_2D_SHADOW = gl.SAMPLER_2D_SHADOW,\r\n    SAMPLER_2D_ARRAY = gl.SAMPLER_2D_ARRAY,\r\n    SAMPLER_2D_ARRAY_SHADOW = gl.SAMPLER_2D_ARRAY_SHADOW,\r\n    SAMPLER_CUBE_SHADOW = gl.SAMPLER_CUBE_SHADOW\r\n}\r\n\r\nenum VertexAttribute {\r\n    CURRENT_VERTEX_ATTRIB = gl.CURRENT_VERTEX_ATTRIB,\r\n    VERTEX_ATTRIB_ARRAY_ENABLED = gl.VERTEX_ATTRIB_ARRAY_ENABLED,\t \r\n    VERTEX_ATTRIB_ARRAY_SIZE = gl.VERTEX_ATTRIB_ARRAY_SIZE,\r\n    VERTEX_ATTRIB_ARRAY_STRIDE = gl.VERTEX_ATTRIB_ARRAY_STRIDE,\r\n    VERTEX_ATTRIB_ARRAY_TYPE = gl.VERTEX_ATTRIB_ARRAY_TYPE,\r\n    VERTEX_ATTRIB_ARRAY_NORMALIZED = gl.VERTEX_ATTRIB_ARRAY_NORMALIZED,\r\n    VERTEX_ATTRIB_ARRAY_POINTER = gl.VERTEX_ATTRIB_ARRAY_POINTER,\r\n    VERTEX_ATTRIB_ARRAY_BUFFER_BINDING = gl.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING\r\n}","import { FramebufferTarget, FramebufferAttachment, RenderbufferTarget, FramebufferTextureTarget, BufferMaskBit, TextureMagFilter } from \"./WebGLConstants\";\r\n\r\nexport { WebGLFramebufferUtilities };\r\n\r\ntype FramebufferReference = {\r\n    glFb: WebGLFramebuffer;\r\n}\r\n\r\ntype Framebuffer = FramebufferReference;\r\n\r\ntype FramebufferTextureAttachmentProperties = {\r\n    attachment: FramebufferAttachment;\r\n    texTarget: FramebufferTextureTarget;\r\n    glTex: WebGLTexture;\r\n}\r\n\r\ntype FramebufferTextureAttachment = FramebufferTextureAttachmentProperties & Framebuffer;\r\n\r\ntype FramebufferRenderbufferAttachmentProperties = {\r\n    attachment: FramebufferAttachment;\r\n    glRb: WebGLTexture;\r\n}\r\n\r\ntype FramebufferRenderbufferAttachment = FramebufferRenderbufferAttachmentProperties & Framebuffer;\r\n\r\nclass WebGLFramebufferUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static createFramebuffer(gl: WebGL2RenderingContext): Framebuffer | null {\r\n        const glFb = gl.createFramebuffer();\r\n    \r\n        if (glFb === null) {\r\n            console.error(`Could not create WebGLFramebuffer.`);\r\n            return null;\r\n        }\r\n        \r\n        return {\r\n            glFb: glFb\r\n        };\r\n    }\r\n\r\n    public static attachTexture(gl: WebGL2RenderingContext, fb: Framebuffer, props: FramebufferTextureAttachmentProperties): FramebufferTextureAttachment {\r\n        const target = FramebufferTarget.FRAMEBUFFER;\r\n        \r\n        gl.bindFramebuffer(target, fb.glFb);\r\n        gl.framebufferTexture2D(target, props.attachment, props.texTarget, props.glTex, 0);\r\n        gl.bindFramebuffer(target, null);\r\n\r\n        return {\r\n            ...props,\r\n            ...fb\r\n        };\r\n    }\r\n\r\n    public static attachTextures(gl: WebGL2RenderingContext, fb: Framebuffer, props: FramebufferTextureAttachmentProperties[]): FramebufferTextureAttachment[] {\r\n        const target = gl.FRAMEBUFFER;\r\n        \r\n        gl.bindFramebuffer(target, fb.glFb);\r\n\r\n        const attachments = props.map((props) => {\r\n            gl.framebufferTexture2D(target, props.attachment, props.texTarget, props.glTex, 0);\r\n            return {\r\n                ...props,\r\n                ...fb\r\n            };\r\n        });\r\n\r\n        gl.bindFramebuffer(target, null);\r\n\r\n        return attachments;\r\n    }\r\n\r\n    public static attachRenderbuffers(gl: WebGL2RenderingContext, fb: Framebuffer, props: FramebufferRenderbufferAttachmentProperties[]): FramebufferRenderbufferAttachment[] {\r\n        const target = gl.FRAMEBUFFER;\r\n        \r\n        gl.bindFramebuffer(target, fb.glFb);\r\n\r\n        const attachments = props.map((props) => {\r\n            gl.framebufferRenderbuffer(target, props.attachment, gl.RENDERBUFFER, props.glRb);\r\n            return {\r\n                ...props,\r\n                ...fb\r\n            };\r\n        });\r\n\r\n        gl.bindFramebuffer(target, null);\r\n\r\n        return attachments;\r\n    }\r\n\r\n    public static attachRenderbuffer(gl: WebGL2RenderingContext, fb: Framebuffer, props: FramebufferRenderbufferAttachmentProperties): FramebufferRenderbufferAttachment {\r\n        const target = gl.FRAMEBUFFER;\r\n        \r\n        gl.bindFramebuffer(target, fb.glFb);\r\n        gl.framebufferRenderbuffer(target, props.attachment, gl.RENDERBUFFER, props.glRb);\r\n        gl.bindFramebuffer(target, null);\r\n\r\n        return {\r\n            ...props,\r\n            ...fb\r\n        };\r\n    }\r\n\r\n    public static blit(gl: WebGL2RenderingContext, readFb: Framebuffer | null, drawFb: Framebuffer | null, readRec: Tuple<number, 4>, drawRec: Tuple<number, 4>, mask: BufferMaskBit, filter: TextureMagFilter): void {\r\n        gl.bindFramebuffer(gl.READ_FRAMEBUFFER, (readFb !== null) ? readFb.glFb : null);\r\n        gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, (drawFb !== null) ? drawFb.glFb : null);\r\n        gl.blitFramebuffer(readRec[0], readRec[1], readRec[2], readRec[3], drawRec[0], drawRec[1], drawRec[2], drawRec[3], mask, filter);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n\r\n    public static clearColor(gl: WebGL2RenderingContext, fb: Framebuffer, buff: Float32Array | Tuple<number, 4>, offset: number = 0): void {\r\n        gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, fb.glFb);\r\n        gl.clearBufferfv(gl.COLOR, 0, buff, offset);\r\n    }\r\n\r\n    public static clearDepthStencil(gl: WebGL2RenderingContext, fb: Framebuffer, depth: number, stencil: number): void {\r\n        gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, fb.glFb);\r\n        gl.clearBufferfi(gl.DEPTH_STENCIL, 0, depth, stencil);\r\n    }\r\n\r\n    public static checkFramebufferStatus(gl: WebGL2RenderingContext): number {\r\n        return gl.checkFramebufferStatus(gl.FRAMEBUFFER);\r\n    }\r\n\r\n    public static deleteFramebuffer(gl: WebGL2RenderingContext, fb: Framebuffer): void {\r\n        const glFb = fb.glFb;\r\n        if (gl.isFramebuffer(glFb)) {\r\n            gl.deleteFramebuffer(glFb);\r\n        }\r\n    }\r\n\r\n    public static bindFramebuffer(gl: WebGL2RenderingContext, fb: Framebuffer): void {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fb.glFb);\r\n    }\r\n\r\n    public static unbindFramebuffer(gl: WebGL2RenderingContext): void {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n}","export { WebGLBufferUtilities };\r\n\r\nclass WebGLBufferUtilities {\r\n\r\n    public static createBuffer(gl: WebGL2RenderingContext): WebGLBuffer | null {\r\n        const glBuff = gl.createBuffer();\r\n\r\n        if (glBuff == null) {\r\n            console.error(`Could not create WebGLBuffer.`);\r\n        }\r\n\r\n        return glBuff;\r\n    }\r\n}","import { DataType, BufferTarget, BufferDataUsage, BufferIndexType } from \"./WebGLConstants\";\r\nimport { WebGLBufferUtilities } from \"./WebGLBufferUtilities\";\r\nimport { WebGLVertexArrayUtilities } from \"./WebGLVertexArrayUtilities\";\r\n\r\nexport { AttributeArray };\r\nexport { AttributeIndicesArray };\r\nexport { AttributeNumComponents };\r\nexport { AttributeProperties };\r\nexport { Attribute };\r\nexport { AttributesList };\r\nexport { AttributeSetter };\r\nexport { AttributesListProperties };\r\nexport { AttributesSettersList };\r\nexport { WebGLAttributeUtilities };\r\n\r\ntype AttributeArray = TypedArray;\r\ntype AttributeIndicesArray = Uint8Array | Uint16Array | Uint32Array;\r\n\r\ntype AttributeNumComponents = 1 | 2 | 3 | 4;\r\ntype AttributeProperties<N extends AttributeNumComponents = AttributeNumComponents> = {\r\n    numComponents: N;\r\n    normalized?: boolean;\r\n    srcOffset?: number;\r\n    srcLength?: number; \r\n}\r\n\r\ntype Attribute<A extends AttributeArray = AttributeArray, N extends AttributeNumComponents = AttributeNumComponents> = {\r\n    array: A;\r\n    props: AttributeProperties<N>;\r\n}\r\n\r\ntype AttributesList = {\r\n    list: List<Attribute>;\r\n    indices?: AttributeIndicesArray;\r\n    props?: Partial<AttributesListProperties>;\r\n}\r\n\r\ntype AttributeSetter = {\r\n    location: number;\r\n    bufferBytesOffset: number;\r\n}\r\n\r\ntype AttributesListProperties = {\r\n    instanced: boolean;\r\n    divisor: number;\r\n    target: BufferTarget;\r\n    usage: BufferDataUsage;\r\n}\r\n\r\ntype AttributesSettersList = {\r\n    setters: List<AttributeSetter>;\r\n    props: AttributesListProperties;\r\n\r\n    bufferByteLength: number;\r\n    numElements: number;\r\n    hasIndices: boolean;\r\n    indexType: BufferIndexType;\r\n\r\n    glVao: WebGLVertexArrayObject;\r\n    glBuffer: WebGLBuffer;\r\n    glIndicesBuffer: WebGLBuffer;\r\n    glProg: WebGLProgram;\r\n}\r\n\r\nclass WebGLAttributeUtilities {\r\n\r\n    public static getAttributesListSetter(gl: WebGL2RenderingContext, glProg: WebGLProgram, list: AttributesList): AttributesSettersList | null {\r\n        \r\n        const glVao = WebGLVertexArrayUtilities.createVertexArray(gl);\r\n        if (glVao === null) {\r\n            return null;\r\n        }\r\n \r\n        const glBuffer = WebGLBufferUtilities.createBuffer(gl);\r\n        if (glBuffer === null) {\r\n            return null;\r\n        }\r\n\r\n        const glIndicesBuffer = WebGLBufferUtilities.createBuffer(gl);\r\n        if (glIndicesBuffer === null) {\r\n            return null;\r\n        }\r\n\r\n        const attributes = list.list;\r\n        \r\n        const props = list.props;\r\n        const instanced = props?.instanced || false;\r\n        const divisor = props?.divisor || 1;\r\n        const target = props?.target || BufferTarget.ARRAY_BUFFER;\r\n        const usage = props?.usage || BufferDataUsage.STATIC_DRAW;\r\n\r\n        const attributesNames = Object.keys(attributes);\r\n        const attributesValues = attributesNames.map(\r\n            (attributeName: string) => {\r\n                return attributes[attributeName];\r\n            }\r\n        );\r\n        \r\n        const numElements = (typeof list.indices !== \"undefined\") ? list.indices.length : this.getAttributesListNumElements(list);\r\n        const indexType = (typeof list.indices !== \"undefined\") ? this.getAttributeIndicesBufferType(list.indices) : BufferIndexType.UNSIGNED_SHORT;\r\n        \r\n        const settersList = {\r\n            setters: {}\r\n        } as AttributesSettersList;\r\n\r\n        let bufferByteLength = 0;\r\n        attributesValues.forEach((attr: Attribute) => {\r\n            bufferByteLength += attr.array.byteLength + (32 - attr.array.byteLength % 32) % 32;\r\n        });\r\n\r\n        let bufferBytesOffset = 0;\r\n\r\n        gl.bindVertexArray(glVao);\r\n        \r\n        gl.bindBuffer(target, glBuffer);\r\n        gl.bufferData(target, bufferByteLength, usage);\r\n\r\n        for (const name of attributesNames) {\r\n            const attribute = attributes[name];\r\n            const props = attribute.props;\r\n\r\n            const location = gl.getAttribLocation(glProg, name);\r\n            if (location == -1) {\r\n                console.warn(`Attribute ${name} could not be located.`);\r\n                continue;\r\n            }\r\n\r\n            gl.enableVertexAttribArray(location);\r\n\r\n            const type = this.getAttributeArrayDataType(attribute.array);\r\n            const normalized = (typeof props.normalized === \"undefined\") ? false : props.normalized;\r\n\r\n            gl.vertexAttribPointer(location, props.numComponents, type, normalized, 0, bufferBytesOffset);\r\n            \r\n            if (instanced) {\r\n                gl.vertexAttribDivisor(location, divisor);\r\n            }\r\n\r\n            settersList.setters[name] = {\r\n                location: location,\r\n                bufferBytesOffset: bufferBytesOffset\r\n            };\r\n\r\n            bufferBytesOffset += attribute.array.byteLength + (32 - attribute.array.byteLength % 32) % 32;\r\n        }\r\n\r\n        let hasIndices = false;\r\n        if (typeof list.indices !== \"undefined\") {\r\n            hasIndices = true;\r\n            gl.bindBuffer(BufferTarget.ELEMENT_ARRAY_BUFFER, glIndicesBuffer);\r\n            gl.bufferData(BufferTarget.ELEMENT_ARRAY_BUFFER, list.indices.byteLength, BufferDataUsage.STATIC_READ);\r\n        }\r\n        \r\n        gl.bindVertexArray(null);\r\n\r\n        settersList.glBuffer = glBuffer;\r\n        settersList.glIndicesBuffer = glIndicesBuffer;\r\n        settersList.glProg = glProg;\r\n        settersList.glVao = glVao;\r\n        settersList.props = {\r\n            instanced: instanced,\r\n            divisor: divisor,\r\n            target: target,\r\n            usage: usage\r\n        };\r\n        settersList.bufferByteLength = bufferByteLength;\r\n        settersList.numElements = numElements;\r\n        settersList.indexType = indexType;\r\n        settersList.hasIndices = hasIndices;\r\n\r\n        return settersList;\r\n    }\r\n\r\n    public static setAttributesListValues(gl: WebGL2RenderingContext, settersList: AttributesSettersList, list: AttributesList): void {\r\n\r\n        const attributes = list.list;\r\n        \r\n        gl.bindVertexArray(settersList.glVao);\r\n        gl.bindBuffer(settersList.props.target, settersList.glBuffer);\r\n\r\n        Object.keys(attributes).forEach((name) => {\r\n            const attribute = attributes[name];\r\n            const setter = settersList.setters[name];\r\n\r\n            const srcOffset = (typeof attribute.props.srcOffset === \"undefined\") ? 0 : attribute.props.srcOffset;\r\n            const srcLength = (typeof attribute.props.srcLength === \"undefined\") ? attribute.array.length : attribute.props.srcLength;\r\n\r\n            if (typeof setter !== \"undefined\") {\r\n                gl.bufferSubData(settersList.props.target, setter.bufferBytesOffset, attribute.array, srcOffset, srcLength);\r\n            }\r\n            else {\r\n                console.warn(`Attribute ${name} does not exist in the setters.`);\r\n            }\r\n        });\r\n\r\n        if (typeof list.indices !== \"undefined\") {\r\n            gl.bindBuffer(BufferTarget.ELEMENT_ARRAY_BUFFER, settersList.glIndicesBuffer);\r\n            gl.bufferSubData(BufferTarget.ELEMENT_ARRAY_BUFFER, 0, list.indices);\r\n        }\r\n\r\n        gl.bindVertexArray(null);\r\n    }\r\n\r\n    public static bindAttributesList(gl: WebGL2RenderingContext, settersList: AttributesSettersList): void {\r\n        gl.bindVertexArray(settersList.glVao);\r\n    }\r\n\r\n    public static unbindAttributesList(gl: WebGL2RenderingContext): void {\r\n        gl.bindVertexArray(null);\r\n    }\r\n\r\n    public static getAttributeArrayDataType(array: AttributeArray): DataType {\r\n        if (array instanceof Float32Array || array instanceof Int32Array || array instanceof Uint32Array) {\r\n            return DataType.FLOAT;\r\n        }\r\n        else if (array instanceof Int16Array) {\r\n            return DataType.SHORT;\r\n        }\r\n        else if (array instanceof Uint16Array) {\r\n            return DataType.UNSIGNED_SHORT;\r\n        }\r\n        else if (array instanceof Int8Array) {\r\n            return DataType.BYTE;\r\n        }\r\n        else if (array instanceof Uint8Array) {\r\n            return DataType.UNSIGNED_BYTE;\r\n        }\r\n        console.error(`Unsupported attribute array ${array.constructor.name}.`);\r\n        return -1;\r\n    }\r\n\r\n    public static getDataTypeByteLength(dataType: DataType): number {\r\n        switch (dataType) {\r\n            case DataType.FLOAT:\r\n                return 4;\r\n            case DataType.SHORT:\r\n            case DataType.UNSIGNED_SHORT:\r\n                return 2;\r\n            case DataType.BYTE:\r\n            case DataType.UNSIGNED_BYTE:\r\n                    return 1;\r\n        }\r\n        console.error(`Unsupported data type ${DataType[dataType]}.`);\r\n        return -1;\r\n    }\r\n\r\n    public static getAttributeIndicesBufferType(indices: AttributeIndicesArray): BufferIndexType {\r\n        if (indices instanceof Uint8Array) {\r\n            return BufferIndexType.UNSIGNED_BYTE;\r\n        }\r\n        else if (indices instanceof Uint16Array) {\r\n            return BufferIndexType.UNSIGNED_SHORT;\r\n        }\r\n        else {\r\n            return BufferIndexType.UNSIGNED_INT;\r\n        }\r\n    }\r\n\r\n    private static getAttributesListNumElements(list: AttributesList): number {\r\n        const attributes = list.list;\r\n        const attributesNames = Object.keys(attributes);\r\n        \r\n        let numElements = 0;\r\n        for (const name of attributesNames) {\r\n            const attribute = attributes[name];\r\n            if (numElements == 0) {\r\n                numElements = Math.floor(attribute.array.length / attribute.props.numComponents);\r\n            }\r\n            else if (Math.floor(attribute.array.length / attribute.props.numComponents) !== numElements) {\r\n                console.error(`Attribute ${name} should have ${numElements} elements.`);\r\n            }\r\n        }\r\n        return numElements;\r\n    }\r\n}","export { WebGLVertexArrayUtilities };\r\n\r\nclass WebGLVertexArrayUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static createVertexArray(gl: WebGL2RenderingContext): WebGLBuffer | null {\r\n        const glVao = gl.createVertexArray();\r\n\r\n        if (glVao === null) {\r\n            console.error('Could not create WebGLVertexArrayObject.');\r\n        }\r\n\r\n        return glVao;\r\n    }\r\n}","import { TextureParameter, PixelFormat, TextureTarget, PixelType, TextureMinFilter, TextureMagFilter, TextureWrapMode, TextureUnits } from \"./WebGLConstants\";\r\n\r\nexport { TexturePixels };\r\nexport { Texture2DPixels };\r\nexport { TextureCubeMapPixels };\r\nexport { TextureReference };\r\nexport { TextureProperties };\r\nexport { TexturePartialProperties };\r\nexport { TextureBinding };\r\nexport { Texture };\r\nexport { TexturesUnitsContext};\r\nexport { WebGLTextureUtilities};\r\n\r\ntype TexturePixels = number[] | ArrayBufferView | TexImageSource | null;\r\n\r\ntype Texture2DPixels = TexturePixels;\r\ntype TextureCubeMapPixels = {\r\n    xPos: TexImageSource;\r\n    xNeg: TexImageSource;\r\n    yPos: TexImageSource;\r\n    yNeg: TexImageSource;\r\n    zPos: TexImageSource;\r\n    zNeg: TexImageSource;\r\n}\r\n\r\ntype TextureReference = {\r\n    glTex: WebGLTexture;\r\n}\r\n\r\ntype TextureProperties = {\r\n    target: TextureTarget;\r\n\r\n    pixels: Texture2DPixels | TextureCubeMapPixels;\r\n    \r\n    subimage?: {\r\n        xoffset: number;\r\n        yoffset: number;\r\n        width: number;\r\n        height: number;\r\n    };\r\n\r\n    lod: number;\r\n    width: number;\r\n    height: number;\r\n\r\n    format: PixelFormat;\r\n    internalFormat?: PixelFormat;\r\n    type: PixelType;\r\n\r\n    min?: TextureMinFilter;\r\n    mag?: TextureMagFilter;\r\n\r\n    wrapS?: TextureWrapMode;\r\n    wrapT?: TextureWrapMode;\r\n    wrapR?: TextureWrapMode;\r\n\r\n    baseLod?: number;\r\n    maxLod?: number;\r\n}\r\n\r\ntype TexturePartialProperties = Required<Pick<TextureProperties, 'pixels'>> & Partial<TextureProperties>;\r\n\r\ntype TextureBinding = {\r\n    unit: number;\r\n}\r\n\r\ntype Texture = TextureProperties & TextureReference & TextureBinding;\r\n\r\ntype TexturesUnitsContext = {\r\n    maxTextureUnits: number;\r\n    registeredTextureUnits: Array<boolean>;\r\n}\r\n\r\nclass WebGLTextureUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static createBindingsContext(gl: WebGL2RenderingContext): TexturesUnitsContext {\r\n        const maxTextureUnits = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n        const registeredTextureUnits = new Array<boolean>(maxTextureUnits);\r\n\r\n        return {\r\n            maxTextureUnits: maxTextureUnits,\r\n            registeredTextureUnits: registeredTextureUnits\r\n        }\r\n    }\r\n\r\n    public static createTexture(gl: WebGL2RenderingContext, ctx: TexturesUnitsContext, props: TextureProperties): Texture | null {\r\n        const glTex = gl.createTexture();\r\n        \r\n        if (glTex === null) {\r\n            console.error(`Could not create WebGLTexture.`);\r\n            return null;\r\n        }\r\n\r\n        const unit = this._allocateTextureUnit(ctx);\r\n        if (unit < 0) {\r\n            console.error(`Could not allocate another texture unit.`);\r\n            return null;\r\n        }\r\n\r\n        const tex = {\r\n            ...props,\r\n            unit: unit,\r\n            glTex: glTex\r\n        } as Texture;\r\n\r\n        this.setTexture(gl, tex);\r\n\r\n        return tex;\r\n    }\r\n\r\n    public static deleteTexture(gl: WebGL2RenderingContext, ctx: TexturesUnitsContext, tex: Texture): void {\r\n        gl.deleteTexture(tex.glTex);\r\n        this._freeTextureUnit(ctx, tex.unit);\r\n    }\r\n\r\n    public static setTexture(gl: WebGL2RenderingContext, tex: Texture): void {\r\n        \r\n        gl.activeTexture(TextureUnits.TEXTURE0 + tex.unit);\r\n        gl.bindTexture(tex.target, tex.glTex);\r\n\r\n        this.setTextureParameters(gl, tex);\r\n\r\n        const pixels = tex.pixels;\r\n        const internalFormat = tex.internalFormat || tex.format;\r\n        if (pixels == null) {\r\n            gl.texImage2D(tex.target, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, null);\r\n        }\r\n        else {\r\n            if ('xPos' in pixels) {\r\n                gl.texImage2D(TextureTarget.TEXTURE_CUBE_MAP_POSITIVE_X, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, pixels.xPos as any);\r\n                gl.texImage2D(TextureTarget.TEXTURE_CUBE_MAP_NEGATIVE_X, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, pixels.xNeg as any);\r\n                gl.texImage2D(TextureTarget.TEXTURE_CUBE_MAP_POSITIVE_Y, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, pixels.yPos as any);\r\n                gl.texImage2D(TextureTarget.TEXTURE_CUBE_MAP_NEGATIVE_Y, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, pixels.yNeg as any);\r\n                gl.texImage2D(TextureTarget.TEXTURE_CUBE_MAP_POSITIVE_Z, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, pixels.zPos as any);\r\n                gl.texImage2D(TextureTarget.TEXTURE_CUBE_MAP_NEGATIVE_Z, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, pixels.zNeg as any);\r\n            }\r\n            else {\r\n                if (typeof tex.subimage !== 'undefined') {\r\n                    gl.texImage2D(tex.target, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, tex.pixels as ArrayBufferView);\r\n                    gl.texSubImage2D(tex.target, tex.lod, tex.subimage.xoffset, tex.subimage.yoffset, tex.subimage.width, tex.subimage.height, tex.format, tex.type, tex.pixels as any);\r\n                }\r\n                else {\r\n                    gl.texImage2D(tex.target, tex.lod, internalFormat, tex.width, tex.height, 0, tex.format, tex.type, tex.pixels as ArrayBufferView);\r\n                }\r\n            }\r\n            gl.generateMipmap(tex.target);\r\n        }\r\n    }\r\n\r\n    public static setTextureParameters(gl: WebGL2RenderingContext, tex: Texture): void {\r\n\r\n        gl.activeTexture(TextureUnits.TEXTURE0 + tex.unit);\r\n        gl.bindTexture(tex.target, tex.glTex);\r\n\r\n        if (typeof tex.min !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_MIN_FILTER, tex.min);\r\n        if (typeof tex.mag !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_MAG_FILTER, tex.mag);\r\n        if (typeof tex.wrapS !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_WRAP_S, tex.wrapS);\r\n        if (typeof tex.wrapT !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_WRAP_T, tex.wrapT);\r\n        if (typeof tex.wrapR !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_WRAP_R, tex.wrapR);\r\n        if (typeof tex.baseLod !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_BASE_LEVEL, tex.baseLod);\r\n        if (typeof tex.maxLod !== 'undefined')\r\n            gl.texParameteri(tex.target, TextureParameter.TEXTURE_MAX_LEVEL, tex.maxLod);\r\n    }\r\n\r\n    public static bindTexture(gl: WebGL2RenderingContext, tex: Texture): void {\r\n        gl.bindTexture(tex.target, tex.glTex);\r\n    }\r\n\r\n    public static guessTextureProperties(tex: TexturePartialProperties): TextureProperties {\r\n\r\n        if (typeof tex.target === 'undefined')\r\n            tex.target = TextureTarget.TEXTURE_2D;\r\n        \r\n        if (typeof tex.format === 'undefined')\r\n            tex.format = PixelFormat.RGBA;\r\n\r\n        if (typeof tex.type === 'undefined')\r\n            tex.type = PixelType.UNSIGNED_BYTE;\r\n\r\n        if (typeof tex.lod === 'undefined')\r\n            tex.lod = 0;\r\n\r\n        if (typeof tex.pixels === 'undefined')\r\n            tex.pixels = null;\r\n\r\n        const pixels = tex.pixels;\r\n        if (pixels !== null) {\r\n            if ('xPos' in pixels) {\r\n                tex.target = TextureTarget.TEXTURE_CUBE_MAP;\r\n                tex.width = pixels.xPos.width;\r\n                tex.height = pixels.xPos.height;\r\n            }\r\n            else {\r\n                tex.target = TextureTarget.TEXTURE_2D;\r\n                if ('width' in pixels) {\r\n                    tex.width = pixels.width;\r\n                    tex.height = pixels.height;\r\n                }\r\n                else {\r\n                    let length = 0;\r\n\r\n                    if (pixels instanceof Uint8Array || Array.isArray(pixels)) {\r\n                        tex.type = PixelType.UNSIGNED_BYTE;\r\n                        length = pixels.length;\r\n                    }\r\n                    else if (pixels instanceof Uint16Array) {\r\n                        tex.type = PixelType.UNSIGNED_SHORT_4_4_4_4;\r\n                        length = pixels.length;\r\n                    }\r\n                    else if (pixels instanceof Uint32Array) {\r\n                        tex.type = PixelType.UNSIGNED_INT;\r\n                        length = pixels.length;\r\n                    }\r\n                    else if (pixels instanceof Float32Array) {\r\n                        tex.type = PixelType.FLOAT;\r\n                        length = pixels.length;\r\n                    }\r\n                    \r\n                    const channels = this.getNumChannelsFromPixelFormat(tex.format);\r\n                    const numPixels = length / channels;\r\n                    const texSize = Math.sqrt(numPixels);\r\n        \r\n                    tex.width = texSize;\r\n                    tex.height = texSize;\r\n                }\r\n            }\r\n        }\r\n\r\n        return tex as TextureProperties;\r\n    }\r\n\r\n    public static getNumBytesFromPixelTypeAndFormat(type: PixelType, format: PixelFormat): number {\r\n        switch (format) {\r\n            case PixelFormat.LUMINANCE:\r\n            case PixelFormat.ALPHA:\r\n                return 1;\r\n            case PixelFormat.LUMINANCE_ALPHA:\r\n                return 2;\r\n            case PixelFormat.RGB:\r\n                switch (type) {\r\n                    case PixelType.UNSIGNED_BYTE:\r\n                        return 3;\r\n                    case PixelType.UNSIGNED_SHORT_5_6_5:\r\n                        return 2;\r\n                }\r\n            case PixelFormat.RGBA:\r\n                switch (type) {\r\n                    case PixelType.UNSIGNED_BYTE:\r\n                        return 4;\r\n                    case PixelType.UNSIGNED_SHORT_4_4_4_4:\r\n                    case PixelType.UNSIGNED_SHORT_5_5_5_1:\r\n                        return 2;\r\n                }\r\n            default:\r\n                return 4;\r\n        }\r\n    }\r\n\r\n    public static getNumChannelsFromPixelFormat(format: PixelFormat): number {\r\n        switch (format) {\r\n            case PixelFormat.LUMINANCE:\r\n            case PixelFormat.ALPHA:\r\n                return 1;\r\n            case PixelFormat.LUMINANCE_ALPHA:\r\n                return 2;\r\n            case PixelFormat.RGB:\r\n                return 3;\r\n            case PixelFormat.RGBA:\r\n                return 4;\r\n            default:\r\n                return 4;\r\n        }\r\n    }\r\n    \r\n    private static _allocateTextureUnit(ctx: TexturesUnitsContext): number {\r\n        for (let unit = 0; unit < ctx.maxTextureUnits; unit++) {\r\n            if (!ctx.registeredTextureUnits[unit]) {\r\n                ctx.registeredTextureUnits[unit] = true;\r\n                return unit;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    private static _freeTextureUnit(ctx: TexturesUnitsContext, unit: number): void {\r\n        ctx.registeredTextureUnits[unit] = false;\r\n    }\r\n}","import { UniformType, UniformQuery, TextureUnits } from \"./WebGLConstants\";\r\nimport { Texture } from \"./WebGLTextureUtilities\";\r\n\r\nexport { UniformValue };\r\nexport { UniformProperties };\r\nexport { Uniform };\r\nexport { UniformsList };\r\nexport { UniformSetter };\r\nexport { UniformsSettersList };\r\nexport { WebGLUniformUtilities };\r\n\r\ntype UniformValue = number | Float32List | Uint32List | Int32List | Texture;\r\n\r\ntype UniformProperties = {\r\n    srcOffset?: number;\r\n    srcLength?: number;\r\n    transpose?: boolean;\r\n}\r\n\r\ntype Uniform<V extends UniformValue = UniformValue> = {\r\n    value: V;\r\n    props?: UniformProperties;\r\n}\r\n\r\ntype UniformsList = List<Uniform>;\r\n\r\ntype UniformSetter = {\r\n    type: UniformType;\r\n    func: (value: any) => void;\r\n}\r\n\r\ntype UniformsSettersList = {\r\n    setters: List<UniformSetter | null>;\r\n    glProg: WebGLProgram;\r\n}\r\n\r\nclass WebGLUniformUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static getUniformValueArrayBufferView(uniformValue: UniformValue): ArrayBufferView {\r\n        if (typeof uniformValue === 'number') {\r\n            return new Float32Array([uniformValue]);\r\n        }\r\n        else if ('unit' in uniformValue) {\r\n            return new Float32Array(uniformValue.unit);\r\n        }\r\n        else if (Array.isArray(uniformValue)) {\r\n            return new Float32Array(uniformValue);\r\n        }\r\n        else {\r\n            return uniformValue;\r\n        }\r\n    }\r\n\r\n    public static getUniformsListSetter(gl: WebGL2RenderingContext, glProg: WebGLProgram, list: UniformsList): UniformsSettersList {\r\n        const settersList = {\r\n            setters: {}\r\n        } as UniformsSettersList;\r\n        \r\n        Object.keys(list).forEach((name) => {\r\n            const uniform = list[name];\r\n            const setter = this.getUniformSetter(gl, glProg, name, uniform);\r\n            settersList.setters[name] = setter;\r\n        });\r\n\r\n        settersList.glProg = glProg;\r\n\r\n        return settersList;\r\n    }\r\n\r\n    public static setUniformsListValues(gl: WebGL2RenderingContext, settersList: UniformsSettersList, list: UniformsList): void {\r\n        Object.keys(list).forEach((name) => {\r\n            const uniform = list[name];\r\n            const setter = settersList.setters[name];\r\n            if (setter) {\r\n                setter.func(uniform.value);\r\n            }\r\n            else {\r\n                console.warn(`Uniform ${name} does not match with the given setters.`);\r\n            }\r\n        });\r\n    }\r\n\r\n    public static isTexture(uniformValue: UniformValue): boolean {\r\n        return (typeof uniformValue !== 'number' && 'unit' in uniformValue);\r\n    }\r\n\r\n    public static getUniformSetter(gl: WebGL2RenderingContext,\r\n        glProg: WebGLProgram,\r\n        uniformName: string,\r\n        uniform: Uniform): UniformSetter | null {\r\n        \r\n        const location = gl.getUniformLocation(glProg, uniformName);\r\n        if (location == null) {\r\n            console.error(`Uniform ${uniformName} could not be located.`);\r\n            return null;\r\n        }\r\n\r\n        const uniformIndices = gl.getUniformIndices(glProg, [uniformName]);\r\n        if (uniformIndices == null) {\r\n            console.error(`Uniform ${uniformName} could not be found.`);\r\n            return null;\r\n        }\r\n\r\n        const uniformType = gl.getActiveUniforms(glProg, uniformIndices, UniformQuery.UNIFORM_TYPE)[0];\r\n        \r\n        const value = uniform.value;\r\n        const props = (typeof uniform.props === 'undefined') ? {\r\n            srcOffset: undefined,\r\n            srcLength: undefined,\r\n            transpose: false\r\n        } : {\r\n            srcOffset: uniform.props.srcOffset || undefined,\r\n            srcLength: uniform.props.srcLength || undefined,\r\n            transpose: uniform.props.transpose || false    \r\n        };\r\n\r\n        const uniformTypeWarning = (uniformType: UniformType, valueType: string) => {\r\n            console.warn(`Uniform ${uniformName} of type ${UniformType[uniformType]} should have a value of type ${valueType}`);\r\n        }\r\n\r\n        switch (uniformType) {\r\n            case UniformType.FLOAT:\r\n                if (typeof value === 'number') {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (num: number) => {\r\n                            gl.uniform1f(location, num);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'number');\r\n                }\r\n                break;\r\n            case UniformType.UNSIGNED_INT:\r\n                if (typeof value === 'number') {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (num: number) => {\r\n                            gl.uniform1ui(location, num);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'number');\r\n                }\r\n                break;\r\n            case UniformType.BOOL:\r\n            case UniformType.INT:\r\n                if (typeof value === 'number') {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (num: number) => {\r\n                            gl.uniform1i(location, num);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'number');\r\n                }\r\n                break;\r\n            case UniformType.INT_SAMPLER_2D:\r\n            case UniformType.INT_SAMPLER_2D_ARRAY:\r\n            case UniformType.INT_SAMPLER_3D:\r\n            case UniformType.INT_SAMPLER_CUBE:\r\n            case UniformType.SAMPLER_2D:\r\n            case UniformType.SAMPLER_3D:\r\n            case UniformType.SAMPLER_CUBE:\r\n            case UniformType.SAMPLER_2D_SHADOW:\r\n            case UniformType.SAMPLER_2D_ARRAY:\r\n            case UniformType.SAMPLER_2D_ARRAY_SHADOW:\r\n            case UniformType.SAMPLER_CUBE_SHADOW:\r\n            case UniformType.UNSIGNED_INT_SAMPLER_2D:\r\n            case UniformType.UNSIGNED_INT_SAMPLER_3D:\r\n            case UniformType.UNSIGNED_INT_SAMPLER_CUBE:\r\n            case UniformType.UNSIGNED_INT_SAMPLER_2D_ARRAY:\r\n                if (typeof value !== 'number' && 'unit' in value) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (tex: Texture) => {\r\n                            gl.activeTexture(TextureUnits.TEXTURE0 + tex.unit);\r\n                            gl.bindTexture(tex.target, tex.glTex);\r\n                            gl.uniform1i(location, tex.unit);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'TextureSetter');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_VEC2:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Float32List) => {\r\n                            gl.uniform2fv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.BOOL_VEC2:\r\n            case UniformType.INT_VEC2:\r\n                if (value instanceof Int32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Int32List) => {\r\n                            gl.uniform2iv(location, vec);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Int32List');\r\n                }\r\n                break;\r\n            case UniformType.UNSIGNED_INT_VEC2:\r\n                if (value instanceof Uint32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Uint32List) => {\r\n                            gl.uniform2uiv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Uint32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_VEC3:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Float32List) => {\r\n                            gl.uniform3fv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.BOOL_VEC3:\r\n            case UniformType.INT_VEC3:\t\r\n                if (value instanceof Int32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Int32List) => {\r\n                            gl.uniform3iv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Int32List');\r\n                }\r\n                break;\r\n            case UniformType.UNSIGNED_INT_VEC3:\r\n                if (value instanceof Uint32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Uint32List) => {\r\n                            gl.uniform3uiv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Uint32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_VEC4:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Float32List) => {\r\n                            gl.uniform4fv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.BOOL_VEC4:\r\n            case UniformType.INT_VEC4:\r\n                if (value instanceof Int32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Int32List) => {\r\n                            gl.uniform4iv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Int32List');\r\n                }\r\n                break;\r\n            case UniformType.UNSIGNED_INT_VEC4:\r\n                if (value instanceof Uint32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (vec: Uint32List) => {\r\n                            gl.uniform4uiv(location, vec, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Uint32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT2:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix2fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT3:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix3fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT4:\t\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix4fv(location, props.transpose, mat);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT2x3:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix2x3fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT2x4:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix2x4fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT3x2:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix3x2fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT3x4:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix3x4fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT4x2:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix4x2fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n            case UniformType.FLOAT_MAT4x3:\r\n                if (value instanceof Float32Array || Array.isArray(value)) {\r\n                    return {\r\n                        type: uniformType,\r\n                        func: (mat: Float32List) => {\r\n                            gl.uniformMatrix4x3fv(location, props.transpose, mat, props.srcOffset, props.srcLength);\r\n                        }\r\n                    };\r\n                }\r\n                else {\r\n                    uniformTypeWarning(uniformType, 'Float32List');\r\n                }\r\n                break;\r\n        }\r\n\r\n        console.error(`Uniform ${uniformName} has an unknown type.`);\r\n\r\n        return null;\r\n    }\r\n}","import { WebGLBufferUtilities } from \"./WebGLBufferUtilities\";\r\nimport { UniformsList, WebGLUniformUtilities } from \"./WebGLUniformUtilities\";\r\nimport { BufferDataUsage, BufferTarget } from \"./WebGLConstants\";\r\n\r\nexport { UniformBlockProperties };\r\nexport { UniformBlockReference };\r\nexport { UniformBlockBinding };\r\nexport { UniformBlock };\r\nexport { UniformBlockSetter };\r\nexport { UniformBlocksBindingsContext };\r\nexport { WebGLUniformBlockUtilities };\r\n\r\ntype UniformBlockProperties = {\r\n    name: string;\r\n    usage?: BufferDataUsage;\r\n}\r\n\r\ntype UniformBlockReference = {\r\n    glBuffer: WebGLBuffer;\r\n}\r\n\r\ntype UniformBlockBinding = {\r\n    bindingPoint: number;\r\n}\r\n\r\ntype UniformBlock = UniformBlockProperties & UniformBlockReference & UniformBlockBinding;\r\n\r\ntype UniformBlockSetter = UniformBlock & {\r\n    index: number;\r\n    uniforms: {\r\n        [name: string]: {\r\n            offset: number;\r\n        }\r\n    };\r\n    bufferByteLength: number;\r\n    glProg: WebGLProgram;\r\n}\r\n\r\ntype UniformBlocksBindingsContext = {\r\n    maxBindingPoints: number;\r\n    registeredBindingPoints: Array<boolean>;\r\n}\r\n\r\nclass WebGLUniformBlockUtilities {\r\n\r\n\r\n    private constructor() {}\r\n\r\n    public static createBindingsContext(gl: WebGL2RenderingContext): UniformBlocksBindingsContext {\r\n        const maxBindingPoints = gl.MAX_UNIFORM_BUFFER_BINDINGS;\r\n        const registeredBindingPoints = new Array<boolean>(maxBindingPoints);\r\n        \r\n        return {\r\n            maxBindingPoints: maxBindingPoints,\r\n            registeredBindingPoints: registeredBindingPoints\r\n        }\r\n    }\r\n\r\n    public static createUniformBlock(gl: WebGL2RenderingContext, ctx: UniformBlocksBindingsContext, name: string): UniformBlock | null {\r\n        \r\n        const glBuffer = WebGLBufferUtilities.createBuffer(gl);\r\n        if (glBuffer === null) {\r\n            return null;\r\n        }\r\n\r\n        const bindingPoint = this._allocateBindingPoint(ctx);\r\n        if (bindingPoint === null) {\r\n            console.error(`Could not allocate another binding point.`);\r\n            return null;\r\n        }\r\n        \r\n        return {\r\n            name: name,\r\n            bindingPoint: bindingPoint,\r\n            glBuffer: glBuffer,\r\n        }\r\n    }\r\n\r\n    public static getUniformBlockSetter(gl: WebGL2RenderingContext, glProg: WebGLProgram, block: UniformBlock): UniformBlockSetter | null {\r\n        gl.bindBuffer(BufferTarget.UNIFORM_BUFFER, block.glBuffer);\r\n        \r\n        const blockIndex = gl.getUniformBlockIndex(glProg, block.name);\r\n        if (blockIndex === gl.INVALID_INDEX) {\r\n            console.error(`Block '${block.name}' does not identify a valid uniform block.`);\r\n            return null;\r\n        }\r\n\r\n        const usage = (typeof block.usage === 'undefined') ? gl.DYNAMIC_DRAW : block.usage;\r\n        \r\n        const bindingPoint = block.bindingPoint;\r\n        gl.uniformBlockBinding(glProg, blockIndex, bindingPoint);\r\n\r\n        const blockSize = gl.getActiveUniformBlockParameter(glProg, blockIndex, gl.UNIFORM_BLOCK_DATA_SIZE);\r\n        gl.bufferData(gl.UNIFORM_BUFFER, blockSize, usage);\r\n\r\n        const uniforms: {\r\n            [name: string]: {\r\n                offset: number\r\n            }\r\n        } = {};\r\n\r\n        const blockUniformsIndices = gl.getActiveUniformBlockParameter(glProg, blockIndex, gl.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES);\r\n        gl.getActiveUniforms(glProg, blockUniformsIndices, gl.UNIFORM_OFFSET).forEach(\r\n            (uniformOffset: number, idx: number) => {\r\n                const uniformIndex = blockUniformsIndices[idx];\r\n                const uniformInfo = gl.getActiveUniform(glProg, uniformIndex);\r\n\r\n                if (uniformInfo !== null) {\r\n                    const uniformName = uniformInfo.name;\r\n                    uniforms[uniformName] = {\r\n                        offset: uniformOffset\r\n                    };\r\n                }\r\n            }\r\n        );\r\n        \r\n        return {\r\n            name: block.name,\r\n            usage: usage,\r\n            bindingPoint: bindingPoint,\r\n            index: blockIndex,\r\n            uniforms: uniforms,\r\n            bufferByteLength: blockSize,\r\n            glBuffer: block.glBuffer,\r\n            glProg: glProg\r\n        }\r\n    }\r\n\r\n    public static setUniformBlockValues(gl: WebGL2RenderingContext, setter: UniformBlockSetter, uniforms: UniformsList): void {\r\n        \r\n        /*const blockUniformsNames = Object.keys(setter.uniforms);\r\n        const matchingUniformsNames = Object.keys(uniforms).filter(\r\n            (name: string) => {\r\n                return blockUniformsNames.includes(name);\r\n            }\r\n        );*/\r\n\r\n        gl.bindBuffer(gl.UNIFORM_BUFFER, setter.glBuffer);\r\n        gl.bindBufferRange(gl.UNIFORM_BUFFER, setter.bindingPoint, setter.glBuffer, 0, setter.bufferByteLength);\r\n        \r\n        Object.keys(uniforms).forEach((uniformName) => {\r\n            const uniform = setter.uniforms[uniformName];\r\n            const newUniformValue = WebGLUniformUtilities.getUniformValueArrayBufferView(uniforms[uniformName].value);\r\n\r\n            gl.bufferSubData(gl.UNIFORM_BUFFER, uniform.offset, newUniformValue);\r\n        });\r\n    }\r\n\r\n    public static bindUniformBlock(gl: WebGL2RenderingContext, setter: UniformBlockSetter): void {\r\n        gl.bindBufferBase(BufferTarget.UNIFORM_BUFFER, setter.bindingPoint, setter.glBuffer);\r\n    }\r\n    \r\n    private static _allocateBindingPoint(ctx: UniformBlocksBindingsContext): number | null {\r\n        for (let unit = 0; unit < ctx.maxBindingPoints; unit++) {\r\n            if (!ctx.registeredBindingPoints[unit]) {\r\n                ctx.registeredBindingPoints[unit] = true;\r\n                return unit;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private static _freeBindingPoint(ctx: UniformBlocksBindingsContext, bindingPoint: number): void {\r\n        ctx.registeredBindingPoints[bindingPoint] = false;\r\n    }\r\n}","import { DrawMode, BufferIndexType } from \"./WebGLConstants\";\r\n\r\nexport { WebGLDrawUtilities };\r\n\r\nclass WebGLDrawUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static drawElements(gl: WebGL2RenderingContext, mode: DrawMode, indexType: BufferIndexType, count: number, offset: number): void {\r\n        gl.drawElements(mode, count, indexType, offset);\r\n    }\r\n\r\n    public static drawElementsInstanced(gl: WebGL2RenderingContext, mode: DrawMode, indexType: BufferIndexType, count: number, offset: number, instanceCount: number): void {\r\n        gl.drawElementsInstanced(mode, count, indexType, offset, instanceCount);\r\n    }\r\n    \r\n    public static drawRangeElements(gl: WebGL2RenderingContext, mode: DrawMode, start: number, end: number, count: number, indexType: BufferIndexType, offset: number): void {\r\n        gl.drawRangeElements(mode, start, end, count, indexType, offset);\r\n    }\r\n\r\n    public static drawArrays(gl: WebGL2RenderingContext, mode: DrawMode, first: number, count: number): void {\r\n        gl.drawArrays(mode, first, count);\r\n    }\r\n\r\n    public static drawArraysInstanced(gl: WebGL2RenderingContext, mode: DrawMode, first: number, count: number, instances: number): void {\r\n        gl.drawArraysInstanced(mode, first, count, instances);\r\n    }\r\n}","import { AttributesList, AttributesSettersList, WebGLAttributeUtilities } from \"./WebGLAttributeUtilities\"\r\nimport { Texture, TextureProperties, TexturesUnitsContext, WebGLTextureUtilities } from \"./WebGLTextureUtilities\"\r\nimport { UniformBlock, UniformBlockProperties, UniformBlocksBindingsContext, UniformBlockSetter, WebGLUniformBlockUtilities } from \"./WebGLUniformBlockUtilities\"\r\nimport { UniformsList, UniformsSettersList, WebGLUniformUtilities } from \"./WebGLUniformUtilities\"\r\nimport { DrawMode } from \"./WebGLConstants\"\r\nimport { WebGLDrawUtilities } from \"./WebGLDrawUtilities\"\r\n\r\nexport { Packet };\r\nexport { PacketBindingsProperties };\r\nexport { PacketBindings };\r\nexport { PacketOptions };\r\nexport { PacketSetter };\r\nexport { WebGLPacketUtilities };\r\n\r\ntype Packet = {\r\n    attributes?: AttributesList;\r\n    uniforms?: UniformsList;\r\n    uniformBlocks?: List<{\r\n        block: UniformBlock;\r\n        list: UniformsList;\r\n    }>,\r\n    options?: PacketOptions\r\n}\r\n\r\ntype PacketBindingsProperties = {\r\n    texturesProps?: List<TextureProperties>;\r\n    blocksProps?: List<UniformBlockProperties>;\r\n    texturesCtx?: TexturesUnitsContext;\r\n    blocksCtx?: UniformBlocksBindingsContext;\r\n}\r\n\r\ntype PacketBindings = {\r\n    textures: List<Texture>;\r\n    blocks: List<UniformBlock>;\r\n    texturesCtx?: TexturesUnitsContext;\r\n    blocksCtx?: UniformBlocksBindingsContext;\r\n}\r\n\r\ntype PacketOptions = {\r\n    drawMode?: DrawMode;\r\n    instanced?: boolean;\r\n    instanceCount?: number;\r\n}\r\n\r\ntype PacketSetter = {\r\n    attributesSetter?: AttributesSettersList;\r\n    uniformsSetter?: UniformsSettersList;\r\n    uniformBlockSetters?: List<UniformBlockSetter>;\r\n    drawMode: DrawMode;\r\n    instanced: boolean;\r\n    instanceCount: number;\r\n}\r\n\r\nclass WebGLPacketUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static createPacketBindings(gl: WebGL2RenderingContext, props: PacketBindingsProperties): PacketBindings | null {\r\n        const textures: List<Texture> = {};\r\n        const blocks: List<UniformBlock> = {};\r\n\r\n        const texturesCtx = props.texturesCtx || WebGLTextureUtilities.createBindingsContext(gl);\r\n        const blocksCtx = props.blocksCtx || WebGLUniformBlockUtilities.createBindingsContext(gl);\r\n\r\n        const texturesProps = props.texturesProps;\r\n        const blocksProps = props.blocksProps;\r\n        \r\n        if (typeof texturesProps !== \"undefined\") {\r\n            Object.keys(texturesProps).forEach((textureName) => {\r\n                const textureProps = texturesProps[textureName];\r\n                const texture = WebGLTextureUtilities.createTexture(\r\n                    gl, texturesCtx, \r\n                    textureProps\r\n                );\r\n                if (texture == null) {\r\n                    return null;\r\n                }\r\n                textures[textureName] = texture;\r\n            });\r\n        }\r\n\r\n        if (typeof blocksProps !== \"undefined\") {\r\n            Object.keys(blocksProps).forEach((blockName) => {\r\n                const blockProp = blocksProps[blockName];\r\n                const block = WebGLUniformBlockUtilities.createUniformBlock(\r\n                    gl, blocksCtx, \r\n                    blockProp.name\r\n                );\r\n                if (block == null) {\r\n                    return null;\r\n                }\r\n                blocks[blockName] = block;\r\n            });\r\n        }\r\n\r\n        return {\r\n            textures: textures,\r\n            blocks: blocks,\r\n            texturesCtx: texturesCtx,\r\n            blocksCtx: blocksCtx\r\n        };\r\n    }\r\n\r\n    public static getPacketSetter(gl: WebGL2RenderingContext, glProg: WebGLProgram, packet: Packet): PacketSetter | null {\r\n        const attributes = packet.attributes;\r\n        const uniforms = packet.uniforms;\r\n        const uniformBlocks = packet.uniformBlocks;\r\n\r\n        const props = packet.options;\r\n        const drawMode = (typeof props === \"undefined\" || typeof props.drawMode === \"undefined\") ? DrawMode.TRIANGLES : props.drawMode;\r\n        const instanced = (typeof props === \"undefined\" || typeof props.instanced === \"undefined\") ? false : props.instanced;\r\n        const instanceCount = (typeof props === \"undefined\" || typeof props.instanceCount === \"undefined\") ? 0 : props.instanceCount;\r\n\r\n        let attributesSetter: AttributesSettersList | null | undefined = void 0;\r\n        if (typeof attributes !== \"undefined\") {\r\n            attributesSetter = WebGLAttributeUtilities.getAttributesListSetter(gl, glProg, attributes);\r\n            if (attributesSetter == null) {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        let uniformBlockSetters: List<UniformBlockSetter> | undefined = void 0;\r\n        if (typeof uniformBlocks !== \"undefined\") {\r\n            uniformBlockSetters = {};\r\n            Object.keys(uniformBlocks).forEach((blockName) => {\r\n                const uniformBlock = uniformBlocks[blockName];\r\n                const uniformBlockSetter = WebGLUniformBlockUtilities.getUniformBlockSetter(gl, glProg, uniformBlock.block);\r\n                if (uniformBlockSetter == null) {\r\n                    return null;\r\n                }\r\n                uniformBlockSetters![blockName] = uniformBlockSetter;\r\n            });\r\n        }\r\n      \r\n        let uniformsSetter: UniformsSettersList | undefined = void 0;\r\n        if (typeof uniforms !== \"undefined\") {\r\n            uniformsSetter = WebGLUniformUtilities.getUniformsListSetter(gl, glProg, uniforms);\r\n            if (uniformsSetter == null) {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return {\r\n            attributesSetter: attributesSetter,\r\n            uniformsSetter: uniformsSetter,\r\n            uniformBlockSetters: uniformBlockSetters,\r\n            drawMode: drawMode,\r\n            instanced: instanced,\r\n            instanceCount: instanceCount\r\n        };\r\n    }\r\n\r\n    public static setPacketValues(gl: WebGL2RenderingContext, setter: PacketSetter, packet: Packet): void {\r\n        const attributes = packet.attributes;\r\n        const uniforms = packet.uniforms;\r\n        const uniformBlocks = packet.uniformBlocks;\r\n\r\n        const attributeSetter = setter.attributesSetter;\r\n        const uniformsSetter = setter.uniformsSetter;\r\n        const uniformBlockSetters = setter.uniformBlockSetters;\r\n\r\n        if (typeof attributes !== \"undefined\" && attributeSetter) {\r\n            WebGLAttributeUtilities.setAttributesListValues(gl, attributeSetter, attributes);\r\n        }\r\n\r\n        if (typeof uniforms !== \"undefined\" && uniformsSetter) {\r\n            WebGLUniformUtilities.setUniformsListValues(gl, uniformsSetter, uniforms);\r\n        }\r\n\r\n        if (typeof uniformBlocks !== \"undefined\") {\r\n            if (typeof uniformBlockSetters !== \"undefined\") {\r\n                Object.keys(uniformBlocks).forEach((blockName) => {\r\n                    const uniformBlockSetter = uniformBlockSetters[blockName];\r\n                    const uniformBlock = uniformBlocks[blockName];\r\n                    if (uniformBlockSetter) {\r\n                        WebGLUniformBlockUtilities.setUniformBlockValues(gl, uniformBlockSetter, uniformBlock.list);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    public static drawPacket(gl: WebGL2RenderingContext, setter: PacketSetter): void {\r\n        const attributeSetter = setter.attributesSetter;\r\n\r\n        if (typeof attributeSetter !== \"undefined\") {\r\n\r\n            WebGLAttributeUtilities.bindAttributesList(gl, attributeSetter);\r\n            \r\n            if (attributeSetter.hasIndices) {\r\n                if (setter.instanced) {\r\n                    WebGLDrawUtilities.drawElementsInstanced(\r\n                        gl,\r\n                        setter.drawMode,\r\n                        attributeSetter.indexType,\r\n                        attributeSetter.numElements,\r\n                        0,\r\n                        setter.instanceCount\r\n                    );\r\n                }\r\n                else {\r\n                    WebGLDrawUtilities.drawElements(\r\n                        gl,\r\n                        setter.drawMode,\r\n                        attributeSetter.indexType,\r\n                        attributeSetter.numElements,\r\n                        0\r\n                    );\r\n                }\r\n            }\r\n            else {\r\n                if (setter.instanced) {\r\n                    WebGLDrawUtilities.drawArraysInstanced(\r\n                        gl,\r\n                        setter.drawMode,\r\n                        0,\r\n                        attributeSetter.numElements,\r\n                        setter.instanceCount\r\n                    );\r\n                }\r\n                else {\r\n                    WebGLDrawUtilities.drawArrays(\r\n                        gl,\r\n                        setter.drawMode,\r\n                        0,\r\n                        attributeSetter.numElements\r\n                    );\r\n                }\r\n            }\r\n\r\n            WebGLAttributeUtilities.unbindAttributesList(gl);\r\n        }\r\n        else {\r\n            console.error(`No attributes to draw.`);\r\n        }\r\n    }\r\n}","import { ShaderType } from \"./WebGLConstants\";\r\n\r\nexport { WebGLShaderUtilities };\r\n\r\nclass WebGLShaderUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static createShader(gl: WebGL2RenderingContext, type: ShaderType, source: string): WebGLShader | null {\r\n        const glShader = gl.createShader(type as number);\r\n        \r\n        if (glShader == null) {\r\n            return null;\r\n        }\r\n\r\n        gl.shaderSource(glShader, source);\r\n        gl.compileShader(glShader);\r\n        \r\n        const success = gl.getShaderParameter(glShader, gl.COMPILE_STATUS);\r\n        if (success) {\r\n            return glShader;\r\n        }\r\n\r\n        const shaderInfoLog = gl.getShaderInfoLog(glShader);\r\n        if (shaderInfoLog !== null) {\r\n            console.warn(shaderInfoLog);\r\n        }\r\n\r\n        gl.deleteShader(glShader);\r\n        return null;\r\n    }\r\n\r\n    public static deleteShader(gl: WebGL2RenderingContext, glShader: WebGLShader): void {\r\n        gl.deleteShader(glShader);\r\n    }\r\n}","import { ShaderType } from \"./WebGLConstants\";\r\nimport { WebGLShaderUtilities } from \"./WebGLShaderUtilities\";\r\n\r\nexport { WebGLProgramUtilties };\r\n\r\nclass WebGLProgramUtilties {\r\n\r\n    private constructor() {}\r\n\r\n    public static createProgramFromSources(gl: WebGL2RenderingContext, vertexSource: string, fragmentSource: string): WebGLProgram | null {\r\n        const vertexShader = WebGLShaderUtilities.createShader(gl, ShaderType.VERTEX_SHADER, vertexSource);\r\n        if (vertexShader == null) {\r\n            return null;\r\n        }\r\n\r\n        const fragmentShader = WebGLShaderUtilities.createShader(gl, ShaderType.FRAGMENT_SHADER, fragmentSource);\r\n        if (fragmentShader == null) {\r\n            return null;\r\n        }\r\n        \r\n        return this.createProgram(gl, vertexShader, fragmentShader);\r\n    }\r\n\r\n    public static createProgram(gl: WebGL2RenderingContext, vertexShader: WebGLShader, fragmentShader: WebGLShader): WebGLProgram | null {\r\n        const glProg = gl.createProgram();\r\n\r\n        if (glProg == null) {\r\n            return null;\r\n        }\r\n\r\n        gl.attachShader(glProg, vertexShader);\r\n        gl.attachShader(glProg, fragmentShader);\r\n        gl.linkProgram(glProg);\r\n\r\n        const success = gl.getProgramParameter(glProg, gl.LINK_STATUS);\r\n        if (success) {\r\n            return glProg;\r\n        }\r\n\r\n        const programInfoLog = gl.getProgramInfoLog(glProg);\r\n        if (programInfoLog !== null) {\r\n            console.warn(programInfoLog);\r\n        }\r\n        \r\n        gl.deleteProgram(glProg);\r\n        return null;\r\n    }\r\n    \r\n    public static deleteProgram(gl: WebGL2RenderingContext, glProg: WebGLProgram) {\r\n        gl.deleteProgram(glProg);\r\n    }\r\n\r\n    public static useProgram(gl: WebGL2RenderingContext, glProg: WebGLProgram) {\r\n        gl.useProgram(glProg);\r\n    }\r\n}","import { PixelFormat } from \"./WebGLConstants\";\r\n\r\nexport { WebGLRenderbufferUtilities };\r\n\r\ntype Renderbuffer = {\r\n    glRb: WebGLRenderbuffer;\r\n}\r\n\r\ntype RenderbufferProperties = {\r\n    internalFormat: PixelFormat;\r\n    width: number;\r\n    height: number;\r\n    samples?: number\r\n}\r\n\r\nclass WebGLRenderbufferUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static createRenderbuffer(gl: WebGL2RenderingContext, props: RenderbufferProperties): Renderbuffer | null {\r\n        const glRb = gl.createRenderbuffer();\r\n    \r\n        if (glRb === null) {\r\n            console.error('Could not create WebGLRenderbuffer.');\r\n            return null;\r\n        }\r\n\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, glRb);\r\n\r\n        if (typeof props.samples !== 'undefined') {\r\n            gl.renderbufferStorageMultisample(gl.RENDERBUFFER, props.samples, props.internalFormat, props.width, props.height);\r\n        }\r\n        else {\r\n            gl.renderbufferStorage(gl.RENDERBUFFER, props.internalFormat, props.width, props.height);\r\n        }\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n\r\n        return {\r\n            ...props,\r\n            glRb: glRb\r\n        };\r\n    }\r\n}","import { Capabilities, BufferMaskBit, Parameter, TestFunction } from \"./WebGLConstants\";\r\n\r\nexport { WebGLRendererUtilities };\r\n\r\nclass WebGLRendererUtilities {\r\n\r\n    private constructor() {}\r\n\r\n    public static setScissor(gl: WebGL2RenderingContext, x: number, y: number, width: number, height: number): void {\r\n        gl.scissor(x, y, width, height);\r\n    }\r\n\r\n    public static setViewport(gl: WebGL2RenderingContext, x: number, y: number, width: number, height: number): void {\r\n        gl.viewport(x, y, width, height);\r\n    }\r\n\r\n    public static getViewport(gl: WebGL2RenderingContext): Int32Array {\r\n        return gl.getParameter(Parameter.VIEWPORT) as Int32Array;\r\n    }\r\n\r\n    public static getScissorBox(gl: WebGL2RenderingContext): Int32Array {\r\n        return gl.getParameter(Parameter.SCISSOR_BOX) as Int32Array;\r\n    }\r\n\r\n    public static getParameter(gl: WebGL2RenderingContext, param: Parameter): any {\r\n        return gl.getParameter(param);\r\n    }\r\n\r\n    public static enable(gl: WebGL2RenderingContext, cap: Capabilities): void {\r\n        gl.enable(cap);\r\n    }\r\n\r\n    public static depthFunc(gl: WebGL2RenderingContext, func: TestFunction): void {\r\n        gl.depthFunc(func);\r\n    }\r\n\r\n    public static stencilFunc(gl: WebGL2RenderingContext, func: TestFunction, ref: number, mask: number): void {\r\n        gl.stencilFunc(func, ref, mask);\r\n    }\r\n\r\n    public static clear(gl: WebGL2RenderingContext, buff: BufferMaskBit): void {\r\n        gl.clear(buff);\r\n    }\r\n\r\n    public static clearRgba(gl: WebGL2RenderingContext, red: number, green: number, blue: number, alpha: number): void {\r\n        gl.clearColor(red, green, blue, alpha);\r\n    }\r\n\r\n    public static clearColor(gl: WebGL2RenderingContext, color: Tuple<number, 4>): void {\r\n        gl.clearColor(color[0], color[1], color[2], color[3]);\r\n    }\r\n}","export { ColorValues };\r\nexport { Color };\r\nexport { ColorBase };\r\n\r\ntype ColorValues = [number, number, number, number];\r\n\r\ninterface ColorConstructor {\r\n    readonly prototype: Color;\r\n    new(): Color;\r\n    new(values: ColorValues): Color;\r\n    new(values?: ColorValues): Color;\r\n    readonly BLACK: Color;\r\n    readonly RED: Color;\r\n    readonly GREEN: Color;\r\n    readonly BLUE: Color;\r\n    readonly WHITE: Color;\r\n    rgb(r: number, g: number, b: number): Color;\r\n    rgba(r: number, g: number, b: number, a: number): Color;\r\n    array(...colors: Color[]): number[];\r\n}\r\n\r\ninterface Color {\r\n    array: ArrayLike<number>;\r\n    r: number;\r\n    g: number;\r\n    b: number;\r\n    a: number;\r\n    copy(color: Color): Color;\r\n    clone(): Color;\r\n    getValues(): ColorValues;\r\n    setValues(c: ColorValues): Color;\r\n    lerp(color: Color, t: number): Color;\r\n    valuesNormalized(): ColorValues;\r\n}\r\n\r\nclass ColorBase implements Color {\r\n    private _array: TypedArray;\r\n\r\n\tconstructor()\r\n\tconstructor(type: new(length: number) => TypedArray)\r\n\tconstructor(type?: new(length: number) => TypedArray) {\r\n\t\tthis._array = new (type || Uint8Array)(9);\r\n    }\r\n    \r\n    public static readonly BLACK = ColorBase.rgb(0, 0, 0);\r\n    public static readonly RED = ColorBase.rgb(255, 0, 0);\r\n    public static readonly GREEN = ColorBase.rgb(0, 255, 0);\r\n    public static readonly BLUE = ColorBase.rgb(0, 0, 255);\r\n    public static readonly WHITE = ColorBase.rgb(255, 255, 255);\r\n\r\n    public static rgb(r: number, g: number, b: number): ColorBase {\r\n        const color =  new ColorBase()\r\n        color.setValues([r, g, b, 255]);\r\n        return color;\r\n    }\r\n\r\n    public static rgba(r: number, g: number, b: number, a: number): ColorBase {\r\n        const color =  new ColorBase()\r\n        color.setValues([r, g, b, a]);\r\n        return color;\r\n    }\r\n\r\n    public static array(...colors: ColorBase[]): number[] {\r\n        const a = new Array<number>(colors.length * 4);\r\n        let c;\r\n        let i = 0;\r\n        for (const color of colors) {\r\n            c = color._array;\r\n            a[i + 0] = c[0];\r\n            a[i + 1] = c[1];\r\n            a[i + 2] = c[2];\r\n            a[i + 3] = c[3];\r\n            i += 4;\r\n        }\r\n        return a;\r\n    }\r\n\r\n    public get array(): ArrayLike<number> {\r\n        return this._array;\r\n    }\r\n\r\n    public get r(): number {\r\n        return this._array[0];\r\n    }\r\n\r\n    public set r(r: number) {\r\n        this._array[0] = r;\r\n    }\r\n\r\n    public get g(): number {\r\n        return this._array[1];\r\n    }\r\n\r\n    public set g(g: number) {\r\n        this._array[1] = g;\r\n    }\r\n\r\n    public get b(): number {\r\n        return this._array[2];\r\n    }\r\n\r\n    public set b(b: number) {\r\n        this._array[2] = b;\r\n    }\r\n\r\n    public get a(): number {\r\n        return this._array[3];\r\n    }\r\n\r\n    public set a(a: number) {\r\n        this._array[3] = a;\r\n    }\r\n\r\n    public setValues(c: ColorValues): ColorBase {\r\n\t\tconst o = this._array;\r\n\r\n\t\to[0] = c[0];\r\n\t\to[1] = c[1];\r\n\t\to[2] = c[2];\r\n\t\to[3] = c[3];\r\n\r\n\t\treturn this;\r\n    }\r\n    \r\n    public getValues(): ColorValues {\r\n\t\tconst c = this._array;\r\n\t\t\r\n\t\treturn [\r\n\t\t\tc[0], c[1], c[2], c[3]\r\n\t\t];\r\n\t}\r\n    \r\n    public copy(color: ColorBase): ColorBase {\r\n        const o = this._array;\r\n\r\n        o[0] = color.r;\r\n        o[1] = color.g;\r\n        o[2] = color.b;\r\n        o[3] = color.a;\r\n\r\n        return this;\r\n\t}\r\n\r\n\tpublic clone(): ColorBase {\r\n\t\treturn new ColorBase().copy(this);\r\n    }\r\n    \r\n    public lerp(color: ColorBase, t: number): ColorBase {\r\n\t\tconst o = this._array;\r\n\t\tconst c = color._array;\r\n\r\n\t\to[0] = t * (c[0] - o[0]);\r\n\t\to[1] = t * (c[1] - o[1]);\r\n\t\to[2] = t * (c[2] - o[2]);\r\n\t\to[3] = t * (c[3] - o[3]);\r\n\r\n\t\treturn this;\r\n\t}\r\n    \r\n    public valuesNormalized(): ColorValues {\r\n        return [this.r / 255, this.g / 255, this.b / 255, this.a / 255];\r\n    }\r\n}\r\n\r\nconst Color: ColorConstructor = ColorBase;","import { Injector } from \"../../../patterns/injectors/Injector\";\r\nimport { MathError } from \"../../MathError\";\r\nimport { Vector2, Vector2Values } from \"../vectors/Vector2\";\r\nimport { Vector3, Vector3Values } from \"../vectors/Vector3\";\r\nimport { Vector4, Vector4Values } from \"../vectors/Vector4\";\r\nimport { Matrix3Values } from \"./Matrix3\";\r\n\r\n\r\nexport { Matrix4Values };\r\nexport { Matrix4 };\r\nexport { Matrix4Injector };\r\nexport { Matrix4Base };\r\n\r\ntype Matrix4Values = [\r\n  number, number, number, number,\r\n  number, number, number, number,\r\n  number, number, number, number,\r\n  number, number, number, number\r\n];\r\n\r\ntype Matrix34Values = [\r\n  number, number, number,\r\n  number, number, number,\r\n  number, number, number,\r\n  number, number, number\r\n];\r\n\r\ninterface Matrix4Constructor {\r\n\treadonly prototype: Matrix4;\r\n\tnew(): Matrix4;\r\n\tnew(values: Matrix4Values): Matrix4;\r\n  translation(vector: Vector3): Matrix4;\r\n  rotationX(angleInRadians: number): Matrix4;\r\n  rotationY(angleInRadians: number): Matrix4;\r\n  rotationZ(angleInRadians: number): Matrix4;\r\n}\r\n\r\ninterface Matrix4 {\r\n  readonly array: ArrayLike<number>;\r\n  values: Matrix4Values;\r\n  row1: Vector4Values;\r\n  row2: Vector4Values;\r\n  row3: Vector4Values;\r\n  row4: Vector4Values;\r\n  col1: Vector4Values;\r\n  col2: Vector4Values;\r\n  col3: Vector4Values;\r\n  col4: Vector4Values;\r\n  m11: number;\r\n  m12: number;\r\n  m13: number;\r\n  m14: number;\r\n  m21: number;\r\n  m22: number;\r\n  m23: number;\r\n  m24: number;\r\n  m31: number;\r\n  m32: number;\r\n  m33: number;\r\n  m34: number;\r\n  m41: number;\r\n  m42: number;\r\n  m43: number;\r\n  m44: number;\r\n  setArray(array: WritableArrayLike<number>): this;\r\n  setValues(m: Matrix4Values): this;\r\n  getAt(idx: number): number;\r\n  setAt(idx: number, val: number): this;\r\n  getEntry(row: number, col: number): number;\r\n  setEntry(row: number, col: number, val: number): this;\r\n  getRow(idx: number): Vector4Values;\r\n  setRow(idx: number, row: Vector4Values): this;\r\n  getCol(idx: number): Vector4Values;\r\n  setCol(idx: number, col: Vector4Values): this;\r\n\r\n  getUpper33(): Matrix3Values;\r\n  setUpper33(m: Matrix3Values): this;\r\n  getUpper34(): Matrix34Values;\r\n  setUpper34(m: Matrix34Values): this;\r\n\r\n  equals(mat: Matrix4): boolean;\r\n  copy(mat: Matrix4): this;\r\n  clone(): this;\r\n\r\n  det(): number;\r\n  trace(): number;\r\n  setIdentity(): this;\r\n  setZeros(): this;\r\n  negate(): this;\r\n  transpose(): this;\r\n  invert(): this;\r\n  add(mat: Matrix4): this;\r\n  sub(mat: Matrix4): this;\r\n  mult(mat: Matrix4): this;\r\n  multScalar(k: number): this;\r\n\r\n  getMaxScaleOnAxis(): number;\r\n  solve(vecB: Vector4): Vector4Values;\r\n  solve2(vecB: Vector2): Vector2Values;\r\n  solve3(vecB: Vector3): Vector3Values;\r\n\r\n  writeIntoArray(out: WritableArrayLike<number>, offset?: number): void;\r\n  readFromArray(arr: ArrayLike<number>, offset?: number): this;\r\n\r\n  setTranslation(vec: Vector3): this;\r\n  translate(vec: Vector3): this;\r\n  setRotationX(angleInRadians: number): this;\r\n  rotateX(angleInRadians: number): this;\r\n  setRotationY(angleInRadians: number): this;\r\n  rotateY(angleInRadians: number): this;\r\n  setRotationZ(angleInRadians: number): this;\r\n  rotateZ(angleInRadians: number): this;\r\n  rotate(x: number, y: number, z: number): this;\r\n  axisRotation(axis: Vector3, angleInRadians: number): this;\r\n  rotateAxis(axis: Vector3, angleInRadians: number): this;\r\n  setScaling(vec: Vector3): this;\r\n  scale(vec: Vector3): this;\r\n  scaleScalar(k: number): this;\r\n  lookAt(eye: Vector3 | Vector3Values, target: Vector3, up: Vector3): this;\r\n  transformPoint(vec: Vector3): Vector3Values;\r\n  transformDirection(vec: Vector3): Vector3Values;\r\n  transformNormal(vec: Vector3): Vector3Values;\r\n  asPerspective(fieldOfViewYInRadians: number, aspect: number, zNear: number, zFar: number): this;\r\n  asOrthographic(left: number, right: number, bottom: number, top: number, near: number, far: number): this;\r\n}\r\n\r\nclass Matrix4Base {\r\n  protected _array: WritableArrayLike<number>;\r\n\r\n\tconstructor()\r\n\tconstructor(values: Matrix4Values)\r\n\tconstructor(values?: Matrix4Values) {\r\n\t\tthis._array = (values) ? [\r\n      values[ 0], values[ 1], values[ 2], values[ 3],\r\n      values[ 4], values[ 5], values[ 6], values[ 7],\r\n      values[ 8], values[ 9], values[10], values[11],\r\n      values[12], values[13], values[14], values[15]\r\n\t\t] : [\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0,\r\n      0, 0, 0, 0\r\n    ];\r\n  }\r\n  \r\n  public get array(): ArrayLike<number> {\r\n    return this._array;\r\n  }\r\n\r\n  public get values(): Matrix4Values {\r\n\t\treturn [\r\n      this._array[ 0], this._array[ 1], this._array[ 2], this._array[ 3],\r\n      this._array[ 4], this._array[ 5], this._array[ 6], this._array[ 7],\r\n      this._array[ 8], this._array[ 9], this._array[10], this._array[11],\r\n      this._array[12], this._array[13], this._array[14], this._array[15]\r\n    ];\r\n\t}\r\n\r\n\tpublic set values(values: Matrix4Values) {\r\n    this._array[ 0] = values[ 0];\r\n    this._array[ 1] = values[ 1];\r\n    this._array[ 2] = values[ 2];\r\n    this._array[ 3] = values[ 3];\r\n    this._array[ 4] = values[ 4];\r\n    this._array[ 5] = values[ 5];\r\n    this._array[ 6] = values[ 6];\r\n    this._array[ 7] = values[ 7];\r\n    this._array[ 8] = values[ 8];\r\n    this._array[ 9] = values[ 9];\r\n    this._array[10] = values[10];\r\n    this._array[11] = values[11];\r\n    this._array[12] = values[12];\r\n    this._array[13] = values[13];\r\n    this._array[14] = values[14];\r\n    this._array[15] = values[15];\r\n  }\r\n\r\n  public get row1(): Vector4Values {\r\n\t\treturn [\r\n      this._array[0],\r\n      this._array[1],\r\n      this._array[2],\r\n      this._array[3]\r\n    ];\r\n\t}\r\n\r\n\tpublic set row1(row1: Vector4Values) {\r\n    this._array[0] = row1[0];\r\n    this._array[1] = row1[1];\r\n    this._array[2] = row1[2];\r\n    this._array[3] = row1[3];\r\n  }\r\n\r\n  public get row2(): Vector4Values {\r\n\t\treturn [\r\n      this._array[4],\r\n      this._array[5],\r\n      this._array[6],\r\n      this._array[7]\r\n    ];\r\n\t}\r\n\r\n\tpublic set row2(row2: Vector4Values) {\r\n    this._array[4] = row2[0];\r\n    this._array[5] = row2[1];\r\n    this._array[6] = row2[2];\r\n    this._array[7] = row2[3];\r\n  }\r\n\r\n  public get row3(): Vector4Values {\r\n\t\treturn [\r\n      this._array[ 8],\r\n      this._array[ 9],\r\n      this._array[10],\r\n      this._array[11]\r\n    ];\r\n\t}\r\n\r\n\tpublic set row3(row3: Vector4Values) {\r\n    this._array[ 8] = row3[0];\r\n    this._array[ 9] = row3[1];\r\n    this._array[10] = row3[2];\r\n    this._array[11] = row3[3];\r\n  }\r\n\r\n  public get row4(): Vector4Values {\r\n\t\treturn [\r\n      this._array[12],\r\n      this._array[13],\r\n      this._array[14],\r\n      this._array[15]\r\n    ];\r\n\t}\r\n\r\n\tpublic set row4(row4: Vector4Values) {\r\n    this._array[12] = row4[0];\r\n    this._array[13] = row4[1];\r\n    this._array[14] = row4[2];\r\n    this._array[15] = row4[3];\r\n  }\r\n\r\n  public get col1(): Vector4Values {\r\n\t\treturn [\r\n      this._array[ 0],\r\n      this._array[ 4],\r\n      this._array[ 8],\r\n      this._array[12]\r\n    ];\r\n\t}\r\n\r\n\tpublic set col1(col1: Vector4Values) {\r\n    this._array[ 0] = col1[0];\r\n    this._array[ 4] = col1[1];\r\n    this._array[ 8] = col1[2];\r\n    this._array[12] = col1[3];\r\n  }\r\n\r\n  public get col2(): Vector4Values {\r\n\t\treturn [\r\n      this._array[ 1],\r\n      this._array[ 5],\r\n      this._array[ 9],\r\n      this._array[13]\r\n    ];\r\n\t}\r\n\r\n\tpublic set col2(col2: Vector4Values) {\r\n    this._array[ 1] = col2[0];\r\n    this._array[ 5] = col2[1];\r\n    this._array[ 9] = col2[2];\r\n    this._array[13] = col2[3];\r\n  }\r\n\r\n  public get col3(): Vector4Values {\r\n\t\treturn [\r\n      this._array[ 2],\r\n      this._array[ 6],\r\n      this._array[10],\r\n      this._array[14]\r\n    ];\r\n\t}\r\n\r\n\tpublic set col3(col3: Vector4Values) {\r\n    this._array[ 2] = col3[0];\r\n    this._array[ 6] = col3[1];\r\n    this._array[10] = col3[2];\r\n    this._array[14] = col3[3];\r\n  }\r\n\r\n  public get col4(): Vector4Values {\r\n\t\treturn [\r\n      this._array[ 3],\r\n      this._array[ 7],\r\n      this._array[11],\r\n      this._array[15]\r\n    ];\r\n\t}\r\n\r\n\tpublic set col4(col4: Vector4Values) {\r\n    this._array[ 3] = col4[0];\r\n    this._array[ 7] = col4[1];\r\n    this._array[11] = col4[2];\r\n    this._array[15] = col4[3];\r\n  }\r\n\r\n  public get m11(): number {\r\n\t\treturn this._array[0];\r\n\t}\r\n\r\n\tpublic set m11(m11: number) {\r\n\t\tthis._array[0] = m11;\r\n  }\r\n  \r\n  public get m12() {\r\n\t\treturn this._array[1];\r\n\t}\r\n\r\n\tpublic set m12(m12: number) {\r\n\t\tthis._array[1] = m12;\r\n  }\r\n  \r\n  public get m13() {\r\n\t\treturn this._array[2];\r\n\t}\r\n\r\n\tpublic set m13(m13: number) {\r\n\t\tthis._array[2] = m13;\r\n  }\r\n  \r\n  public get m14() {\r\n\t\treturn this._array[3];\r\n\t}\r\n\r\n\tpublic set m14(m14: number) {\r\n\t\tthis._array[3] = m14;\r\n  }\r\n  \r\n  public get m21() {\r\n\t\treturn this._array[4];\r\n\t}\r\n\r\n\tpublic set m21(m21: number) {\r\n\t\tthis._array[4] = m21;\r\n  }\r\n  \r\n  public get m22() {\r\n\t\treturn this._array[5];\r\n\t}\r\n\r\n\tpublic set m22(m22: number) {\r\n\t\tthis._array[5] = m22;\r\n  }\r\n  \r\n  public get m23() {\r\n\t\treturn this._array[6];\r\n\t}\r\n\r\n\tpublic set m23(m23: number) {\r\n\t\tthis._array[6] = m23;\r\n  }\r\n  \r\n  public get m24() {\r\n\t\treturn this._array[7];\r\n\t}\r\n\r\n\tpublic set m24(m24: number) {\r\n\t\tthis._array[7] = m24;\r\n  }\r\n  \r\n  public get m31() {\r\n\t\treturn this._array[8];\r\n\t}\r\n\r\n  public set m31(m31: number) {\r\n\t\tthis._array[8] = m31;\r\n  }\r\n  \r\n  public get m32() {\r\n\t\treturn this._array[9];\r\n\t}\r\n\r\n\tpublic set m32(m32: number) {\r\n\t\tthis._array[9] = m32;\r\n  }\r\n  \r\n  public get m33() {\r\n\t\treturn this._array[10];\r\n\t}\r\n\r\n  public set m33(m33: number) {\r\n\t\tthis._array[10] = m33;\r\n  }\r\n  \r\n  public get m34() {\r\n\t\treturn this._array[11];\r\n\t}\r\n\r\n\tpublic set m34(m34: number) {\r\n\t\tthis._array[11] = m34;\r\n  }\r\n  \r\n  public get m41() {\r\n\t\treturn this._array[12];\r\n\t}\r\n\r\n\tpublic set m41(m41: number) {\r\n\t\tthis._array[12] = m41;\r\n  }\r\n  \r\n  public get m42() {\r\n\t\treturn this._array[13];\r\n\t}\r\n\r\n\tpublic set m42(m42: number) {\r\n\t\tthis._array[13] = m42;\r\n  }\r\n  \r\n  public get m43() {\r\n\t\treturn this._array[14];\r\n\t}\r\n\r\n\tpublic set m43(m43: number) {\r\n\t\tthis._array[14] = m43;\r\n  }\r\n  \r\n  public get m44() {\r\n\t\treturn this._array[15];\r\n\t}\r\n\r\n\tpublic set m44(m44: number) {\r\n\t\tthis._array[15] = m44;\r\n  }\r\n\r\n\tpublic setArray(array: WritableArrayLike<number>): this {\r\n\t\tif (array.length < 16) {\r\n\t\t\tthrow new MathError(`Array must be of length 16 at least.`);\r\n\t\t}\r\n\t\tthis._array = array;\r\n\t\treturn this;\r\n\t}\r\n\r\n  public setValues(m: Matrix4Values): this {\r\n\t\tconst o = this._array;\r\n\r\n    o[ 0] = m[ 0];\r\n    o[ 1] = m[ 1];\r\n    o[ 2] = m[ 2];\r\n    o[ 3] = m[ 3];\r\n    o[ 4] = m[ 4];\r\n    o[ 5] = m[ 5];\r\n    o[ 6] = m[ 6];\r\n    o[ 7] = m[ 7];\r\n    o[ 8] = m[ 8];\r\n    o[ 9] = m[ 9];\r\n    o[10] = m[10];\r\n    o[11] = m[11];\r\n    o[12] = m[12];\r\n    o[13] = m[13];\r\n    o[14] = m[14];\r\n    o[15] = m[15];\r\n\r\n    return this;\r\n  }\r\n\r\n  public getUpper33(): Matrix3Values {\r\n    const m = this._array;\r\n\r\n    return [\r\n      m[ 0], m[ 1], m[ 2],\r\n      m[ 4], m[ 5], m[ 6],\r\n      m[ 8], m[ 9], m[10]\r\n    ];\r\n  }\r\n  \r\n  public setUpper33(m: Matrix3Values): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = m[0];\r\n    o[ 1] = m[1];\r\n    o[ 2] = m[2];\r\n    o[ 4] = m[3];\r\n    o[ 5] = m[4];\r\n    o[ 6] = m[5];\r\n    o[ 8] = m[6];\r\n    o[ 9] = m[7];\r\n    o[10] = m[8];\r\n\r\n    return this;\r\n  }\r\n\r\n  public getUpper34(): Matrix34Values {\r\n    const m = this._array;\r\n    return [\r\n      m[ 0], m[ 1], m[ 2], m[ 3],\r\n      m[ 4], m[ 5], m[ 6], m[ 7],\r\n      m[ 8], m[ 9], m[10], m[11]\r\n    ];\r\n  }\r\n\r\n  public setUpper34(m : Matrix34Values): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = m[ 0];\r\n    o[ 1] = m[ 1];\r\n    o[ 2] = m[ 2];\r\n    o[ 3] = m[ 3];\r\n    o[ 4] = m[ 4];\r\n    o[ 5] = m[ 5];\r\n    o[ 6] = m[ 6];\r\n    o[ 7] = m[ 7];\r\n    o[ 8] = m[ 8];\r\n    o[ 9] = m[ 9];\r\n    o[10] = m[10];\r\n    o[11] = m[11];\r\n\r\n    return this;\r\n  }\r\n\r\n  public getRow(idx: number): Vector4Values {\r\n    const m = this._array;\r\n    const offset = idx * 4;\r\n\r\n    return [\r\n      m[offset    ],\r\n      m[offset + 1],\r\n      m[offset + 2],\r\n      m[offset + 3]\r\n    ];\r\n  }\r\n\r\n  public setRow(idx: number, row: Vector4Values): this {\r\n    const o = this._array;\r\n    const offset = idx * 4;\r\n\r\n    o[offset    ] = row[0];\r\n    o[offset + 1] = row[1];\r\n    o[offset + 2] = row[2];\r\n    o[offset + 3] = row[3];\r\n\r\n    return this;\r\n  }\r\n\r\n  public setCol(idx: number, col: Vector4Values): this {\r\n    const o = this._array;\r\n\r\n    o[     idx] = col[0];\r\n    o[4  + idx] = col[1];\r\n    o[8  + idx] = col[2];\r\n    o[12 + idx] = col[3];\r\n\r\n    return this;\r\n  }\r\n\r\n  public getCol(idx: number): Vector4Values {\r\n    const m = this._array;\r\n\r\n    return [\r\n      m[     idx],\r\n      m[4  + idx],\r\n      m[8  + idx],\r\n      m[12 + idx]\r\n    ];\r\n  }\r\n\r\n  public getAt(idx: number): number {\r\n    return this._array[idx];\r\n  }\r\n\r\n  public setAt(idx: number, val: number): this {\r\n    this._array[idx] = val;\r\n\r\n    return this;\r\n  }\r\n\r\n  public getEntry(row: number, col: number): number {\r\n    return this._array[4 * row + col];\r\n  }\r\n\r\n  public setEntry(row: number, col: number, val: number): this {\r\n    this._array[4 * row + col] = val;\r\n\r\n    return this;\r\n  }\r\n\r\n  public equals(mat: Matrix4): boolean {\r\n    const o = this._array;\r\n    const m = mat.array;\r\n\r\n    return o[ 0] === m[ 0]\r\n      && o[ 1] === m[ 1]\r\n      && o[ 2] === m[ 2]\r\n      && o[ 3] === m[ 3]\r\n      && o[ 4] === m[ 4]\r\n      && o[ 5] === m[ 5]\r\n      && o[ 6] === m[ 6]\r\n      && o[ 7] === m[ 7]\r\n      && o[ 8] === m[ 8]\r\n      && o[ 9] === m[ 9]\r\n      && o[10] === m[10]\r\n      && o[11] === m[11]\r\n      && o[12] === m[12]\r\n      && o[13] === m[13]\r\n      && o[14] === m[14]\r\n      && o[15] === m[15];\r\n  }\r\n\r\n  public copy(mat: Matrix4): this {\r\n    const o = this._array;\r\n    const m = mat.array;\r\n\r\n    o[ 0] = m[ 0];\r\n    o[ 1] = m[ 1];\r\n    o[ 2] = m[ 2];\r\n    o[ 3] = m[ 3];\r\n    o[ 4] = m[ 4];\r\n    o[ 5] = m[ 5];\r\n    o[ 6] = m[ 6];\r\n    o[ 7] = m[ 7];\r\n    o[ 8] = m[ 8];\r\n    o[ 9] = m[ 9];\r\n    o[10] = m[10];\r\n    o[11] = m[11];\r\n    o[12] = m[12];\r\n    o[13] = m[13];\r\n    o[14] = m[14];\r\n    o[15] = m[15];\r\n\r\n    return this;\r\n  }\r\n\r\n  public clone(): this {\r\n    return new Matrix4Base(this.values) as this;\r\n  }\r\n\r\n  public setIdentity(): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = 1;\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = 1;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = 1;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public setZeros(): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = 0;\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = 0;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = 0;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 0;\r\n\r\n    return this;\r\n  }\r\n\r\n  public det(): number {\r\n    const o = this._array;\r\n\r\n    const det2_01_01 = o[0] * o[5] - o[1] * o[4];\r\n    const det2_01_02 = o[0] * o[6] - o[2] * o[4];\r\n    const det2_01_03 = o[0] * o[7] - o[3] * o[4];\r\n    const det2_01_12 = o[1] * o[6] - o[2] * o[5];\r\n    const det2_01_13 = o[1] * o[7] - o[3] * o[5];\r\n    const det2_01_23 = o[2] * o[7] - o[3] * o[6];\r\n    const det3_201_012 = o[8] * det2_01_12 - o[ 9] * det2_01_02 + o[10] * det2_01_01;\r\n    const det3_201_013 = o[8] * det2_01_13 - o[ 9] * det2_01_03 + o[11] * det2_01_01;\r\n    const det3_201_023 = o[8] * det2_01_23 - o[10] * det2_01_03 + o[11] * det2_01_02;\r\n    const det3_201_123 = o[9] * det2_01_23 - o[10] * det2_01_13 + o[11] * det2_01_12;\r\n\r\n    return -det3_201_123 * o[12] + det3_201_023 * o[13]\r\n      - det3_201_013 * o[14] + det3_201_012 * o[15];\r\n  }\r\n\r\n  public trace(): number {\r\n    const o = this._array;\r\n\r\n    return o[0] + o[5] + o[10] + o[15];\r\n  }\r\n\r\n  public negate(): this {\r\n    const o = this._array;\r\n    const m = this._array;\r\n\r\n    o[ 0] = -m[ 0];\r\n    o[ 1] = -m[ 1];\r\n    o[ 2] = -m[ 2];\r\n    o[ 3] = -m[ 3];\r\n    o[ 4] = -m[ 4];\r\n    o[ 5] = -m[ 5];\r\n    o[ 6] = -m[ 6];\r\n    o[ 7] = -m[ 7];\r\n    o[ 8] = -m[ 8];\r\n    o[ 9] = -m[ 9];\r\n    o[10] = -m[10];\r\n    o[11] = -m[11];\r\n    o[12] = -m[12];\r\n    o[13] = -m[13];\r\n    o[14] = -m[14];\r\n    o[15] = -m[15];\r\n\r\n    return this;\r\n  }\r\n\r\n  public transpose(): this {\r\n    const m = this._array;\r\n    const o = this._array;\r\n\r\n    o[ 0] = m[ 0];\r\n    o[ 1] = m[ 4];\r\n    o[ 2] = m[ 8];\r\n    o[ 3] = m[12];\r\n    o[ 4] = m[ 1];\r\n    o[ 5] = m[ 5];\r\n    o[ 6] = m[ 9];\r\n    o[ 7] = m[13];\r\n    o[ 8] = m[ 2];\r\n    o[ 9] = m[ 6];\r\n    o[10] = m[10];\r\n    o[11] = m[14];\r\n    o[12] = m[ 3];\r\n    o[13] = m[ 7];\r\n    o[14] = m[11];\r\n    o[15] = m[15];\r\n    \r\n    return this;\r\n  }\r\n\r\n  public invert(): this {\r\n    const o = this._array;\r\n\r\n    const o00 = o[ 0];\r\n    const o01 = o[ 1];\r\n    const o02 = o[ 2];\r\n    const o03 = o[ 3];\r\n    const o10 = o[ 4];\r\n    const o11 = o[ 5];\r\n    const o12 = o[ 6];\r\n    const o13 = o[ 7];\r\n    const o20 = o[ 8];\r\n    const o21 = o[ 9];\r\n    const o22 = o[10];\r\n    const o23 = o[11];\r\n    const o30 = o[12];\r\n    const o31 = o[13];\r\n    const o32 = o[14];\r\n    const o33 = o[15];\r\n\r\n    const t00 = o00 * o11 - o01 * o10;\r\n    const t01 = o00 * o12 - o02 * o10;\r\n    const t02 = o00 * o13 - o03 * o10;\r\n    const t03 = o01 * o12 - o02 * o11;\r\n    const t04 = o01 * o13 - o03 * o11;\r\n    const t05 = o02 * o13 - o03 * o12;\r\n    const t06 = o20 * o31 - o21 * o30;\r\n    const t07 = o20 * o32 - o22 * o30;\r\n    const t08 = o20 * o33 - o23 * o30;\r\n    const t09 = o21 * o32 - o22 * o31;\r\n    const t10 = o21 * o33 - o23 * o31;\r\n    const t11 = o22 * o33 - o23 * o32;\r\n\r\n    const d = (t00 * t11 - t01 * t10 + t02 * t09 + t03 * t08 - t04 * t07 + t05 * t06);\r\n    \r\n    if (d == 0) {\r\n      throw new MathError(`Matrix is not invertible.`);\r\n    }\r\n\r\n    const invDet = 1.0 / d;\r\n\r\n    o[ 0] = (o11 * t11 - o12 * t10 + o13 * t09) * invDet;\r\n    o[ 1] = (-o01 * t11 + o02 * t10 - o03 * t09) * invDet;\r\n    o[ 2] = (o31 * t05 - o32 * t04 + o33 * t03) * invDet;\r\n    o[ 3] = (-o21 * t05 + o22 * t04 - o23 * t03) * invDet;\r\n    o[ 4] = (-o10 * t11 + o12 * t08 - o13 * t07) * invDet;\r\n    o[ 5] = (o00 * t11 - o02 * t08 + o03 * t07) * invDet;\r\n    o[ 6] = (-o30 * t05 + o32 * t02 - o33 * t01) * invDet;\r\n    o[ 7] = (o20 * t05 - o22 * t02 + o23 * t01) * invDet;\r\n    o[ 8] = (o10 * t10 - o11 * t08 + o13 * t06) * invDet;\r\n    o[ 9] = (-o00 * t10 + o01 * t08 - o03 * t06) * invDet;\r\n    o[10] = (o30 * t04 - o31 * t02 + o33 * t00) * invDet;\r\n    o[11] = (-o20 * t04 + o21 * t02 - o23 * t00) * invDet;\r\n    o[12] = (-o10 * t09 + o11 * t07 - o12 * t06) * invDet;\r\n    o[13] = (o00 * t09 - o01 * t07 + o02 * t06) * invDet;\r\n    o[14] = (-o30 * t03 + o31 * t01 - o32 * t00) * invDet;\r\n    o[15] = (o20 * t03 - o21 * t01 + o22 * t00) * invDet;\r\n\r\n    return this;\r\n  }\r\n\r\n  public inverseTranspose(): this {\r\n    const o = this._array;\r\n\r\n    const o00 = o[ 0];\r\n    const o01 = o[ 1];\r\n    const o02 = o[ 2];\r\n    const o03 = o[ 3];\r\n    const o10 = o[ 4];\r\n    const o11 = o[ 5];\r\n    const o12 = o[ 6];\r\n    const o13 = o[ 7];\r\n    const o20 = o[ 8];\r\n    const o21 = o[ 9];\r\n    const o22 = o[10];\r\n    const o23 = o[11];\r\n    const o30 = o[12];\r\n    const o31 = o[13];\r\n    const o32 = o[14];\r\n    const o33 = o[15];\r\n\r\n    const t00 = o00 * o11 - o01 * o10;\r\n    const t01 = o00 * o12 - o02 * o10;\r\n    const t02 = o00 * o13 - o03 * o10;\r\n    const t03 = o01 * o12 - o02 * o11;\r\n    const t04 = o01 * o13 - o03 * o11;\r\n    const t05 = o02 * o13 - o03 * o12;\r\n    const t06 = o20 * o31 - o21 * o30;\r\n    const t07 = o20 * o32 - o22 * o30;\r\n    const t08 = o20 * o33 - o23 * o30;\r\n    const t09 = o21 * o32 - o22 * o31;\r\n    const t10 = o21 * o33 - o23 * o31;\r\n    const t11 = o22 * o33 - o23 * o32;\r\n\r\n    const d = (t00 * t11 - t01 * t10 + t02 * t09 + t03 * t08 - t04 * t07 + t05 * t06);\r\n    \r\n    if (d == 0) {\r\n      throw new MathError(`Matrix is not inversible.`);\r\n    }\r\n\r\n    const invDet = 1.0 / d;\r\n\r\n    const m11 = (o11 * t11 - o12 * t10 + o13 * t09) * invDet;\r\n    const m12 = (-o01 * t11 + o02 * t10 - o03 * t09) * invDet;\r\n    const m13 = (o31 * t05 - o32 * t04 + o33 * t03) * invDet;\r\n    const m14 = (-o21 * t05 + o22 * t04 - o23 * t03) * invDet;\r\n    const m21 = (-o10 * t11 + o12 * t08 - o13 * t07) * invDet;\r\n    const m22 = (o00 * t11 - o02 * t08 + o03 * t07) * invDet;\r\n    const m23 = (-o30 * t05 + o32 * t02 - o33 * t01) * invDet;\r\n    const m24 = (o20 * t05 - o22 * t02 + o23 * t01) * invDet;\r\n    const m31 = (o10 * t10 - o11 * t08 + o13 * t06) * invDet;\r\n    const m32 = (-o00 * t10 + o01 * t08 - o03 * t06) * invDet;\r\n    const m33 = (o30 * t04 - o31 * t02 + o33 * t00) * invDet;\r\n    const m34 = (-o20 * t04 + o21 * t02 - o23 * t00) * invDet;\r\n    const m41 = (-o10 * t09 + o11 * t07 - o12 * t06) * invDet;\r\n    const m42 = (o00 * t09 - o01 * t07 + o02 * t06) * invDet;\r\n    const m43 = (-o30 * t03 + o31 * t01 - o32 * t00) * invDet;\r\n    const m44 = (o20 * t03 - o21 * t01 + o22 * t00) * invDet;\r\n\r\n    o[ 0] = m11;\r\n    o[ 1] = m12;\r\n    o[ 2] = m13;\r\n    o[ 3] = m14;\r\n    o[ 4] = m21;\r\n    o[ 5] = m22;\r\n    o[ 6] = m23;\r\n    o[ 7] = m24;\r\n    o[ 8] = m31;\r\n    o[ 9] = m32;\r\n    o[10] = m33;\r\n    o[11] = m34;\r\n    o[12] = m41;\r\n    o[13] = m42;\r\n    o[14] = m43;\r\n    o[15] = m44;\r\n\r\n    return this;\r\n  }\r\n\r\n  public add(mat: Matrix4): this {\r\n    const o = this._array;\r\n    const m = mat.array;\r\n\r\n    o[ 0] = o[ 0] + m[ 0];\r\n    o[ 1] = o[ 1] + m[ 1];\r\n    o[ 2] = o[ 2] + m[ 2];\r\n    o[ 3] = o[ 3] + m[ 3];\r\n    o[ 4] = o[ 4] + m[ 4];\r\n    o[ 5] = o[ 5] + m[ 5];\r\n    o[ 6] = o[ 6] + m[ 6];\r\n    o[ 7] = o[ 7] + m[ 7];\r\n    o[ 8] = o[ 8] + m[ 8];\r\n    o[ 9] = o[ 9] + m[ 9];\r\n    o[10] = o[10] + m[10];\r\n    o[11] = o[11] + m[11];\r\n    o[12] = o[12] + m[12];\r\n    o[13] = o[13] + m[13];\r\n    o[14] = o[14] + m[14];\r\n    o[15] = o[15] + m[15];\r\n\r\n    return this;\r\n  }\r\n\r\n  public sub(mat: Matrix4): this {\r\n    const o = this._array;\r\n    const m = mat.array;\r\n\r\n    o[ 0] = o[ 0] - m[ 0];\r\n    o[ 1] = o[ 1] - m[ 1];\r\n    o[ 2] = o[ 2] - m[ 2];\r\n    o[ 3] = o[ 3] - m[ 3];\r\n    o[ 4] = o[ 4] - m[ 4];\r\n    o[ 5] = o[ 5] - m[ 5];\r\n    o[ 6] = o[ 6] - m[ 6];\r\n    o[ 7] = o[ 7] - m[ 7];\r\n    o[ 8] = o[ 8] - m[ 8];\r\n    o[ 9] = o[ 9] - m[ 9];\r\n    o[10] = o[10] - m[10];\r\n    o[11] = o[11] - m[11];\r\n    o[12] = o[12] - m[12];\r\n    o[13] = o[13] - m[13];\r\n    o[14] = o[14] - m[14];\r\n    o[15] = o[15] - m[15];\r\n\r\n    return this;\r\n  }\r\n\r\n  public mult(mat: Matrix4): this {\r\n    const o = this._array;\r\n    const m = mat.array;\r\n\r\n    const a11 = o[     0];\r\n    const a12 = o[     1];\r\n    const a13 = o[     2];\r\n    const a14 = o[     3];\r\n    const a21 = o[ 4 + 0];\r\n    const a22 = o[ 4 + 1];\r\n    const a23 = o[ 4 + 2];\r\n    const a24 = o[ 4 + 3];\r\n    const a31 = o[ 8 + 0];\r\n    const a32 = o[ 8 + 1];\r\n    const a33 = o[ 8 + 2];\r\n    const a34 = o[ 8 + 3];\r\n    const a41 = o[12 + 0];\r\n    const a42 = o[12 + 1];\r\n    const a43 = o[12 + 2];\r\n    const a44 = o[12 + 3];\r\n    const b11 = m[     0];\r\n    const b12 = m[     1];\r\n    const b13 = m[     2];\r\n    const b14 = m[     3];\r\n    const b21 = m[ 4 + 0];\r\n    const b22 = m[ 4 + 1];\r\n    const b23 = m[ 4 + 2];\r\n    const b24 = m[ 4 + 3];\r\n    const b31 = m[ 8 + 0];\r\n    const b32 = m[ 8 + 1];\r\n    const b33 = m[ 8 + 2];\r\n    const b34 = m[ 8 + 3];\r\n    const b41 = m[12 + 0];\r\n    const b42 = m[12 + 1];\r\n    const b43 = m[12 + 2];\r\n    const b44 = m[12 + 3];\r\n\r\n    o[ 0] = a11 * b11 + a21 * b12 + a31 * b13 + a41 * b14;\r\n    o[ 1] = a12 * b11 + a22 * b12 + a32 * b13 + a42 * b14;\r\n    o[ 2] = a13 * b11 + a23 * b12 + a33 * b13 + a43 * b14;\r\n    o[ 3] = a14 * b11 + a24 * b12 + a34 * b13 + a44 * b14;\r\n    o[ 4] = a11 * b21 + a21 * b22 + a31 * b23 + a41 * b24;\r\n    o[ 5] = a12 * b21 + a22 * b22 + a32 * b23 + a42 * b24;\r\n    o[ 6] = a13 * b21 + a23 * b22 + a33 * b23 + a43 * b24;\r\n    o[ 7] = a14 * b21 + a24 * b22 + a34 * b23 + a44 * b24;\r\n    o[ 8] = a11 * b31 + a21 * b32 + a31 * b33 + a41 * b34;\r\n    o[ 9] = a12 * b31 + a22 * b32 + a32 * b33 + a42 * b34;\r\n    o[10] = a13 * b31 + a23 * b32 + a33 * b33 + a43 * b34;\r\n    o[11] = a14 * b31 + a24 * b32 + a34 * b33 + a44 * b34;\r\n    o[12] = a11 * b41 + a21 * b42 + a31 * b43 + a41 * b44;\r\n    o[13] = a12 * b41 + a22 * b42 + a32 * b43 + a42 * b44;\r\n    o[14] = a13 * b41 + a23 * b42 + a33 * b43 + a43 * b44;\r\n    o[15] = a14 * b41 + a24 * b42 + a34 * b43 + a44 * b44;\r\n\r\n    return this;\r\n  }\r\n\r\n  public multScalar(k: number): this {\r\n    const o = this._array;\r\n    \r\n    o[ 0] = o[ 0] * k;\r\n    o[ 1] = o[ 1] * k;\r\n    o[ 2] = o[ 2] * k;\r\n    o[ 3] = o[ 3] * k;\r\n    o[ 4] = o[ 4] * k;\r\n    o[ 5] = o[ 5] * k;\r\n    o[ 6] = o[ 6] * k;\r\n    o[ 7] = o[ 7] * k;\r\n    o[ 8] = o[ 8] * k;\r\n    o[ 9] = o[ 9] * k;\r\n    o[10] = o[10] * k;\r\n    o[11] = o[11] * k;\r\n    o[12] = o[12] * k;\r\n    o[13] = o[13] * k;\r\n    o[14] = o[14] * k;\r\n    o[15] = o[15] * k;\r\n\r\n    return this;\r\n  }\r\n\r\n\tpublic getMaxScaleOnAxis(): number {\r\n    const o = this._array;\r\n\r\n    const scaleXSq = o[ 0] * o[ 0] + o[ 1] * o[ 1] + o[ 2] * o[ 2];\r\n    const scaleYSq = o[ 4] * o[ 4] + o[ 5] * o[ 5] + o[ 6] * o[ 6];\r\n    const scaleZSq = o[ 8] * o[ 8] + o[ 9] * o[ 9] + o[10] * o[10];\r\n\r\n    return Math.sqrt(Math.max(scaleXSq, scaleYSq, scaleZSq));\r\n  }\r\n\r\n  public writeIntoArray(out: WritableArrayLike<number>, offset: number = 0): void {\r\n\t\tconst m = this._array;\r\n\r\n\t\tout[offset     ] = m[ 0];\r\n\t\tout[offset +  1] = m[ 1];\r\n    out[offset +  2] = m[ 2];\r\n    out[offset +  3] = m[ 3];\r\n\t\tout[offset +  4] = m[ 4];\r\n    out[offset +  5] = m[ 5];\r\n    out[offset +  6] = m[ 6];\r\n\t\tout[offset +  7] = m[ 7];\r\n    out[offset +  8] = m[ 8];\r\n    out[offset +  9] = m[ 9];\r\n\t\tout[offset + 10] = m[10];\r\n    out[offset + 11] = m[11];\r\n    out[offset + 12] = m[12];\r\n\t\tout[offset + 13] = m[13];\r\n    out[offset + 14] = m[14];\r\n    out[offset + 15] = m[15];\r\n  }\r\n    \r\n  public readFromArray(arr: ArrayLike<number>, offset: number = 0): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = arr[offset     ];\r\n    o[ 1] = arr[offset +  1];\r\n    o[ 2] = arr[offset +  2];\r\n    o[ 3] = arr[offset +  3];\r\n    o[ 4] = arr[offset +  4];\r\n    o[ 5] = arr[offset +  5];\r\n    o[ 6] = arr[offset +  6];\r\n    o[ 7] = arr[offset +  7];\r\n    o[ 8] = arr[offset +  8];\r\n    o[ 9] = arr[offset +  9];\r\n    o[10] = arr[offset + 10];\r\n    o[11] = arr[offset + 11];\r\n    o[12] = arr[offset + 12];\r\n    o[13] = arr[offset + 13];\r\n    o[14] = arr[offset + 14];\r\n    o[15] = arr[offset + 15];\r\n\r\n    return this;\r\n  }\r\n\r\n  public solve(vecB: Vector4): Vector4Values {\r\n    const a = this._array;\r\n\r\n    const a11 = a[ 0];\r\n    const a12 = a[ 1];\r\n    const a13 = a[ 2];\r\n    const a14 = a[ 3];\r\n    const a21 = a[ 4];\r\n    const a22 = a[ 5];\r\n    const a23 = a[ 6];\r\n    const a24 = a[ 7];\r\n    const a31 = a[ 8];\r\n    const a32 = a[ 9];\r\n    const a33 = a[10];\r\n    const a34 = a[11];\r\n    const a41 = a[12];\r\n    const a42 = a[13];\r\n    const a43 = a[14];\r\n    const a44 = a[15];\r\n    const b00 = a11 * a22 - a12 * a21;\r\n    const b01 = a11 * a23 - a13 * a21;\r\n    const b02 = a11 * a24 - a14 * a21;\r\n    const b03 = a12 * a23 - a13 * a22;\r\n    const b04 = a12 * a24 - a14 * a22;\r\n    const b05 = a13 * a24 - a14 * a23;\r\n    const b06 = a31 * a42 - a32 * a41;\r\n    const b07 = a31 * a43 - a33 * a41;\r\n    const b08 = a31 * a44 - a34 * a41;\r\n    const b09 = a32 * a43 - a33 * a42;\r\n    const b10 = a32 * a44 - a34 * a42;\r\n    const b11 = a33 * a44 - a34 * a43;\r\n\r\n    const bX = vecB.x;\r\n    const bY = vecB.y;\r\n    const bZ = vecB.z;\r\n    const bW = vecB.w;\r\n\r\n    let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n    if (det != 0.0) {\r\n      det = 1.0 / det;\r\n    }\r\n\r\n    const x = det *\r\n      ((a22 * b11 - a23 * b10 + a24 * b09) * bX -\r\n      (a21 * b11 - a23 * b08 + a24 * b07) * bY +\r\n      (a21 * b10 - a22 * b08 + a24 * b06) * bZ -\r\n      (a21 * b09 - a22 * b07 + a23 * b06) * bW)\r\n    const y = det *\r\n      -((a12 * b11 - a13 * b10 + a14 * b09) * bX -\r\n      (a11 * b11 - a13 * b08 + a14 * b07) * bY +\r\n      (a11 * b10 - a12 * b08 + a14 * b06) * bZ -\r\n      (a11 * b09 - a12 * b07 + a13 * b06) * bW)\r\n    const z = det *\r\n      ((a42 * b05 - a43 * b04 + a44 * b03) * bX -\r\n      (a41 * b05 - a43 * b02 + a44 * b01) * bY +\r\n      (a41 * b04 - a42 * b02 + a44 * b00) * bZ -\r\n      (a41 * b03 - a42 * b01 + a43 * b00) * bW)\r\n    const w = det *\r\n      -((a32 * b05 - a33 * b04 + a34 * b03) * bX -\r\n      (a31 * b05 - a33 * b02 + a34 * b01) * bY +\r\n      (a31 * b04 - a32 * b02 + a34 * b00) * bZ -\r\n      (a31 * b03 - a32 * b01 + a33 * b00) * bW);\r\n    \r\n    return [\r\n      x, y, z, w\r\n    ];\r\n  }\r\n\r\n  public solve2(vecB: Vector2): Vector2Values {\r\n    const a = this._array;\r\n\r\n    const a11 = a[0];\r\n    const a12 = a[1];\r\n    const a21 = a[4];\r\n    const a22 = a[5];\r\n    const bx = vecB.x - a[8];\r\n    const by = vecB.y - a[9];\r\n    \r\n    let det = a11 * a22 - a12 * a21;\r\n\r\n    if (det != 0.0) {\r\n      det = 1.0 / det;\r\n    }\r\n\r\n    const x = det * (a22 * bx - a12 * by);\r\n    const y = det * (a11 * by - a21 * bx);\r\n\r\n    return [\r\n      x, y\r\n    ];\r\n  }\r\n\r\n  public solve3(vecB: Vector3): Vector3Values {\r\n    const a = this._array;\r\n\r\n    const a11 = a[ 0];\r\n    const a12 = a[ 1];\r\n    const a13 = a[ 2];\r\n    const a21 = a[ 4];\r\n    const a22 = a[ 5];\r\n    const a23 = a[ 6];\r\n    const a31 = a[ 8];\r\n    const a32 = a[ 9];\r\n    const a33 = a[10];\r\n    const bx = vecB.x - a[12];\r\n    const by = vecB.y - a[13];\r\n    const bz = vecB.z - a[14];\r\n\r\n    let rx = a22 * a33 - a23 * a32;\r\n    let ry = a23 * a31 - a21 * a33;\r\n    let rz = a21 * a32 - a22 * a31;\r\n\r\n    let det = a11 * rx + a12 * ry + a13 * rz;\r\n    if (det != 0.0) {\r\n      det = 1.0 / det;\r\n    }\r\n\r\n    const x = det * (bx * rx + by * ry + bz * rz);\r\n\r\n    rx = -(a32 * bz - a33 * by);\r\n    ry = -(a33 * bx - a31 * bz);\r\n    rz = -(a31 * by - a32 * bx);\r\n    \r\n    const y = det * (a11 * rx + a12 * ry + a13 * rz);\r\n    \r\n    rx = -(by * a23 - bz * a22);\r\n    ry = -(bz * a21 - bx * a23);\r\n    rz = -(bx * a22 - by * a21);\r\n    \r\n    const z = det * (a11 * rx + a12 * ry + a13 * rz);\r\n\r\n    return [\r\n      x, y, z\r\n    ];\r\n  }\r\n\r\n  public static translation(vec: Vector3): Matrix4Base {\r\n    return new Matrix4Base().setTranslation(vec);\r\n  }\r\n\r\n  public setTranslation(vec: Vector3): this {\r\n    const o = this._array;\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n\r\n    o[ 0] = 1;\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = 1;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = 1;\r\n    o[11] = 0;\r\n    o[12] = x;\r\n    o[13] = y;\r\n    o[14] = z;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public translate(vec: Vector3): this {\r\n    const o = this._array;\r\n\r\n    const m11 = o[ 0];\r\n    const m12 = o[ 1];\r\n    const m13 = o[ 2];\r\n    const m14 = o[ 3];\r\n    const m21 = o[ 4];\r\n    const m22 = o[ 5];\r\n    const m23 = o[ 6];\r\n    const m24 = o[ 7];\r\n    const m31 = o[ 8];\r\n    const m32 = o[ 9];\r\n    const m33 = o[10];\r\n    const m34 = o[11];\r\n    const m41 = o[12];\r\n    const m42 = o[13];\r\n    const m43 = o[14];\r\n    const m44 = o[15];\r\n\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n\r\n    o[12] = m11 * x + m21 * y + m31 * z + m41;\r\n    o[13] = m12 * x + m22 * y + m32 * z + m42;\r\n    o[14] = m13 * x + m23 * y + m33 * z + m43;\r\n    o[15] = m14 * x + m24 * y + m34 * z + m44;\r\n\r\n    return this;\r\n  }\r\n\r\n  public static rotationX(angleInRadians: number): Matrix4Base {\r\n    return new Matrix4Base().setRotationX(angleInRadians);\r\n  }\r\n\r\n  public setRotationX(angleInRadians: number): this {\r\n    const o = this._array;\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n\r\n    o[ 0] = 1;\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = c;\r\n    o[ 6] = s;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = -s;\r\n    o[10] = -c;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public rotateX(angleInRadians: number): this {\r\n    const o = this._array;\r\n\r\n    const m21 = o[ 4];\r\n    const m22 = o[ 5];\r\n    const m23 = o[ 6];\r\n    const m24 = o[ 7];\r\n    const m31 = o[ 8];\r\n    const m32 = o[ 9];\r\n    const m33 = o[10];\r\n    const m34 = o[11];\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n\r\n    o[ 8] = c * m21 + s * m31;\r\n    o[ 9] = c * m22 + s * m32;\r\n    o[10] = c * m23 + s * m33;\r\n    o[11] = c * m24 + s * m34;\r\n    o[12] = c * m31 - s * m21;\r\n    o[13] = c * m32 - s * m22;\r\n    o[14] = c * m33 - s * m23;\r\n    o[15] = c * m34 - s * m24;\r\n\r\n    return this;\r\n  }\r\n\r\n  public static rotationY(angleInRadians: number): Matrix4Base {\r\n    return new Matrix4Base().setRotationY(angleInRadians);\r\n  }\r\n\r\n  public setRotationY(angleInRadians: number): this {\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n    const o = this._array;\r\n\r\n    o[ 0] = c;\r\n    o[ 1] = 0;\r\n    o[ 2] = -s;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = 1;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = s;\r\n    o[ 9] = 0;\r\n    o[10] = c;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 1;\r\n    \r\n    return this;\r\n  }\r\n\r\n  public rotateY(angleInRadians: number): this {\r\n    const o = this._array;\r\n\r\n    const m11 = o[ 0];\r\n    const m12 = o[ 1];\r\n    const m13 = o[ 2];\r\n    const m14 = o[ 3];\r\n    const m31 = o[ 8];\r\n    const m32 = o[ 9];\r\n    const m33 = o[10];\r\n    const m34 = o[11];\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n\r\n    o[ 0] = c * m11 - s * m31;\r\n    o[ 1] = c * m12 - s * m32;\r\n    o[ 2] = c * m13 - s * m33;\r\n    o[ 3] = c * m14 - s * m34;\r\n\r\n    o[12] = c * m31 + s * m11;\r\n    o[13] = c * m32 + s * m12;\r\n    o[14] = c * m33 + s * m13;\r\n    o[15] = c * m34 + s * m14;\r\n\r\n    return this;\r\n  }\r\n\r\n  public static rotationZ(angleInRadians: number): Matrix4Base {\r\n    return new Matrix4Base().setRotationZ(angleInRadians);\r\n  }\r\n\r\n  public setRotationZ(angleInRadians: number): this {\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n    const o = this._array;\r\n\r\n    o[ 0] = c;\r\n    o[ 1] = s;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = -s;\r\n    o[ 5] = c;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = 1;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public rotateZ(angleInRadians: number): this {\r\n    const o = this._array;\r\n    const m11 = o[0];\r\n    const m12 = o[1];\r\n    const m13 = o[2];\r\n    const m14 = o[3];\r\n    const m21 = o[4];\r\n    const m22 = o[5];\r\n    const m23 = o[6];\r\n    const m24 = o[7];\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n    \r\n    o[ 4] = c * m11 + s * m21;\r\n    o[ 5] = c * m12 + s * m22;\r\n    o[ 6] = c * m13 + s * m23;\r\n    o[ 7] = c * m14 + s * m24;\r\n    o[ 8] = c * m21 - s * m11;\r\n    o[ 9] = c * m22 - s * m12;\r\n    o[10] = c * m23 - s * m13;\r\n    o[11] = c * m24 - s * m14;\r\n\r\n    return this;\r\n  }\r\n\r\n  public rotate(x: number, y: number, z: number): this {\r\n    this.rotateX(x);\r\n    this.rotateY(y);\r\n    this.rotateZ(z);\r\n\r\n    return this;\r\n  }\r\n\r\n  public axisRotation(axis: Vector3, angleInRadians: number): this {\r\n    let x = axis.x;\r\n    let y = axis.y;\r\n    let z = axis.z;\r\n\r\n    const n = Math.sqrt(x * x + y * y + z * z);\r\n    x /= n;\r\n    y /= n;\r\n    z /= n;\r\n    const xx = x * x;\r\n    const yy = y * y;\r\n    const zz = z * z;\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n    const oneMinusCosine = 1 - c;\r\n    const o = this._array;\r\n\r\n    o[ 0] = xx + (1 - xx) * c;\r\n    o[ 1] = x * y * oneMinusCosine + z * s;\r\n    o[ 2] = x * z * oneMinusCosine - y * s;\r\n    o[ 3] = 0;\r\n    o[ 4] = x * y * oneMinusCosine - z * s;\r\n    o[ 5] = yy + (1 - yy) * c;\r\n    o[ 6] = y * z * oneMinusCosine + x * s;\r\n    o[ 7] = 0;\r\n    o[ 8] = x * z * oneMinusCosine + y * s;\r\n    o[ 9] = y * z * oneMinusCosine - x * s;\r\n    o[10] = zz + (1 - zz) * c;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public rotateAxis(axis: Vector3, angleInRadians: number): this {\r\n    const o = this._array;\r\n\r\n    let x = axis.x;\r\n    let y = axis.y;\r\n    let z = axis.z;\r\n    const n = Math.sqrt(x * x + y * y + z * z);\r\n    x /= n;\r\n    y /= n;\r\n    z /= n;\r\n\r\n    const xx = x * x;\r\n    const yy = y * y;\r\n    const zz = z * z;\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n    const oneMinusCosine = 1 - c;\r\n\r\n    const r11 = xx + (1 - xx) * c;\r\n    const r12 = x * y * oneMinusCosine + z * s;\r\n    const r13 = x * z * oneMinusCosine - y * s;\r\n    const r21 = x * y * oneMinusCosine - z * s;\r\n    const r22 = yy + (1 - yy) * c;\r\n    const r23 = y * z * oneMinusCosine + x * s;\r\n    const r31 = x * z * oneMinusCosine + y * s;\r\n    const r32 = y * z * oneMinusCosine - x * s;\r\n    const r33 = zz + (1 - zz) * c;\r\n\r\n    const m11 = o[ 0];\r\n    const m12 = o[ 1];\r\n    const m13 = o[ 2];\r\n    const m14 = o[ 3];\r\n    const m21 = o[ 4];\r\n    const m22 = o[ 5];\r\n    const m23 = o[ 6];\r\n    const m24 = o[ 7];\r\n    const m31 = o[ 8];\r\n    const m32 = o[ 9];\r\n    const m33 = o[10];\r\n    const m34 = o[11];\r\n\r\n    o[ 0] = r11 * m11 + r12 * m21 + r13 * m31;\r\n    o[ 1] = r11 * m12 + r12 * m22 + r13 * m32;\r\n    o[ 2] = r11 * m13 + r12 * m23 + r13 * m33;\r\n    o[ 3] = r11 * m14 + r12 * m24 + r13 * m34;\r\n    o[ 4] = r21 * m11 + r22 * m21 + r23 * m31;\r\n    o[ 5] = r21 * m12 + r22 * m22 + r23 * m32;\r\n    o[ 6] = r21 * m13 + r22 * m23 + r23 * m33;\r\n    o[ 7] = r21 * m14 + r22 * m24 + r23 * m34;\r\n    o[ 8] = r31 * m11 + r32 * m21 + r33 * m31;\r\n    o[ 9] = r31 * m12 + r32 * m22 + r33 * m32;\r\n    o[10] = r31 * m13 + r32 * m23 + r33 * m33;\r\n    o[11] = r31 * m14 + r32 * m24 + r33 * m34;\r\n\r\n    return this;\r\n  }\r\n\r\n  public setScaling(vec: Vector3): this {\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n    const o = this._array;\r\n\r\n    o[ 0] = x;\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = y;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = z;\r\n    o[11] = 0;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = 0;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public scale(vec: Vector3): this {\r\n    const o = this._array;\r\n\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n\r\n    o[ 0] = x * o[ 0];\r\n    o[ 1] = x * o[ 1];\r\n    o[ 2] = x * o[ 2];\r\n    o[ 3] = x * o[ 3];\r\n    o[ 4] = y * o[ 4];\r\n    o[ 5] = y * o[ 5];\r\n    o[ 6] = y * o[ 6];\r\n    o[ 7] = y * o[ 7];\r\n    o[ 8] = z * o[ 8];\r\n    o[ 9] = z * o[ 9];\r\n    o[10] = z * o[10];\r\n    o[11] = z * o[11];\r\n\r\n    return this;\r\n  }\r\n\r\n  public scaleScalar(k: number): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = k * o[ 0];\r\n    o[ 1] = k * o[ 1];\r\n    o[ 2] = k * o[ 2];\r\n    o[ 3] = k * o[ 3];\r\n    o[ 4] = k * o[ 4];\r\n    o[ 5] = k * o[ 5];\r\n    o[ 6] = k * o[ 6];\r\n    o[ 7] = k * o[ 7];\r\n    o[ 8] = k * o[ 8];\r\n    o[ 9] = k * o[ 9];\r\n    o[10] = k * o[10];\r\n    o[11] = k * o[11];\r\n\r\n    return this;\r\n  }\r\n\r\n\r\n  public lookAt(eye: Vector3, target: Vector3, up: Vector3): this {\r\n    const o = this._array;\r\n\r\n    const e = eye.array;\r\n    const e0 = e[0];\r\n\t\tconst e1 = e[1];\r\n    const e2 = e[2];\r\n\r\n    const t = target.array;\r\n    const t0 = t[0];\r\n\t\tconst t1 = t[1];\r\n    const t2 = t[2];\r\n\r\n    const u = up.array;\r\n    const u0 = u[0];\r\n\t\tconst u1 = u[1];\r\n    const u2 = u[2];\r\n\r\n    let z0 = e0 - t0;\r\n\t\tlet z1 = e1 - t1;\r\n    let z2 = e2 - t2;\r\n    const zLen = Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\r\n    if (zLen > Number.EPSILON) {\r\n      z0 = z0 / zLen;\r\n      z1 = z1 / zLen;\r\n      z2 = z2 / zLen;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tz0 = 0;\r\n\t\t\tz1 = 0;\r\n\t\t\tz2 = 0;\r\n    }\r\n\r\n    let x0 = u1 * z2 - u2 * z1;\r\n\t\tlet x1 = u2 * z0 - u0 * z2;\r\n    let x2 = u0 * z1 - u1 * z0;\r\n    const xLen = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\r\n    if (xLen > Number.EPSILON) {\r\n      x0 = x0 / xLen;\r\n      x1 = x1 / xLen;\r\n      x2 = x2 / xLen;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tx0 = 0;\r\n\t\t\tx1 = 0;\r\n\t\t\tx2 = 0;\r\n    }\r\n\r\n    let y0 = z1 * x2 - z2 * x1;\r\n\t\tlet y1 = z2 * x0 - z0 * x2;\r\n\t\tlet y2 = z0 * x1 - z1 * x0;\r\n    const yLen = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\r\n    if (yLen > Number.EPSILON) {\r\n      y0 = y0 / yLen;\r\n      y1 = y1 / yLen;\r\n      y2 = y2 / yLen;\r\n\t\t}\r\n\t\telse {\r\n\t\t\ty0 = 0;\r\n\t\t\ty1 = 0;\r\n\t\t\ty2 = 0;\r\n    }\r\n\r\n    o[ 0] = x0;\r\n    o[ 1] = x1;\r\n    o[ 2] = x2;\r\n    o[ 3] = 0;\r\n    o[ 4] = y0;\r\n    o[ 5] = y1;\r\n    o[ 6] = y2;\r\n    o[ 7] = 0;\r\n    o[ 8] = z0;\r\n    o[ 9] = z1;\r\n    o[10] = z2;\r\n    o[11] = 0;\r\n    o[12] = e0;\r\n    o[13] = e1;\r\n    o[14] = e2;\r\n    o[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  public transformPoint(vec: Vector3): Vector3Values {\r\n    const m = this._array;\r\n\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n    const d = x * m[3] + y * m[7] + z * m[11] + m[15];\r\n\r\n    return [\r\n        (x * m[0] + y * m[4] + z * m[ 8] + m[12]) / d,\r\n        (x * m[1] + y * m[5] + z * m[ 9] + m[13]) / d,\r\n        (x * m[2] + y * m[6] + z * m[10] + m[14]) / d\r\n    ];\r\n  }\r\n\r\n  public transformDirection(vec: Vector3): Vector3Values {\r\n    const m = this._array;\r\n\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n\r\n    return [\r\n        x * m[0] + y * m[4] + z * m[ 8],\r\n        x * m[1] + y * m[5] + z * m[ 9],\r\n        x * m[2] + y * m[6] + z * m[10]\r\n    ];\r\n  }\r\n\r\n  public transformNormal(vec: Vector3): Vector3Values {\r\n    let out: Vector3Values;\r\n\r\n    const backup = this.values;\r\n\r\n    const m = this.invert().array;\r\n\r\n    const x = vec.x;\r\n    const y = vec.y;\r\n    const z = vec.z;\r\n\r\n    out = [\r\n      x * m[0] + y * m[4] + z * m[ 8],\r\n      x * m[1] + y * m[5] + z * m[ 9],\r\n      x * m[2] + y * m[6] + z * m[10]\r\n    ];\r\n\r\n    this.values = backup;\r\n\r\n    return out;\r\n  }\r\n\r\n  public asPerspective(fieldOfViewYInRadians: number, aspect: number, zNear: number, zFar: number): this {\r\n    const f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewYInRadians);\r\n    const rangeInv = 1.0 / (zNear - zFar);\r\n    const o = this._array;\r\n\r\n    o[ 0] = f / aspect;\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = f;\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = (zNear + zFar) * rangeInv;\r\n    o[11] = -1;\r\n    o[12] = 0;\r\n    o[13] = 0;\r\n    o[14] = zNear * zFar * rangeInv * 2;\r\n    o[15] = 0;\r\n    \r\n    return this;\r\n  }\r\n\r\n  public asOrthographic(left: number, right: number, bottom: number, top: number, near: number, far: number): this {\r\n    const o = this._array;\r\n\r\n    o[ 0] = 2 / (right - left);\r\n    o[ 1] = 0;\r\n    o[ 2] = 0;\r\n    o[ 3] = 0;\r\n    o[ 4] = 0;\r\n    o[ 5] = 2 / (top - bottom);\r\n    o[ 6] = 0;\r\n    o[ 7] = 0;\r\n    o[ 8] = 0;\r\n    o[ 9] = 0;\r\n    o[10] = 2 / (near - far);\r\n    o[11] = 0;\r\n    o[12] = (right + left) / (left - right);\r\n    o[13] = (top + bottom) / (bottom - top);\r\n    o[14] = (far + near) / (near - far);\r\n    o[15] = 1;\r\n    \r\n    return this;\r\n  }\r\n}\r\n\r\nvar Matrix4: Matrix4Constructor = Matrix4Base;\r\nconst Matrix4Injector: Injector<Matrix4Constructor> = new Injector({\r\n\tdefaultCtor: Matrix4Base,\r\n\tonDefaultOverride:\r\n\t\t(ctor: Matrix4Constructor) => {\r\n\t\t\tMatrix4 = ctor;\r\n\t\t}\r\n});","import { SingleTopicMessageBroker } from \"../../libs/patterns/messaging/brokers/SingleTopicMessageBroker\";\r\n\r\nexport { LogLevel };\r\nexport { LoggerMessage };\r\nexport { Logger };\r\nexport { LoggerBase };\r\n\r\nenum LogLevel {\r\n    DEBUG,\r\n    ERROR,\r\n    INFO,\r\n    LOG,\r\n    WARN\r\n}\r\n\r\ntype LoggerMessage = {level: LogLevel, message: string};\r\n\r\ninterface Logger {\r\n    log(message: string): void;\r\n    info(message: string): void;\r\n    warn(message: string): void;\r\n    debug(message: string): void;\r\n    error(message: string): void;\r\n    subscribe(subscription: (message: LoggerMessage) => void): (message: LoggerMessage) => void;\r\n\tunsubscribe(subscription: (message: LoggerMessage) => void): number;\r\n}\r\n\r\nclass LoggerBase implements Logger {\r\n\r\n    constructor() {}\r\n\r\n    public log(message: string): void {\r\n        const level = LogLevel.LOG;\r\n        message = this.formatMessage(level, message);\r\n        console.log(message);\r\n        this._onLog(level, message);\r\n    }\r\n\r\n    public info(message: string): void {\r\n        const level = LogLevel.INFO;\r\n        message = this.formatMessage(level, message);\r\n        console.info(message);\r\n        this._onLog(level, message);\r\n    }\r\n\r\n    public warn(message: string): void {\r\n        const level = LogLevel.WARN;\r\n        message = this.formatMessage(level, message);\r\n        console.warn(message);\r\n        this._onLog(level, message);\r\n    }\r\n\r\n    public debug(message: string): void {\r\n        const level = LogLevel.DEBUG;\r\n        message = this.formatMessage(level, message);\r\n        console.debug(message);\r\n        this._onLog(level, message);\r\n    }\r\n\r\n    public error(message: string): void {\r\n        const level = LogLevel.ERROR;\r\n        message = this.formatMessage(level, message);\r\n        console.error(message);\r\n        this._onLog(level, message);\r\n    }\r\n\r\n    protected _onLog(level: LogLevel, message: string): void {\r\n        this._broker.publish({level: level, message: message});\r\n    }\r\n\r\n    private _broker = new SingleTopicMessageBroker();\r\n\r\n    public subscribe(subscription: (message: LoggerMessage) => void): (message: LoggerMessage) => void {\r\n        return this._broker.subscribe(subscription);\r\n    }\r\n\r\n    public unsubscribe(subscription: (message: LoggerMessage) => void): number {\r\n        return this._broker.unsubscribe(subscription);\r\n    }\r\n\r\n    private formatMessage(level: LogLevel, message: string): string {\r\n        const time = this.getTimestamp();\r\n        return `[${time}] ${message}`;\r\n    }\r\n\r\n    private getTimestamp(): string {\r\n        return new Date().toLocaleTimeString(\"en-US\", {hour: \"numeric\", minute: \"numeric\", second: \"numeric\", hour12: false});\r\n    }\r\n}\r\n\r\nconst Logger: Logger = new LoggerBase();","export { SingleTopicMessagePublisher };\r\nexport { SingleTopicMessageSubscriber };\r\nexport { SingleTopicMessageBroker };\r\nexport { SingleTopicMessageBrokerBase };\r\n\r\ninterface SingleTopicMessagePublisher<M extends unknown = any> {\r\n    hasSubscriptions(): boolean;\r\n    publish(message: M): void\r\n}\r\n\r\ninterface SingleTopicMessageSubscriber<M extends unknown = any> {\r\n    hasSubscriptions(): boolean;\r\n    subscribe(subscription: (message: M) => void): (message: any) => void;\r\n    unsubscribe(subscription: (message: M) => void): number;\r\n}\r\n\r\ninterface SingleTopicMessageBroker<M extends unknown = any> extends SingleTopicMessagePublisher<M>, SingleTopicMessageSubscriber<M> {};\r\n\r\ninterface SingleTopicMessageBrokerConstructor {\r\n    readonly prototype: SingleTopicMessageBroker;\r\n    new(): SingleTopicMessageBroker;\r\n}\r\n\r\nclass SingleTopicMessageBrokerBase<M extends unknown = any> implements SingleTopicMessageBroker {\r\n    private _subscriptions: ((message: M) => void)[];\r\n\r\n    constructor() {\r\n        this._subscriptions = [];\r\n    }\r\n    \r\n    public hasSubscriptions(): boolean {\r\n        return this._subscriptions.length > 0;\r\n    }\r\n\r\n    public subscribe(subscription: (message: M) => void): (message: M) => void {\r\n        const index = this._subscriptions.indexOf(subscription);\r\n        if (index < 0) {\r\n            this._subscriptions.push(subscription);\r\n        }\r\n\r\n        return subscription;\r\n    }\r\n\r\n    public unsubscribe(subscription: (message: M) => void): number {\r\n        const index = this._subscriptions.indexOf(subscription);\r\n        if (index > -1) {\r\n            this._subscriptions.splice(index, 1);\r\n        }\r\n        return this._subscriptions.length;\r\n    }\r\n\r\n    public publish(message: M): void {\r\n        for (const subscription of this._subscriptions) {\r\n            subscription(message);\r\n        }\r\n    }\r\n}\r\n\r\nconst SingleTopicMessageBroker: SingleTopicMessageBrokerConstructor = SingleTopicMessageBrokerBase;","export class RessourceError extends Error {\r\n    name = 'RessourceError';\r\n}","import { RessourceError } from \"./ResourceError\";\r\n\r\n\r\nexport { ResourceFetcher };\r\n\r\nconst ResourceFetcher = Object.freeze({\r\n\r\n    async fetchArrayBuffer(url: string): Promise<ArrayBuffer> {\r\n        return fetch(url).then((resp) => {\r\n            if (resp.ok) {\r\n                return resp.arrayBuffer();\r\n            }\r\n            else {\r\n                throw new RessourceError(`Array buffer '${url}' not found.`);\r\n            }\r\n        });\r\n    },\r\n\r\n    async fetchTextFile(url: string): Promise<string> {\r\n        return fetch(url).then((resp) => {\r\n            if (resp.ok) {\r\n                return resp.text();\r\n            }\r\n            else {\r\n                throw new RessourceError(`Text file '${url}' not found.`);\r\n            }\r\n        });\r\n    },\r\n\r\n    async fetchJSON<T>(url: string): Promise<T> {\r\n        return fetch(url).then((resp) => {\r\n            if (resp.ok) {\r\n                return resp.json();\r\n            }\r\n            else {\r\n                throw new RessourceError(`JSON file '${url}' not found.`);\r\n            }\r\n        });\r\n    },\r\n\r\n    async fetchImage(url: string): Promise<HTMLImageElement> {\r\n        return fetch(url).then((resp) => {\r\n            if (resp.ok) {\r\n                return new Promise<HTMLImageElement>((resolve) => {\r\n                    const img = new Image();\r\n                    img.onload = () => {\r\n                        resolve(img);\r\n                    };\r\n                    img.src = url;\r\n                })\r\n            }\r\n            else {\r\n                throw new RessourceError(`Image '${url}' not found.`);\r\n            }\r\n        });\r\n    }\r\n});","import { Logger } from \"../core/logger/Logger\";\r\nimport { ResourceFetcher } from \"./ResourceFetcher\";\r\n\r\nexport { Resources };\r\n\r\ntype ResourcesList = {list: string[]};\r\n\r\nfunction extractExtension(filename: string): string {\r\n  return filename.substring(filename.lastIndexOf('.') + 1);\r\n}\r\n\r\nconst imageExtensions = ['png', 'jpg'];\r\nconst textExtensions = ['txt', 'md', 'vert', 'frag', 'glsl', 'json', 'html', 'css'];\r\n\r\ninterface Resources {\r\n  readonly folder: string;\r\n  get<T>(path: string): T | null;\r\n  toString(): string;\r\n  load(path: string): Promise<void>;\r\n  loadList(path: string): Promise<void>;\r\n}\r\n\r\ninterface ResourcesConstructor {\r\n  readonly prototype: Resources;\r\n  new(folder?: string): Resources;\r\n}\r\n\r\nclass ResourcesBase implements Resources {\r\n\r\n  public readonly folder: string;\r\n  private readonly resources: Map<string, any>;\r\n\r\n  constructor(folder?: string) {\r\n    this.folder = folder || '';\r\n    this.resources = new Map<string, any>();\r\n  }\r\n\r\n  public get<T>(file: string): T | null {\r\n    const resource = this.resources.get(file);\r\n\r\n    if (typeof resource === 'undefined') {\r\n      Logger.error(`Unknown resource '${file}'.`);\r\n      return null;\r\n    }\r\n\r\n    return resource as T;\r\n  }\r\n\r\n  public toString(): string {\r\n    return `[\\n\\t\\'${Array.from(this.resources.keys()).join(\"\\',\\n\\t\\'\")}\\'\\n]`;\r\n  }\r\n\r\n  public async load(path: string): Promise<void> {\r\n    let url = this.folder.concat(path);\r\n    const fetchResource = async function(path: string, url: string, map: Map<string, any>) {\r\n      const fileExt = extractExtension(path);\r\n      let file;\r\n      try {\r\n        if (imageExtensions.includes(fileExt)) {\r\n          file = await ResourceFetcher.fetchImage(url);\r\n        }\r\n        else if (textExtensions.includes(fileExt)) {\r\n          file = await ResourceFetcher.fetchTextFile(url);\r\n        }\r\n      }\r\n      catch (e) {\r\n        Logger.error(`Resource item '${url}' not found.`);\r\n        return;\r\n      }\r\n      map.set(path, file);\r\n    }\r\n    await fetchResource(path, url, this.resources);\r\n  }\r\n\r\n  public async loadList(path: string): Promise<void> {\r\n    let url = this.folder.concat(path);\r\n    let resources;\r\n    try {\r\n      resources = await ResourceFetcher.fetchJSON<ResourcesList>(url);\r\n    }\r\n    catch (e) {\r\n      Logger.error(`Resources list '${url}' not found.`);\r\n      return;\r\n    }\r\n\r\n    const fetchResource = async function(resource: string, folder: string, map: Map<string, any>) {\r\n      const fileExt = extractExtension(resource);\r\n      let file;\r\n      try {\r\n        if (imageExtensions.includes(fileExt)) {\r\n          file = await ResourceFetcher.fetchImage(folder.concat(resource));\r\n        }\r\n        else if (textExtensions.includes(fileExt)) {\r\n          file = await ResourceFetcher.fetchTextFile(folder.concat(resource));\r\n        }\r\n      }\r\n      catch (e) {\r\n        Logger.error(`Resource item '${url}' not found.`);\r\n        return;\r\n      }\r\n      map.set(resource, file);\r\n    }\r\n\r\n    for (const resource of resources.list) {\r\n      await fetchResource(resource, this.folder, this.resources);\r\n    }\r\n  }\r\n}\r\n\r\nconst Resources: ResourcesConstructor = ResourcesBase;","import { ArcBallControl } from \"../../engine/core/controls/ArcBallControl\";\r\nimport { Transform } from \"../../engine/core/general/Transform\";\r\nimport { Input, MouseButton } from \"../../engine/core/input/Input\";\r\nimport { PerspectiveCamera } from \"../../engine/core/rendering/scenes/cameras/PerspectiveCamera\";\r\nimport { CubeGeometry } from \"../../engine/core/rendering/scenes/geometries/lib/polyhedron/CubeGeometry\";\r\nimport { IcosahedronGeometry } from \"../../engine/core/rendering/scenes/geometries/lib/polyhedron/IcosahedronGeometry\";\r\nimport { QuadGeometry } from \"../../engine/core/rendering/scenes/geometries/lib/QuadGeometry\";\r\nimport { TextureWrapMode, TextureMagFilter, TextureMinFilter, BufferDataUsage, FramebufferTextureTarget, FramebufferAttachment, Parameter, PixelFormat, Capabilities, BufferMaskBit, TestFunction } from \"../../engine/core/rendering/webgl/WebGLConstants\";\r\nimport { WebGLFramebufferUtilities } from \"../../engine/core/rendering/webgl/WebGLFramebufferUtilities\";\r\nimport { WebGLPacketUtilities, Packet } from \"../../engine/core/rendering/webgl/WebGLPacketUtilities\";\r\nimport { WebGLProgramUtilties } from \"../../engine/core/rendering/webgl/WebGLProgramUtilities\";\r\nimport { WebGLRenderbufferUtilities } from \"../../engine/core/rendering/webgl/WebGLRenderbuffersUtilities\";\r\nimport { WebGLRendererUtilities } from \"../../engine/core/rendering/webgl/WebGLRendererUtilities\";\r\nimport { WebGLTextureUtilities } from \"../../engine/core/rendering/webgl/WebGLTextureUtilities\";\r\nimport { Color } from \"../../engine/libs/graphics/colors/Color\";\r\nimport { EulerAngles } from \"../../engine/libs/maths/algebra/angles/EulerAngles\";\r\nimport { Matrix3 } from \"../../engine/libs/maths/algebra/matrices/Matrix3\";\r\nimport { Matrix4 } from \"../../engine/libs/maths/algebra/matrices/Matrix4\";\r\nimport { Quaternion } from \"../../engine/libs/maths/algebra/quaternions/Quaternion\";\r\nimport { Vector2 } from \"../../engine/libs/maths/algebra/vectors/Vector2\";\r\nimport { Vector3, Vector3Values } from \"../../engine/libs/maths/algebra/vectors/Vector3\";\r\nimport { Vector4, Vector4Values } from \"../../engine/libs/maths/algebra/vectors/Vector4\";\r\nimport { Space } from \"../../engine/libs/maths/geometry/space/Space\";\r\nimport { clamp } from \"../../engine/libs/maths/Snippets\";\r\nimport { Resources } from \"../../engine/resources/Resources\";\r\n\r\nconst simpleSceneDOM = /*template*/`\r\n<link rel=\"stylesheet\" href=\"../css/main.css\"/>\r\n  <div class=\"flex-auto flex-cols\">\r\n    <main class=\"flex-rows flex-auto\">\r\n        <section class=\"centered padded\">\r\n          <div id=\"ui\" class=\"flex-cols\">\r\n            <div class=\"flex-auto\"><span class=\"blue\">\"RigidBuddy FTW!\"</span> <span class=\"yellow\">:-)</span></div>\r\n            <div class=\"flex-none\">FPS: <span id=\"canvas-fps\">-.-</span></div>\r\n          </div>\r\n          <canvas id=\"canvas\" tabindex=\"0\" tooltip=\"mon-canvas\"></canvas>\r\n        </section>\r\n    </main>\r\n  </div>`;\r\n\r\nexport async function start() {\r\n\r\n  const template = document.createElement('template');\r\n\r\n  template.innerHTML = simpleSceneDOM;\r\n  document.body.insertBefore(template.content, document.body.firstChild);\r\n\r\n  /*const imports = Array.from(document.getElementsByTagName('e-import'));\r\n  Promise.all(imports.map((imp) => {\r\n    return new Promise((resolve) => {\r\n      imp.addEventListener('loaded', () => {\r\n        resolve(true);\r\n      }, {once: true});\r\n    })\r\n  })).then(function(){ */\r\n    //editor.setup().then(() => {\r\n      launchScene();\r\n    //});\r\n  //});\r\n}\r\n/*\r\nfunction test() {\r\n  const data = [\r\n    {\r\n      name: 'John Doe',\r\n      age: 25\r\n    },\r\n    {\r\n      name: 'Jane Doe',\r\n      age: 24\r\n    }\r\n  ];\r\n\r\n  const table = HTMLTableTemplate({\r\n    headerCells: Object.keys(data[0]),\r\n    bodyCells: data.map(data => {\r\n      return [{type: 'header', content: data.name}, data.age.toString()];\r\n    }),\r\n    footerCells: [\r\n      {type: 'header', content: 'Total age'},\r\n      data.reduce((acc, curr) => {\r\n        return (acc + curr.age);\r\n      }, 0).toString()\r\n    ]\r\n  });\r\n\r\n  document.querySelector('#play-panel')!.append(table);\r\n}*/\r\n\r\nexport async function launchScene() {\r\n  let frameRequest: number;\r\n  let render: (time: number) => void;\r\n  let fps: number = 0;\r\n\r\n  const canvas = document.getElementById('canvas') as HTMLCanvasElement;\r\n\r\n  if (!canvas) {\r\n    return;\r\n  }\r\n  \r\n  canvas.width = 1200;\r\n  canvas.height = 800;\r\n  \r\n  \r\n  const gl = canvas.getContext('webgl2');\r\n  if (!gl) {\r\n    return;\r\n  }\r\n\r\n  const assets = new Resources('assets/engine/');\r\n  await assets.loadList('resources.json');\r\n\r\n  // Shaders\r\n  const phongVert = assets.get<string>('shaders/common/phong.vert')!;\r\n  const phongFrag = assets.get<string>('shaders/common/phong.frag')!;\r\n\r\n  const skyboxVert = assets.get<string>('shaders/common/skybox.vert')!;\r\n  const skyboxFrag = assets.get<string>('shaders/common/skybox.frag')!;\r\n\r\n  const textureVert = assets.get<string>('shaders/common/texture.vert')!;\r\n  const textureFrag = assets.get<string>('shaders/common/texture.frag')!;\r\n\r\n  const primitiveVert = assets.get<string>('shaders/common/primitive.vert')!;\r\n  const primitiveFrag = assets.get<string>('shaders/common/primitive.frag')!;\r\n\r\n  // Images\r\n  const albedoMapImg = assets.get<HTMLImageElement>('img/brickwall.jpg')!;\r\n  const normalMapImg = assets.get<HTMLImageElement>('img/brickwall_normal.jpg')!;\r\n  const skyboxXPosImg = assets.get<HTMLImageElement>('img/skybox_x_pos.png')!;\r\n  const skyboxXNegImg = assets.get<HTMLImageElement>('img/skybox_x_neg.png')!;\r\n  const skyboxYPosImg = assets.get<HTMLImageElement>('img/skybox_y_pos.png')!;\r\n  const skyboxYNegImg = assets.get<HTMLImageElement>('img/skybox_y_neg.png')!;\r\n  const skyboxZPosImg = assets.get<HTMLImageElement>('img/skybox_z_pos.png')!;\r\n  const skyboxZNegImg = assets.get<HTMLImageElement>('img/skybox_z_neg.png')!;\r\n  const wavesNormalImg = assets.get<HTMLImageElement>('img/waves_normal.png')!;\r\n\r\n  const phongGlProg = WebGLProgramUtilties.createProgramFromSources(gl, phongVert, phongFrag)!;\r\n  const skyboxGlProg = WebGLProgramUtilties.createProgramFromSources(gl, skyboxVert, skyboxFrag)!;\r\n  const texGlProg = WebGLProgramUtilties.createProgramFromSources(gl, textureVert, textureFrag)!;\r\n  const primitiveGlProg = WebGLProgramUtilties.createProgramFromSources(gl, primitiveVert, primitiveFrag)!;\r\n\r\n  const cube = new CubeGeometry();\r\n  const icosahedron = new IcosahedronGeometry();\r\n  const quad = new QuadGeometry();\r\n  \r\n  const packetBindings = WebGLPacketUtilities.createPacketBindings(gl, {\r\n    texturesProps: {\r\n      albedoMap: WebGLTextureUtilities.guessTextureProperties({pixels: albedoMapImg}),\r\n      normalMap: WebGLTextureUtilities.guessTextureProperties({pixels: normalMapImg}),\r\n      skybox: \r\n        WebGLTextureUtilities.guessTextureProperties({\r\n          pixels: {\r\n            xPos: skyboxXPosImg, xNeg: skyboxXNegImg,\r\n            yPos: skyboxYPosImg, yNeg: skyboxYNegImg,\r\n            zPos: skyboxZPosImg, zNeg: skyboxZNegImg\r\n          },\r\n          wrapS: TextureWrapMode.CLAMP_TO_EDGE,\r\n          wrapT: TextureWrapMode.CLAMP_TO_EDGE,\r\n          wrapR: TextureWrapMode.CLAMP_TO_EDGE,\r\n          mag: TextureMagFilter.LINEAR,\r\n          min: TextureMinFilter.LINEAR\r\n        }),\r\n      fbColorTex:\r\n        WebGLTextureUtilities.guessTextureProperties({\r\n          width: canvas.width, height: canvas.height, pixels: null,\r\n          wrapS: TextureWrapMode.CLAMP_TO_EDGE,\r\n          wrapT: TextureWrapMode.CLAMP_TO_EDGE,\r\n          wrapR: TextureWrapMode.CLAMP_TO_EDGE,\r\n          mag: TextureMagFilter.LINEAR,\r\n          min: TextureMinFilter.LINEAR\r\n        }),\r\n    },\r\n    blocksProps: {\r\n      worldViewBlock: {name: 'WorldViewBlock', usage: BufferDataUsage.DYNAMIC_COPY },\r\n      lightsBlock: {name: 'LightsBlock', usage: BufferDataUsage.STATIC_READ },\r\n      phongBlock: {name: 'PhongBlock', usage: BufferDataUsage.STATIC_READ }\r\n    }\r\n  })!;\r\n  \r\n  const worldViewBlock = packetBindings.blocks.worldViewBlock;\r\n  const lightsBlock = packetBindings.blocks.lightsBlock;\r\n  const phongBlock = packetBindings.blocks.phongBlock;\r\n\r\n  const albedoMap = packetBindings.textures.albedoMap;\r\n  const normalMap = packetBindings.textures.normalMap;\r\n  const skybox = packetBindings.textures.skybox;\r\n\r\n  const fbColorTex = packetBindings.textures.fbColorTex;\r\n\r\n  const fov = 30 * Math.PI / 180;\r\n  const aspect = gl.canvas.width / gl.canvas.height;\r\n  const zNear = 1;\r\n  const zFar = 100;\r\n  const projection = new Matrix4().asPerspective(fov, aspect, zNear, zFar);\r\n\r\n  //const cam = new PerspectiveCamera(fov, aspect, zNear, zFar);\r\n\r\n  const eye: Vector3 = new Vector3([3, 3, 0]);\r\n  const target: Vector3 = new Vector3([0, 0, 0]);\r\n  const up: Vector3 = new Vector3([0, 1, 0]);\r\n  const camera = new Matrix4().lookAt(eye, target, up);\r\n  \r\n  //const cameraTransform = new Transform();\r\n\r\n  const viewInverse = camera.clone();\r\n  const view = camera.clone().invert();\r\n  const viewProjection = projection.clone().mult(view);\r\n  const viewProjectionInverse = viewProjection.clone().invert();\r\n\r\n  /*const cubeTransform = new Transform();\r\n  const quadTransform = new Transform();*/\r\n  \r\n  const cubeWorldArr = new Float32Array(16);\r\n  const cubeWorld = new Matrix4().setArray(cubeWorldArr).setIdentity().scaleScalar(0.5);\r\n  const quadWorld = new Matrix4().setIdentity().scaleScalar(2);\r\n\r\n  /*const vectorInput = document.createElement('e-vector3-input') as Vector3InputElement;\r\n  vectorInput.vector.setArray(cubeWorldArr.subarray(12, 15));\r\n  \r\n  document.querySelector('#panel-3 section')!.append(vectorInput);*/\r\n\r\n  const phongCubePacketValues: Packet = {\r\n\r\n    attributes: {\r\n        list: {\r\n          a_position: { array: new Float32Array(cube.vertices.array), props: { numComponents: 3 } },\r\n          a_normal: { array: new Float32Array(cube.verticesNormals.array), props: { numComponents: 3 } },\r\n          a_tangent: { array: new Float32Array(cube.tangents.array), props: { numComponents: 3 } },\r\n          a_bitangent: { array: new Float32Array(cube.bitangents.array), props: { numComponents: 3 } },\r\n          a_color: { array:\r\n              new Float32Array(Color.array(\r\n                ...Array(cube.indices.length).fill(Color.BLUE)\r\n              )), props: { numComponents: 4, normalized: true }\r\n          },\r\n          a_uv: { array: new Float32Array(cube.uvs.array), props: { numComponents: 2 } },\r\n      },\r\n      indices: new Uint16Array(cube.indices),\r\n    },\r\n\r\n    uniformBlocks: {\r\n      worldViewBlock: {\r\n        block: worldViewBlock,\r\n        list: {\r\n          u_world: { value: new Float32Array(cubeWorld.array) },\r\n          u_viewInverse: { value: new Float32Array(camera.array) },\r\n          u_worldInverseTranspose: { value: new Float32Array(cubeWorld.clone().invert().transpose().array) },\r\n          u_worldViewProjection: { value: new Float32Array(viewProjection.clone().mult(cubeWorld).array) }\r\n        }\r\n      },\r\n      lightsBlock: {\r\n        block: lightsBlock,\r\n        list: {\r\n          u_lightWorldPos: { value: [1, 6, -6] },\r\n          u_lightColor: { value: [1, 0.8, 0.8, 1] },\r\n          u_ambient: { value: [0, 0, 0, 1] },\r\n        }\r\n      },\r\n      phongBlock: {\r\n        block: phongBlock,\r\n        list: {\r\n          u_specular: { value: [1, 1, 1, 1] },\r\n          u_shininess: { value: 50 },\r\n          u_specularFactor: { value: 1 }\r\n        }\r\n      }\r\n    },\r\n\r\n    uniforms: {\r\n      u_diffuseMap: { value: albedoMap },\r\n      u_normalMap: { value: normalMap }\r\n    }\r\n  };\r\n\r\n  const skyboxPacketValues: Packet = {\r\n\r\n    attributes: {\r\n        list: {\r\n          a_position: { array: new Float32Array(quad.vertices.array), props: { numComponents: 3 } },\r\n      },\r\n      indices: new Uint16Array(quad.indices),\r\n    },\r\n    \r\n    uniforms: {\r\n      u_world: { value: new Float32Array(quadWorld.array) },\r\n      u_viewDirectionProjectionInverse: { value: new Float32Array(viewProjectionInverse.array) }, \r\n      u_skybox: { value: skybox },\r\n    }\r\n  };\r\n\r\n  const texPacketValues: Packet = {\r\n    attributes: {\r\n        list: {\r\n          a_position: { array: new Float32Array(quad.vertices.array), props: { numComponents: 3 } },\r\n          a_uv: { array: new Float32Array(quad.uvs.array), props: { numComponents: 2 } },\r\n      },\r\n      indices: new Uint16Array(quad.indices),\r\n    },\r\n\r\n    uniforms: {\r\n      u_world: { value: new Float32Array(new Matrix4().setIdentity().values) },\r\n      u_tex: { value: fbColorTex }\r\n    }\r\n  };\r\n\r\n\r\n  WebGLProgramUtilties.useProgram(gl, phongGlProg);\r\n  const phongCubePacketSetter = WebGLPacketUtilities.getPacketSetter(gl, phongGlProg, phongCubePacketValues)!;\r\n  WebGLPacketUtilities.setPacketValues(gl, phongCubePacketSetter, phongCubePacketValues);\r\n\r\n\r\n  WebGLProgramUtilties.useProgram(gl, skyboxGlProg);\r\n  const skyboxPacketSetter = WebGLPacketUtilities.getPacketSetter(gl, skyboxGlProg, skyboxPacketValues)!;\r\n  WebGLPacketUtilities.setPacketValues(gl, skyboxPacketSetter, skyboxPacketValues);\r\n\r\n  const fb = WebGLFramebufferUtilities.createFramebuffer(gl)!;\r\n\r\n  WebGLFramebufferUtilities.attachTexture(\r\n    gl, fb, \r\n      {\r\n        texTarget: FramebufferTextureTarget.TEXTURE_2D,\r\n        glTex: fbColorTex.glTex,\r\n        attachment: FramebufferAttachment.COLOR_ATTACHMENT0\r\n      }\r\n  );\r\n\r\n  const maxSamples = WebGLRendererUtilities.getParameter(gl, Parameter.MAX_SAMPLES);\r\n  \r\n  const stencilRb = WebGLRenderbufferUtilities.createRenderbuffer(gl, {\r\n    internalFormat: PixelFormat.DEPTH24_STENCIL8,\r\n    width: canvas.width,\r\n    height: canvas.height,\r\n    samples: maxSamples\r\n  })!;\r\n\r\n  const antialiasRb = WebGLRenderbufferUtilities.createRenderbuffer(gl, {\r\n    internalFormat: PixelFormat.RGBA8,\r\n    width: canvas.width,\r\n    height: canvas.height,\r\n    samples: maxSamples\r\n  })!;\r\n\r\n  WebGLFramebufferUtilities.attachRenderbuffers(\r\n    gl, fb,\r\n      [{\r\n        glRb: stencilRb.glRb,\r\n        attachment: FramebufferAttachment.DEPTH_STENCIL_ATTACHMENT\r\n      },\r\n      {\r\n        glRb: antialiasRb.glRb,\r\n        attachment: FramebufferAttachment.COLOR_ATTACHMENT0,\r\n      }]\r\n  );\r\n\r\n  const postFb = WebGLFramebufferUtilities.createFramebuffer(gl)!;\r\n\r\n  WebGLFramebufferUtilities.attachTexture(\r\n    gl, postFb, \r\n      {\r\n        texTarget: FramebufferTextureTarget.TEXTURE_2D,\r\n        glTex: fbColorTex.glTex,\r\n        attachment: FramebufferAttachment.COLOR_ATTACHMENT0\r\n      }\r\n  );\r\n\r\n\r\n  WebGLProgramUtilties.useProgram(gl, texGlProg);\r\n  const texPacketSetter = WebGLPacketUtilities.getPacketSetter(gl, texGlProg, texPacketValues)!;\r\n  WebGLPacketUtilities.setPacketValues(gl, texPacketSetter, texPacketValues);\r\n\r\n\r\n  WebGLRendererUtilities.setViewport(gl, 0, 0, gl.canvas.width, gl.canvas.height);\r\n\r\n  WebGLRendererUtilities.enable(gl, Capabilities.DEPTH_TEST);\r\n  WebGLRendererUtilities.enable(gl, Capabilities.CULL_FACE);\r\n\r\n  \r\n  let lastFrameTime = 0;\r\n  let deltaTime = 0;\r\n    \r\n  await Input.initialize(document.body);\r\n  \r\n  render = function(frameTime: number) {\r\n    \r\n    frameTime *= 0.001;\r\n\r\n    deltaTime = frameTime - lastFrameTime;\r\n    lastFrameTime = frameTime;\r\n    fps = 1 / deltaTime;\r\n\r\n    //canvasFPS!.innerHTML = fps.toFixed(2);\r\n    \r\n    WebGLRendererUtilities.clearColor(gl, Color.GREEN.valuesNormalized());\r\n    WebGLRendererUtilities.clear(gl, BufferMaskBit.COLOR_BUFFER_BIT | BufferMaskBit.DEPTH_BUFFER_BIT);\r\n\r\n    updateCamera(camera, target, up);\r\n\r\n    viewInverse.copy(camera);\r\n    view.copy(viewInverse).invert();\r\n    viewProjection.copy(projection).mult(view);\r\n    viewProjectionInverse.copy(viewProjection).invert();\r\n\r\n    //cubeWorld.rotateY(deltaTime);\r\n    //viewProjectionInverse.rotateY(deltaTime / 2);\r\n    //viewProjectionInverse.rotateX(deltaTime);\r\n\r\n\r\n\r\n\r\n    // Framebuffer\r\n\r\n    WebGLFramebufferUtilities.bindFramebuffer(gl, fb);\r\n\r\n    // Framebuffer\r\n\r\n    WebGLRendererUtilities.clear(gl, BufferMaskBit.COLOR_BUFFER_BIT | BufferMaskBit.DEPTH_BUFFER_BIT);\r\n    \r\n\r\n    WebGLProgramUtilties.useProgram(gl, phongGlProg);\r\n    WebGLPacketUtilities.setPacketValues(gl, phongCubePacketSetter, {\r\n      uniformBlocks: {\r\n        worldViewBlock: {\r\n          block: worldViewBlock,\r\n          list: {\r\n            u_world: { value: new Float32Array(cubeWorld.array) },\r\n            u_viewInverse: { value: new Float32Array(viewInverse.array) },\r\n            u_worldInverseTranspose: { value: new Float32Array(cubeWorld.clone().invert().transpose().array) },\r\n            u_worldViewProjection: { value: new Float32Array(viewProjection.clone().mult(cubeWorld).array) }\r\n          }\r\n        }\r\n      }\r\n    });\r\n    WebGLRendererUtilities.depthFunc(gl, TestFunction.LESS);\r\n    WebGLPacketUtilities.drawPacket(gl, phongCubePacketSetter);\r\n\r\n\r\n    WebGLProgramUtilties.useProgram(gl, skyboxGlProg);\r\n    WebGLPacketUtilities.setPacketValues(gl, skyboxPacketSetter, {\r\n      uniforms: {\r\n        u_world: { value: new Float32Array(quadWorld.array) },\r\n        u_viewDirectionProjectionInverse: { value: new Float32Array(viewProjectionInverse.array) }\r\n      }\r\n    });\r\n\r\n    WebGLRendererUtilities.depthFunc(gl, TestFunction.LEQUAL);\r\n    WebGLPacketUtilities.drawPacket(gl, skyboxPacketSetter);\r\n\r\n    \r\n    // Framebuffer\r\n\r\n    WebGLFramebufferUtilities.blit(gl, fb, postFb,\r\n      [0, 0, canvas.width, canvas.height],\r\n      [0, 0, canvas.width, canvas.height],\r\n      BufferMaskBit.COLOR_BUFFER_BIT,\r\n      TextureMagFilter.LINEAR\r\n    );\r\n    \r\n    WebGLFramebufferUtilities.unbindFramebuffer(gl);\r\n\r\n    WebGLProgramUtilties.useProgram(gl, texGlProg);\r\n    WebGLRendererUtilities.depthFunc(gl, TestFunction.LEQUAL);\r\n    WebGLPacketUtilities.drawPacket(gl, texPacketSetter);\r\n\r\n    // Framebuffer\r\n\r\n    Input.clear();\r\n\r\n    //frameRequest = requestAnimationFrame(render);\r\n  }\r\n\r\n  render(0);\r\n}\r\n\r\nlet lastPos = new Vector2();\r\nfunction updateCamera(camera: Matrix4, target: Vector3, up: Vector3) {\r\n  if (Input.getMouseButtonDown(MouseButton.RIGHT)) {\r\n    lastPos.copy(Input.getMouseButtonPosition());\r\n  }\r\n\r\n  if (Input.getMouseButton(MouseButton.RIGHT)) {\r\n    const newPos = Input.getMouseButtonPosition();\r\n    \r\n    if (!newPos.equals(lastPos)) {\r\n\r\n      const angleX = (newPos.x - lastPos.x);\r\n      const angleY = (newPos.y - lastPos.y);\r\n\r\n      //console.log(eye.values);\r\n\r\n      //const euler = EulerAngles.fromMatrix(new Matrix3(camera.getUpper33()));\r\n\r\n      /*const viewVector = new Vector3([\r\n        Math.cos(euler.yaw) * Math.cos(euler.pitch),\r\n        Math.sin(euler.pitch),\r\n        -Math.sin(euler.yaw) * Math.cos(euler.pitch)\r\n      ]);\r\n\r\n      const rightVector = viewVector.clone().cross(new Vector3([0, 1, 0]));\r\n      const upVector = viewVector.clone().cross(rightVector);\r\n\r\n      const quaternion = new Quaternion([viewVector.x, viewVector.y, viewVector.z, 0]);*/\r\n\r\n      \r\n      \r\n      /*const eye = new Vector3([camera.m41, camera.m42, camera.m43]);\r\n      const radius = eye.clone().sub(target);\r\n\r\n      const cameraRight = new Vector3([camera.m11, camera.m12, camera.m13]).normalize();\r\n\r\n      const quat = Quaternion.fromMatrix(new Matrix3(camera.getUpper33())).normalize();\r\n      //const xRot = new Quaternion().setFromAxisAngle(cameraRight, angleX);\r\n      //const yRot = new Quaternion().setFromAxisAngle(Space.up, angleY);\r\n\r\n      //const newQuat = yRot.clone().mult(xRot.clone().mult(quat).mult(xRot.clone().conjugate())).mult(yRot.clone().conjugate());\r\n      //const newPosition = yRot.clone().mult(xRot.clone().mult(Quaternion.fromVector(eye)).mult(xRot.clone().conjugate())).mult(yRot.clone().conjugate()).toVector();\r\n\r\n      const newMat = quat.toMatrix();\r\n\r\n      camera.m41 = eye.x;\r\n      camera.m42 = eye.y;\r\n      camera.m43 = eye.z;\r\n      camera.setUpper33(newMat.values);*/\r\n\r\n      //camera.lookAt(newPosition, target, up);\r\n\r\n      /*const cameraRight = new Vector3([camera.m11, camera.m12, camera.m13]).normalize();\r\n      const cameraUp = new Vector3([camera.m21, camera.m22, camera.m23]).normalize();\r\n\r\n      const rotatedX = new Matrix4().setIdentity().rotateAxis(cameraUp, -angleX);\r\n      const rotatedY = new Matrix4().setIdentity().rotateAxis(cameraRight, -angleY);\r\n\r\n      camera.copy(\r\n        Matrix4.translation(\r\n          radius.clone().negate()\r\n        ).mult(\r\n          rotatedX\r\n        ).mult(\r\n          rotatedY\r\n        ).mult(\r\n          Matrix4.translation(\r\n            target.clone().negate()\r\n          )\r\n        )\r\n      );\r\n      \r\n      //camera.lookAt(viewVector, target, upVector);\r\n\r\n      /*const cameraRight = new Vector3([camera.m11, camera.m12, camera.m13]);\r\n      const cameraUp = new Vector3([camera.m21, camera.m22, camera.m23]);\r\n\r\n      eye.copy(\r\n        Vector3.mult(\r\n          new Matrix3(new Matrix4().setIdentity().rotateAxis(cameraUp, angleX).getUpper33()),\r\n          eye.clone().sub(target)\r\n        ).add(target)\r\n      );\r\n\r\n      eye.copy(\r\n        Vector3.mult(\r\n          new Matrix3(new Matrix4().setIdentity().rotateAxis(cameraRight, angleY).getUpper33()),\r\n          eye.clone().sub(target)\r\n        ).add(target)\r\n      );\r\n      \r\n      camera.lookAt(eye, target, up);*/\r\n\r\n      lastPos.copy(newPos);\r\n    }\r\n  }\r\n}","import { start } from \"./src/samples/scenes/SimpleScene\";\r\n\r\nexport async function main() {\r\n    start();\r\n}"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","Injector","constructor","args","this","_defaultCtor","defaultCtor","_onDefaultOverride","onDefaultOverride","_constructors","Map","overrideDefaultCtor","forceQualifier","qualifier","_forcedQualifier","unforceQualifier","getConstructor","qualifierValue","Error","inject","Array","from","register","has","set","MathError","name","Vector2Base","values","_array","array","x","y","setArray","length","setValues","v","equals","vec","copy","clone","setZeros","add","addScalar","k","sub","lerp","t","clamp","min","max","l","g","Math","multScalar","cross","a","b","dot","len","sqrt","lenSq","dist","dx","dy","distSq","normalize","Number","EPSILON","negate","mult","addScaled","writeIntoArray","out","offset","readFromArray","arr","copyAndSub","vecA","vecB","Key","KeyModifier","MouseButton","Vector2","ctor","BUTTONS_MAP","LEFT","WHEEL","RIGHT","BACK","FORWARD","KEYS_INDICES","reduce","map","index","INPUT_EVENT","Input","static","keyFlags","fill","mouseFlags","DOWN","mouseButtonsCount","REPEAT","UP","wheelDelta","element","addEventListener","event","button","preventDefault","mousePos","clientX","clientWidth","clientY","clientHeight","deltaY","passive","repeat","keysCount","elem","initializePointerHandlers","initializeKeyboardHandlers","buildArrayFromIndexedArrays","arrays","indexes","i","push","PoolAutoExtendPolicy","keys","StackPool","policy","_ctor","_autoExtendPolicy","AUTO_EXTEND_ONE","_autoExtendTicks","_autoExtend","getAutoExtendFunction","autoExtendPolicy","setAutoExtendPolicy","autoExtdPolicy","NO_AUTO_EXTEND","extend","AUTO_EXTEND_POW2","pow","options","super","_objects","size","_top","acquireTemp","n","func","top","target","slice","acquire","release","clear","Vector3Base","z","t0","t1","t2","dz","arg0","Vector3","m","mat","copyAndCross","Vector3Pool","TriangleBase","point1","point2","point3","_point1","_point2","_point3","getValues","triangle","getNormal","temp","getBarycentricCoordinates","point","v1","v2","vp","dotxx","dotxy","dotxz","dotyy","dotyz","denom","invDenom","u","indexOfPoint","containsPoint","contains","pointCoords","getUV","uv1","uv2","uv3","isFrontFacing","direction","result","getArea","area","getMidpoint","getPlane","closestPointToPoint","w","vb","vc","vbp","d1","d2","d3","d4","dc","d5","d6","db","da","translate","transform","transformDirection","TrianglePool","_bytes","PI","ArrayBuffer","Float32Array","BYTES_PER_ELEMENT","Uint32Array","TriangleListBase","count","floor","idx","tri","indexOf","idxBuf","idxObj","tempTri","forEach","idxTo","idxFrom","getIndexedPoints","indices","forIndexedPoints","pointsIndices","TriangleList","Vector2Pool","Vector2List","vector","Vector3ListBase","tempVec","forEachFromIndices","indice","Vector3List","UUIDGenerator","_count","newUUID","toString","BoundingBoxBase","_min","_max","box","makeEmpty","Infinity","isEmpty","getCenter","getSize","setFromLengths","center","width","height","setFromPoints","points","expandByPoint","expandByVector","expandByScalar","clampPoint","distanceToPoint","clampedPoint","intersectsPlane","plane","normal","constant","intersectsSphere","sphere","intersects","clamped","radius","intersectsBox","getBoundingSphere","intersectsTriangle","extents","v3","edge1","edge2","edge3","axes","satForAxes","triangleNormal","sat","axis","j","r","abs","p1","p2","p3","BoundingBox","BoundingBoxPool","BoundingSphereBase","_center","_radius","undefined","maxRadiusSq","distToPlane","radiusSum","deltaLenSq","getBoundingBox","transformPoint","getMaxScaleOnAxis","BoundingSphere","TriangleListPool","Vector3ListPool","GeometryUtils","verticesArray","uvsArray","indicesArray","type","tangentsArray","bitangentsArray","vertStride","p1x","p1y","p1z","edge1x","edge1y","edge1z","edge2x","edge2y","edge2z","uvStride","deltaUV1x","deltaUV1y","deltaUV2x","deltaUV2y","tx","ty","tz","btx","bty","btz","facesNormalsArray","faces","facesNormals","face","weighted","verticesNormalsArray","verticesNormals","vertices","computeFacesNormals","vertexNormalsSum","faceNormal","vert","vertIdx","faceIdx","GeometryPropertyKeys","GeometryBase","desc","uuid","isGeometry","_verticesArray","_vertices","_faces","_indicesArray","_uvsArray","uvs","_uvs","_weightedVerticesNormals","weightedVerticesNormals","_facesNormalsArray","_facesNormals","_verticesNormalsArray","computeVerticesNormals","_verticesNormals","computeTangentsAndBitangents","_tangentsArray","_bitangentsArray","_tangents","_bitangents","tangents","bitangents","boundingBox","_boundingBox","boundingSphere","_boundingSphere","computeBoundingBox","computeBoundingSphere","CubeGeometry","cubeVertices","Uint8Array","cubeIndices","cubeUVS","IcosahedronGeometry","icosahedronVertices","icosahedronUVS","icosahedronIndices","QuadGeometry","quadVertices","quadUVS","quadIndices","gl","document","createElement","getContext","BlendingMode","BlendingEquation","BufferMaskBit","BufferMask","BufferDataUsage","BufferBindingPoint","BufferIndexType","BufferInterpolation","BufferTarget","Capabilities","CullFaceMode","DrawMode","DataType","FramebufferAttachment","FramebufferAttachmentParameter","FramebufferTarget","FramebufferTextureTarget","FrontFace","HintTarget","HintMode","Parameter","PixelFormat","PixelStorageMode","PixelType","RenderbufferTarget","Shader","ShaderType","ShaderPrecision","StencilAction","TestFunction","TextureUnits","TextureParameter","TextureTarget","TextureMagFilter","TextureMinFilter","TextureWrapMode","UniformQuery","UniformType","VertexAttribute","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE_MINUS_DST_ALPHA","CONSTANT_COLOR","ONE_MINUS_CONSTANT_COLOR","CONSTANT_ALPHA","ONE_MINUS_CONSTANT_ALPHA","SRC_ALPHA_SATURATE","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","MIN","MAX","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","COLOR_BUFFER_BIT","DEPTH","STENCIL","COLOR","DEPTH_STENCIL","STATIC_DRAW","DYNAMIC_DRAW","STREAM_DRAW","STATIC_READ","DYNAMIC_READ","STREAM_READ","STATIC_COPY","DYNAMIC_COPY","STREAM_COPY","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","COPY_READ_BUFFER","COPY_WRITE_BUFFER","TRANSFORM_FEEDBACK_BUFFER","UNIFORM_BUFFER","PIXEL_PACK_BUFFER","PIXEL_UNPACK_BUFFER","UNSIGNED_BYTE","UNSIGNED_SHORT","UNSIGNED_INT","LINEAR","NEAREST","BLEND","CULL_FACE","DEPTH_TEST","DITHER","POLYGON_OFFSET_FILL","SAMPLE_ALPHA_TO_COVERAGE","SAMPLE_COVERAGE","SCISSOR_TEST","STENCIL_TEST","RASTERIZER_DISCARD","FRONT","FRONT_AND_BACK","POINTS","LINE_STRIP","LINE_LOOP","LINES","TRIANGLE_STRIP","TRIANGLE_FAN","TRIANGLES","BYTE","SHORT","FLOAT","HALF_FLOAT","NO_ERROR","INVALID_ENUM","INVALID_OPERATION","OUT_OF_MEMORY","CONTEXT_LOST_WEBGL","COLOR_ATTACHMENT0","COLOR_ATTACHMENT1","COLOR_ATTACHMENT2","COLOR_ATTACHMENT3","COLOR_ATTACHMENT4","COLOR_ATTACHMENT5","COLOR_ATTACHMENT6","COLOR_ATTACHMENT7","COLOR_ATTACHMENT8","COLOR_ATTACHMENT9","COLOR_ATTACHMENT10","COLOR_ATTACHMENT11","COLOR_ATTACHMENT12","COLOR_ATTACHMENT13","COLOR_ATTACHMENT14","COLOR_ATTACHMENT15","DEPTH_ATTACHMENT","STENCIL_ATTACHMENT","DEPTH_STENCIL_ATTACHMENT","FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE","FRAMEBUFFER_ATTACHMENT_OBJECT_NAME","FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL","FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE","FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE","FRAMEBUFFER_ATTACHMENT_BLUE_SIZE","FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING","FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE","FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE","FRAMEBUFFER_ATTACHMENT_GREEN_SIZE","FRAMEBUFFER_ATTACHMENT_RED_SIZE","FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE","FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER","FRAMEBUFFER","DRAW_FRAMEBUFFER","READ_FRAMEBUFFER","TEXTURE_2D","TEXTURE_CUBE_MAP_POSITIVE_X","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z","CW","CCW","GENERATE_MIPMAP_HINT","FRAGMENT_SHADER_DERIVATIVE_HINT","FASTEST","NICEST","DONT_CARE","ACTIVE_TEXTURE","ALIASED_LINE_WIDTH_RANGE","ALIASED_POINT_SIZE_RANGE","ALPHA_BITS","ARRAY_BUFFER_BINDING","BLEND_COLOR","BLEND_DST_ALPHA","BLEND_DST_RGB","BLEND_EQUATION","BLEND_EQUATION_ALPHA","BLEND_EQUATION_RGB","BLEND_SRC_ALPHA","BLEND_SRC_RGB","BLUE_BITS","COLOR_CLEAR_VALUE","COLOR_WRITEMASK","COMPRESSED_TEXTURE_FORMATS","CULL_FACE_MODE","CURRENT_PROGRAM","DEPTH_BITS","DEPTH_CLEAR_VALUE","DEPTH_FUNC","DEPTH_RANGE","DEPTH_WRITEMASK","ELEMENT_ARRAY_BUFFER_BINDING","FRAMEBUFFER_BINDING","FRONT_FACE","GREEN_BITS","IMPLEMENTATION_COLOR_READ_FORMAT","IMPLEMENTATION_COLOR_READ_TYPE","LINE_WIDTH","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_RENDERBUFFER_SIZE","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_UNIFORM_VECTORS","MAX_VIEWPORT_DIMS","PACK_ALIGNMENT","POLYGON_OFFSET_FACTOR","POLYGON_OFFSET_UNITS","RED_BITS","RENDERBUFFER_BINDING","RENDERER","SAMPLE_BUFFERS","SAMPLE_COVERAGE_INVERT","SAMPLE_COVERAGE_VALUE","SAMPLES","SCISSOR_BOX","SHADING_LANGUAGE_VERSION","STENCIL_BACK_FAIL","STENCIL_BACK_FUNC","STENCIL_BACK_PASS_DEPTH_FAIL","STENCIL_BACK_PASS_DEPTH_PASS","STENCIL_BACK_REF","STENCIL_BACK_VALUE_MASK","STENCIL_BACK_WRITEMASK","STENCIL_BITS","STENCIL_CLEAR_VALUE","STENCIL_FAIL","STENCIL_FUNC","STENCIL_PASS_DEPTH_FAIL","STENCIL_PASS_DEPTH_PASS","STENCIL_REF","STENCIL_VALUE_MASK","STENCIL_WRITEMASK","SUBPIXEL_BITS","TEXTURE_BINDING_2D","TEXTURE_BINDING_CUBE_MAP","UNPACK_ALIGNMENT","UNPACK_COLORSPACE_CONVERSION_WEBGL","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","VENDOR","VERSION","VIEWPORT","COPY_READ_BUFFER_BINDING","COPY_WRITE_BUFFER_BINDING","DRAW_FRAMEBUFFER_BINDING","MAX_3D_TEXTURE_SIZE","MAX_ARRAY_TEXTURE_LAYERS","MAX_CLIENT_WAIT_TIMEOUT_WEBGL","MAX_COLOR_ATTACHMENTS","MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS","MAX_COMBINED_UNIFORM_BLOCKS","MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS","MAX_DRAW_BUFFERS","MAX_ELEMENT_INDEX","MAX_ELEMENTS_INDICES","MAX_ELEMENTS_VERTICES","MAX_FRAGMENT_INPUT_COMPONENTS","MAX_FRAGMENT_UNIFORM_BLOCKS","MAX_FRAGMENT_UNIFORM_COMPONENTS","MAX_PROGRAM_TEXEL_OFFSET","MAX_SAMPLES","MAX_SERVER_WAIT_TIMEOUT","MAX_TEXTURE_LOD_BIAS","MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS","MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS","MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS","MAX_UNIFORM_BLOCK_SIZE","MAX_UNIFORM_BUFFER_BINDINGS","MAX_VARYING_COMPONENTS","MAX_VERTEX_OUTPUT_COMPONENTS","MAX_VERTEX_UNIFORM_BLOCKS","MAX_VERTEX_UNIFORM_COMPONENTS","MIN_PROGRAM_TEXEL_OFFSET","PACK_ROW_LENGTH","PACK_SKIP_PIXELS","PACK_SKIP_ROWS","PIXEL_PACK_BUFFER_BINDING","PIXEL_UNPACK_BUFFER_BINDING","READ_BUFFER","READ_FRAMEBUFFER_BINDING","SAMPLER_BINDING","TEXTURE_BINDING_2D_ARRAY","TEXTURE_BINDING_3D","TRANSFORM_FEEDBACK_ACTIVE","TRANSFORM_FEEDBACK_BINDING","TRANSFORM_FEEDBACK_BUFFER_BINDING","TRANSFORM_FEEDBACK_PAUSED","UNIFORM_BUFFER_BINDING","UNIFORM_BUFFER_OFFSET_ALIGNMENT","UNPACK_IMAGE_HEIGHT","UNPACK_ROW_LENGTH","UNPACK_SKIP_IMAGES","UNPACK_SKIP_PIXELS","UNPACK_SKIP_ROWS","VERTEX_ARRAY_BINDING","ALPHA","LUMINANCE","LUMINANCE_ALPHA","RGB","RGBA","RGBA4","RGB565","RGB5_A1","DEPTH_COMPONENT","STENCIL_INDEX8","R8","R8UI","R8I","R16UI","R16I","R32UI","R32I","RG8","RG8UI","RG8I","RG16UI","RG16I","RG32UI","RG32I","RGB8","RGBA8","SRGB8_ALPHA8","RGB10_A2","RGBA8UI","RGBA8I","RGB10_A2UI","RGBA16UI","RGBA16I","RGBA32I","RGBA32UI","DEPTH_COMPONENT24","DEPTH_COMPONENT32F","DEPTH24_STENCIL8","DEPTH32F_STENCIL8","FLOAT_32_UNSIGNED_INT_24_8_REV","INT","UNSIGNED_INT_2_10_10_10_REV","UNSIGNED_INT_10F_11F_11F_REV","UNSIGNED_INT_5_9_9_9_REV","UNSIGNED_INT_24_8","UNSIGNED_SHORT_5_6_5","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","RENDERBUFFER","FRAGMENT_SHADER","VERTEX_SHADER","COMPILE_STATUS","DELETE_STATUS","LINK_STATUS","VALIDATE_STATUS","ATTACHED_SHADERS","ACTIVE_ATTRIBUTES","ACTIVE_UNIFORMS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","SHADER_TYPE","LOW_FLOAT","MEDIUM_FLOAT","HIGH_FLOAT","LOW_INT","MEDIUM_INT","HIGH_INT","KEEP","REPLACE","INCR","DECR","INVERT","INCR_WRAP","DECR_WRAP","NEVER","LESS","EQUAL","LEQUAL","GREATER","NOTEQUAL","GEQUAL","ALWAYS","TEXTURE","TEXTURE0","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_BASE_LEVEL","TEXTURE_MAX_LEVEL","TEXTURE_MAX_LOD","TEXTURE_MIN_LOD","TEXTURE_WRAP_R","TEXTURE_CUBE_MAP","TEXTURE_3D","TEXTURE_2D_ARRAY","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR","CLAMP_TO_EDGE","MIRRORED_REPEAT","UNIFORM_TYPE","UNIFORM_SIZE","UNIFORM_BLOCK_INDEX","UNIFORM_OFFSET","UNIFORM_ARRAY_STRIDE","UNIFORM_MATRIX_STRIDE","UNIFORM_IS_ROW_MAJOR","BOOL","BOOL_VEC2","BOOL_VEC3","BOOL_VEC4","INT_VEC2","INT_VEC3","INT_VEC4","INT_SAMPLER_2D","INT_SAMPLER_3D","INT_SAMPLER_CUBE","INT_SAMPLER_2D_ARRAY","UNSIGNED_INT_SAMPLER_2D","UNSIGNED_INT_SAMPLER_3D","UNSIGNED_INT_SAMPLER_CUBE","UNSIGNED_INT_SAMPLER_2D_ARRAY","UNSIGNED_INT_VEC2","UNSIGNED_INT_VEC3","UNSIGNED_INT_VEC4","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","FLOAT_MAT2x3","FLOAT_MAT2x4","FLOAT_MAT3x2","FLOAT_MAT3x4","FLOAT_MAT4x2","FLOAT_MAT4x3","SAMPLER_2D","SAMPLER_3D","SAMPLER_CUBE","SAMPLER_2D_SHADOW","SAMPLER_2D_ARRAY","SAMPLER_2D_ARRAY_SHADOW","SAMPLER_CUBE_SHADOW","CURRENT_VERTEX_ATTRIB","VERTEX_ATTRIB_ARRAY_ENABLED","VERTEX_ATTRIB_ARRAY_SIZE","VERTEX_ATTRIB_ARRAY_STRIDE","VERTEX_ATTRIB_ARRAY_TYPE","VERTEX_ATTRIB_ARRAY_NORMALIZED","VERTEX_ATTRIB_ARRAY_POINTER","VERTEX_ATTRIB_ARRAY_BUFFER_BINDING","WebGLFramebufferUtilities","glFb","createFramebuffer","console","error","fb","props","bindFramebuffer","framebufferTexture2D","attachment","texTarget","glTex","attachments","framebufferRenderbuffer","glRb","readFb","drawFb","readRec","drawRec","mask","filter","blitFramebuffer","buff","clearBufferfv","depth","stencil","clearBufferfi","checkFramebufferStatus","isFramebuffer","deleteFramebuffer","WebGLBufferUtilities","glBuff","createBuffer","WebGLAttributeUtilities","glProg","list","glVao","createVertexArray","glBuffer","glIndicesBuffer","attributes","instanced","divisor","usage","attributesNames","attributesValues","attributeName","numElements","getAttributesListNumElements","indexType","getAttributeIndicesBufferType","settersList","setters","bufferByteLength","attr","byteLength","bufferBytesOffset","bindVertexArray","bindBuffer","bufferData","attribute","location","getAttribLocation","warn","enableVertexAttribArray","getAttributeArrayDataType","normalized","vertexAttribPointer","numComponents","vertexAttribDivisor","hasIndices","setter","srcOffset","srcLength","bufferSubData","Int32Array","Int16Array","Uint16Array","Int8Array","dataType","WebGLTextureUtilities","maxTextureUnits","getParameter","registeredTextureUnits","ctx","createTexture","unit","_allocateTextureUnit","tex","setTexture","deleteTexture","_freeTextureUnit","activeTexture","bindTexture","setTextureParameters","pixels","internalFormat","format","texImage2D","lod","xPos","xNeg","yPos","yNeg","zPos","zNeg","subimage","texSubImage2D","xoffset","yoffset","generateMipmap","texParameteri","mag","wrapS","wrapT","wrapR","baseLod","maxLod","isArray","numPixels","getNumChannelsFromPixelFormat","texSize","WebGLUniformUtilities","uniformValue","uniform","getUniformSetter","uniformName","getUniformLocation","uniformIndices","getUniformIndices","uniformType","getActiveUniforms","transpose","uniformTypeWarning","valueType","num","uniform1f","uniform1ui","uniform1i","uniform2fv","uniform2iv","uniform2uiv","uniform3fv","uniform3iv","uniform3uiv","uniform4fv","uniform4iv","uniform4uiv","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","uniformMatrix2x3fv","uniformMatrix2x4fv","uniformMatrix3x2fv","uniformMatrix3x4fv","uniformMatrix4x2fv","uniformMatrix4x3fv","WebGLUniformBlockUtilities","maxBindingPoints","registeredBindingPoints","bindingPoint","_allocateBindingPoint","block","blockIndex","getUniformBlockIndex","INVALID_INDEX","uniformBlockBinding","blockSize","getActiveUniformBlockParameter","UNIFORM_BLOCK_DATA_SIZE","uniforms","blockUniformsIndices","UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES","uniformOffset","uniformIndex","uniformInfo","getActiveUniform","bindBufferRange","newUniformValue","getUniformValueArrayBufferView","bindBufferBase","WebGLDrawUtilities","mode","drawElements","instanceCount","drawElementsInstanced","start","end","drawRangeElements","first","drawArrays","instances","drawArraysInstanced","WebGLPacketUtilities","textures","blocks","texturesCtx","createBindingsContext","blocksCtx","texturesProps","blocksProps","textureName","textureProps","texture","blockName","blockProp","createUniformBlock","packet","uniformBlocks","drawMode","attributesSetter","uniformBlockSetters","uniformsSetter","getAttributesListSetter","uniformBlock","uniformBlockSetter","getUniformBlockSetter","getUniformsListSetter","attributeSetter","setAttributesListValues","setUniformsListValues","setUniformBlockValues","bindAttributesList","unbindAttributesList","WebGLShaderUtilities","source","glShader","createShader","shaderSource","compileShader","getShaderParameter","shaderInfoLog","getShaderInfoLog","deleteShader","WebGLProgramUtilties","vertexSource","fragmentSource","vertexShader","fragmentShader","createProgram","attachShader","linkProgram","getProgramParameter","programInfoLog","getProgramInfoLog","deleteProgram","useProgram","WebGLRenderbufferUtilities","createRenderbuffer","bindRenderbuffer","samples","renderbufferStorageMultisample","renderbufferStorage","WebGLRendererUtilities","scissor","viewport","param","cap","enable","depthFunc","ref","stencilFunc","red","green","blue","alpha","clearColor","color","ColorBase","colors","c","valuesNormalized","BLACK","rgb","RED","GREEN","BLUE","WHITE","Color","Matrix4Base","row1","row2","row3","row4","col1","col2","col3","col4","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","getUpper33","setUpper33","getUpper34","setUpper34","getRow","setRow","row","setCol","col","getCol","getAt","setAt","val","getEntry","setEntry","setIdentity","det","det2_01_01","det2_01_02","det2_01_03","det2_01_12","det2_01_13","det2_01_23","det3_201_012","det3_201_013","det3_201_023","trace","invert","o00","o01","o02","o03","o10","o11","o12","o13","o20","o21","o22","o23","o30","o31","o32","o33","t00","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","d","invDet","inverseTranspose","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","scaleXSq","scaleYSq","scaleZSq","solve","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","bX","bY","bZ","bW","solve2","bx","by","solve3","bz","rx","ry","rz","setTranslation","angleInRadians","setRotationX","cos","s","sin","rotateX","setRotationY","rotateY","setRotationZ","rotateZ","rotate","axisRotation","xx","yy","zz","oneMinusCosine","rotateAxis","r11","r12","r13","r21","r22","r23","r31","r32","r33","setScaling","scale","scaleScalar","lookAt","eye","up","e","e0","e1","e2","u0","u1","u2","z0","z1","z2","zLen","x0","x1","x2","xLen","y0","y1","y2","yLen","transformNormal","backup","asPerspective","fieldOfViewYInRadians","aspect","zNear","zFar","f","tan","rangeInv","asOrthographic","left","right","bottom","near","far","Matrix4","LogLevel","Logger","_broker","_subscriptions","hasSubscriptions","subscribe","subscription","unsubscribe","splice","publish","message","log","level","LOG","formatMessage","_onLog","info","INFO","WARN","debug","DEBUG","ERROR","getTimestamp","Date","toLocaleTimeString","hour","minute","second","hour12","RessourceError","ResourceFetcher","freeze","async","url","fetch","then","resp","ok","arrayBuffer","text","json","Promise","resolve","img","Image","onload","src","extractExtension","filename","substring","lastIndexOf","imageExtensions","textExtensions","template","innerHTML","body","insertBefore","content","firstChild","render","fps","canvas","getElementById","assets","folder","resources","file","resource","join","path","concat","fileExt","includes","fetchImage","fetchTextFile","fetchResource","fetchJSON","loadList","phongVert","phongFrag","skyboxVert","skyboxFrag","textureVert","textureFrag","primitiveVert","primitiveFrag","albedoMapImg","normalMapImg","skyboxXPosImg","skyboxXNegImg","skyboxYPosImg","skyboxYNegImg","skyboxZPosImg","skyboxZNegImg","phongGlProg","createProgramFromSources","skyboxGlProg","texGlProg","cube","quad","packetBindings","createPacketBindings","albedoMap","guessTextureProperties","normalMap","skybox","fbColorTex","worldViewBlock","lightsBlock","phongBlock","fov","projection","camera","viewInverse","view","viewProjection","viewProjectionInverse","cubeWorldArr","cubeWorld","quadWorld","phongCubePacketValues","a_position","a_normal","a_tangent","a_bitangent","a_color","a_uv","u_world","u_viewInverse","u_worldInverseTranspose","u_worldViewProjection","u_lightWorldPos","u_lightColor","u_ambient","u_specular","u_shininess","u_specularFactor","u_diffuseMap","u_normalMap","skyboxPacketValues","u_viewDirectionProjectionInverse","u_skybox","texPacketValues","u_tex","phongCubePacketSetter","getPacketSetter","setPacketValues","skyboxPacketSetter","attachTexture","maxSamples","stencilRb","antialiasRb","attachRenderbuffers","postFb","texPacketSetter","setViewport","lastFrameTime","deltaTime","initialize","frameTime","getMouseButtonDown","lastPos","getMouseButtonPosition","getMouseButton","newPos","updateCamera","drawPacket","blit","unbindFramebuffer","launchScene","main"],"sourceRoot":""}